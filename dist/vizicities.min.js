!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("proj4"),require("THREE")):"function"==typeof define&&define.amd?define(["proj4","THREE"],t):"object"==typeof exports?exports.VIZI=t(require("proj4"),require("THREE")):e.VIZI=t(e.proj4,e.THREE)}(this,function(__WEBPACK_EXTERNAL_MODULE_22__,__WEBPACK_EXTERNAL_MODULE_24__){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=r(o),a=n(28),u=r(a),s=n(31),l=r(s),c=n(37),f=r(c),h=n(52),p=r(h),d=n(11),v=r(d),y=n(10),m=r(y),_={version:"0.3",World:i["default"],Controls:u["default"],EnvironmentLayer:l["default"],ImageTileLayer:f["default"],TopoJSONTileLayer:p["default"],Point:v["default"],LatLon:m["default"]};t["default"]=_,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(2),l=r(s),c=n(3),f=r(c),h=n(6),p=r(h),d=n(11),v=r(d),y=n(10),m=r(y),_=n(23),g=r(_),b=function(e){function t(e,n){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var r={crs:p["default"].EPSG3857,skybox:!1};this.options=(0,f["default"])(r,n),this._layers=[],this._controls=[],this._initContainer(e),this._initEngine(),this._initEnvironment(),this._initEvents(),this._update()}return i(t,e),a(t,[{key:"_initContainer",value:function(e){this._container=document.getElementById(e)}},{key:"_initEngine",value:function(){this._engine=(0,g["default"])(this._container)}},{key:"_initEnvironment",value:function(){this._environment=VIZI.EnvironmentLayer({skybox:this.options.skybox}).addTo(this)}},{key:"_initEvents",value:function(){this.on("controlsMoveEnd",this._onControlsMoveEnd)}},{key:"_onControlsMoveEnd",value:function(e){var t=(0,v["default"])(e.x,e.z);this._resetView(this.pointToLatLon(t),t)}},{key:"_resetView",value:function(e,t){this.emit("preResetView"),this._moveStart(),this._move(e,t),this._moveEnd(),this.emit("postResetView")}},{key:"_moveStart",value:function(){this.emit("moveStart")}},{key:"_move",value:function(e,t){this._lastPosition=e,this.emit("move",e,t)}},{key:"_moveEnd",value:function(){this.emit("moveEnd")}},{key:"_update",value:function(){var e=this._engine.clock.getDelta();window.requestAnimationFrame(this._update.bind(this)),this._controls.forEach(function(e){e.update()}),this.emit("preUpdate",e),this._engine.update(e),this.emit("postUpdate",e)}},{key:"setView",value:function(e){return this._originLatlon=e,this._originPoint=this.project(e),this._resetView(e),this}},{key:"getPosition",value:function(){return this._lastPosition}},{key:"project",value:function(e){return this.options.crs.latLonToPoint((0,m["default"])(e))}},{key:"unproject",value:function(e){return this.options.crs.pointToLatLon((0,v["default"])(e))}},{key:"latLonToPoint",value:function(e){var t=this.project((0,m["default"])(e));return t._subtract(this._originPoint)}},{key:"pointToLatLon",value:function(e){var t=(0,v["default"])(e).add(this._originPoint);return this.unproject(t)}},{key:"pointScale",value:function(e,t){return this.options.crs.pointScale(e,t)}},{key:"metresToWorld",value:function(e,t,n){return this.options.crs.metresToWorld(e,t,n)}},{key:"worldToMetres",value:function(e,t,n){return this.options.crs.worldToMetres(e,t,n)}},{key:"getCamera",value:function(){return this._engine._camera}},{key:"addLayer",value:function(e){return e._addToWorld(this),this._layers.push(e),this._engine._scene.add(e._layer),this.emit("layerAdded",e),this}},{key:"removeLayer",value:function(e){var t=this._layers.indexOf(e);return t>-1&&this._layers.splice(t,1),this._engine._scene.remove(e._layer),e.destroy(),this.emit("layerRemoved"),this}},{key:"addControls",value:function(e){return e._addToWorld(this),this._controls.push(e),this.emit("controlsAdded",e),this}},{key:"removeControls",value:function(e){}}]),t}(l["default"]);t["default"]=function(e,t){return new b(e,t)},e.exports=t["default"]},function(e,t,n){"use strict";function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(){}var i="function"!=typeof Object.create?"~":!1;o.prototype._events=void 0,o.prototype.listeners=function(e,t){var n=i?i+e:e,r=this._events&&this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,a=r.length,u=new Array(a);a>o;o++)u[o]=r[o].fn;return u},o.prototype.emit=function(e,t,n,r,o,a){var u=i?i+e:e;if(!this._events||!this._events[u])return!1;var s,l,c=this._events[u],f=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,o),!0;case 6:return c.fn.call(c.context,t,n,r,o,a),!0}for(l=1,s=new Array(f-1);f>l;l++)s[l-1]=arguments[l];c.fn.apply(c.context,s)}else{var h,p=c.length;for(l=0;p>l;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;default:if(!s)for(h=1,s=new Array(f-1);f>h;h++)s[h-1]=arguments[h];c[l].fn.apply(c[l].context,s)}}return!0},o.prototype.on=function(e,t,n){var o=new r(t,n||this),a=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):this._events[a]=o,this},o.prototype.once=function(e,t,n){var o=new r(t,n||this,!0),a=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):this._events[a]=o,this},o.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events||!this._events[o])return this;var a=this._events[o],u=[];if(t)if(a.fn)(a.fn!==t||r&&!a.once||n&&a.context!==n)&&u.push(a);else for(var s=0,l=a.length;l>s;s++)(a[s].fn!==t||r&&!a[s].once||n&&a[s].context!==n)&&u.push(a[s]);return u.length?this._events[o]=1===u.length?u[0]:u:delete this._events[o],this},o.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[i?i+e:e]:this._events=i?{}:Object.create(null),this):this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=i,e.exports=o},function(e,t,n){function r(e,t){return e="number"==typeof e||b.test(e)?+e:-1,t=null==t?m:t,e>-1&&e%1==0&&t>e}function o(e,t,n){var r=e[t];(!c(r,n)||c(r,x[t])&&!w.call(e,t)||void 0===n&&!(t in e))&&(e[t]=n)}function i(e){return function(t){return null==t?void 0:t[e]}}function a(e,t,n){return u(e,t,n)}function u(e,t,n,r){n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],s=r?r(n[u],e[u],u,n,e):e[u];o(n,u,s)}return n}function s(e){return y(function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i="function"==typeof i?(o--,i):void 0,a&&l(n[0],n[1],a)&&(i=3>o?void 0:i,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t})}function l(e,t,n){if(!d(n))return!1;var o=typeof t;return("number"==o?f(n)&&r(t,n.length):"string"==o&&t in n)?c(n[t],e):!1}function c(e,t){return e===t||e!==e&&t!==t}function f(e){return null!=e&&!("function"==typeof e&&h(e))&&p(E(e))}function h(e){var t=d(e)?M.call(e):"";return t==_||t==g}function p(e){return"number"==typeof e&&e>-1&&e%1==0&&m>=e}function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var v=n(4),y=n(5),m=9007199254740991,_="[object Function]",g="[object GeneratorFunction]",b=/^(?:0|[1-9]\d*)$/,x=Object.prototype,w=x.hasOwnProperty,M=x.toString,E=i("length"),O=s(function(e,t){a(t,v(t),e)});e.exports=O},function(e,t){function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function r(e,t){return e="number"==typeof e||M.test(e)?+e:-1,t=null==t?_:t,e>-1&&e%1==0&&t>e}function o(e,t){return O.call(e,t)||"object"==typeof e&&t in e&&null===P(e)}function i(e){return T(Object(e))}function a(e){return function(t){return null==t?void 0:t[e]}}function u(e){var t=e?e.length:void 0;return p(t)&&(S(e)||y(e)||l(e))?n(t,String):null}function s(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||E;return e===n}function l(e){return f(e)&&O.call(e,"callee")&&(!k.call(e,"callee")||j.call(e)==g)}function c(e){return null!=e&&!("function"==typeof e&&h(e))&&p(L(e))}function f(e){return v(e)&&c(e)}function h(e){var t=d(e)?j.call(e):"";return t==b||t==x}function p(e){return"number"==typeof e&&e>-1&&e%1==0&&_>=e}function d(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function v(e){return!!e&&"object"==typeof e}function y(e){return"string"==typeof e||!S(e)&&v(e)&&j.call(e)==w}function m(e){var t=s(e);if(!t&&!c(e))return i(e);var n=u(e),a=!!n,l=n||[],f=l.length;for(var h in e)!o(e,h)||a&&("length"==h||r(h,f))||t&&"constructor"==h||l.push(h);return l}var _=9007199254740991,g="[object Arguments]",b="[object Function]",x="[object GeneratorFunction]",w="[object String]",M=/^(?:0|[1-9]\d*)$/,E=Object.prototype,O=E.hasOwnProperty,j=E.toString,P=Object.getPrototypeOf,k=E.propertyIsEnumerable,T=Object.keys,L=a("length"),S=Array.isArray;e.exports=m},function(e,t){function n(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function r(e,t){if("function"!=typeof e)throw new TypeError(s);return t=x(void 0===t?e.length-1:a(t),0),function(){for(var r=arguments,o=-1,i=x(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,r[0],a);case 2:return e.call(this,r[0],r[1],a)}var u=Array(t+1);for(o=-1;++o<t;)u[o]=r[o];return u[t]=a,n(e,this,u)}}function o(e){var t=i(e)?b.call(e):"";return t==h||t==p}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){if(!e)return 0===e?e:0;if(e=u(e),e===l||e===-l){var t=0>e?-1:1;return t*c}var n=e%1;return e===e?n?e-n:e:0}function u(e){if(i(e)){var t=o(e.valueOf)?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(d,"");var n=y.test(e);return n||m.test(e)?_(e.slice(2),n?2:8):v.test(e)?f:+e}var s="Expected a function",l=1/0,c=1.7976931348623157e308,f=NaN,h="[object Function]",p="[object GeneratorFunction]",d=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,m=/^0o[0-7]+$/i,_=parseInt,g=Object.prototype,b=g.toString,x=Math.max;e.exports=r},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=r(o),a=n(15),u=r(a),s=n(17),l=r(s),c=n(19),f=r(c),h=n(20),p=r(h),d={};d.EPSG3857=i["default"],d.EPSG900913=o.EPSG900913,d.EPSG3395=u["default"],d.EPSG4326=l["default"],d.Simple=f["default"],d.Proj4=p["default"],t["default"]=d,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(8),u=r(a),s=n(13),l=r(s),c=n(14),f=r(c),h={code:"EPSG:3857",projection:l["default"],transformScale:1/(Math.PI*l["default"].R),transformation:function(){var e=1/(Math.PI*l["default"].R);return new f["default"](e,0,-e,0)}()},p=(0,i["default"])({},u["default"],h),d=(0,i["default"])({},p,{code:"EPSG:900913"});t.EPSG900913=d,t["default"]=p},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(9),u=r(a),s=n(10),l=(r(s),{wrapLon:[-180,180],R:6378137,distance:function(e,t,n){var r,o,i,a=Math.PI/180;if(n){r=e.lat*a,o=t.lat*a;var u=e.lon*a,s=t.lon*a,l=o-r,c=s-u,f=l/2,h=c/2;i=Math.sin(f)*Math.sin(f)+Math.cos(r)*Math.cos(o)*Math.sin(h)*Math.sin(h);var p=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i));return this.R*p}return r=e.lat*a,o=t.lat*a,i=Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos((t.lon-e.lon)*a),this.R*Math.acos(Math.min(i,1))},pointScale:function(e,t){return this.projection.pointScale?this.projection.pointScale(e,t):[1,1]},metresToProjected:function(e,t){return e*t[1]},projectedToMetres:function(e,t){return e/t[1]},metresToWorld:function(e,t,n){var r=this.metresToProjected(e,t),o=this.scale(n);n&&(o/=2);var i=o*(this.transformScale*r);return n&&(i/=t[1]),i},worldToMetres:function(e,t,n){var r=this.scale(n);n&&(r/=2);var o=e/r/this.transformScale,i=this.projectedToMetres(o,t);return n&&(i*=t[1]),i}});t["default"]=(0,i["default"])({},u["default"],l),e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),i=r(o),a=n(11),u=r(a),s=n(12),l=r(s),c={scaleFactor:1e6,latLonToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return t&&(r/=2),this.transformation._transform(n,r)},pointToLatLon:function(e,t){var n=this.scale(t);t&&(n/=2);var r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return e>=0?256*Math.pow(2,e):this.scaleFactor},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);e&&(n/=2);var r=this.transformation.transform((0,u["default"])(t[0]),n),o=this.transformation.transform((0,u["default"])(t[1]),n);return[r,o]},wrapLatLon:function(e){var t=this.wrapLat?(0,l["default"])(e.lat,this.wrapLat,!0):e.lat,n=this.wrapLon?(0,l["default"])(e.lon,this.wrapLon,!0):e.lon,r=e.alt;return(0,i["default"])(t,n,r)}};t["default"]=c,e.exports=t["default"]},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,r,o){if(n(this,e),isNaN(t)||isNaN(r))throw new Error("Invalid LatLon object: ("+t+", "+r+")");this.lat=+t,this.lon=+r,void 0!==o&&(this.alt=+o)}return r(e,[{key:"clone",value:function(){return new e(this.lat,this.lon,this.alt)}}]),e}();t["default"]=function(e,t,n){return e instanceof o?e:Array.isArray(e)&&"object"!=typeof e[0]?3===e.length?new o(e[0],e[1],e[2]):2===e.length?new o(e[0],e[1]):null:void 0===e||null===e?e:"object"==typeof e&&"lat"in e?new o(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new o(e,t,n)},e.exports=t["default"]},function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t,r,o){n(this,e),this.x=o?Math.round(t):t,this.y=o?Math.round(r):r}return r(e,[{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"add",value:function(e){return this.clone()._add(i(e))}},{key:"_add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"subtract",value:function(e){return this.clone()._subtract(i(e))}},{key:"_subtract",value:function(e){return this.x-=e.x,this.y-=e.y,this}}]),e}(),i=function(e,t,n){return e instanceof o?e:Array.isArray(e)?new o(e[0],e[1]):void 0===e||null===e?e:new o(e,t,n)};t["default"]=i,e.exports=t["default"]},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,n){var r=t[1],o=t[0],i=r-o;return e===r&&n?e:((e-o)%i+i)%i+o};t["default"]=n,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),i=r(o),a=n(11),u=r(a),s={R:6378137,MAX_LATITUDE:85.0511287798,ECC:.081819191,ECC2:.006694380015894481,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,e.lat),-n),o=Math.sin(r*t);return(0,u["default"])(this.R*e.lon*t,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(e){var t=180/Math.PI;return(0,i["default"])((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},pointScale:function(e,t){var n,r=Math.PI/180;if(t){var o=e.lat*r,i=(e.lon*r,this.R),a=Math.sin(o),u=a*a,s=Math.cos(o),l=i*(1-this.ECC2)/Math.pow(1-this.ECC2*u,1.5),c=i/Math.sqrt(1-this.ECC2*u),f=i/l/s;return n=i/c/s,[n,f]}return n=1/Math.cos(e.lat*r),[n,n]},bounds:function(){var e=6378137*Math.PI;return[[-e,-e],[e,e]]}()};t["default"]=s,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(11),u=r(a),s=function(){function e(t,n,r,i){o(this,e),this._a=t,this._b=n,this._c=r,this._d=i}return i(e,[{key:"transform",value:function(e,t){return this._transform(e.clone(),t)}},{key:"_transform",value:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e}},{key:"untransform",value:function(e,t){return t=t||1,(0,u["default"])((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}}]),e}();t["default"]=s,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(8),u=r(a),s=n(16),l=r(s),c=n(14),f=r(c),h={code:"EPSG:3395",projection:l["default"],transformScale:1/(Math.PI*l["default"].R),transformation:function(){var e=1/(Math.PI*l["default"].R);return new f["default"](e,0,-e,0)}()},p=(0,i["default"])({},u["default"],h);t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),i=r(o),a=n(11),u=r(a),s={R:6378137,R_MINOR:6356752.314245179,ECC:.081819191,ECC2:.006694380015894481,project:function(e){var t=Math.PI/180,n=this.R,r=e.lat*t,o=this.R_MINOR/n,i=Math.sqrt(1-o*o),a=i*Math.sin(r),s=Math.tan(Math.PI/4-r/2)/Math.pow((1-a)/(1+a),i/2);return r=-n*Math.log(Math.max(s,1e-10)),(0,u["default"])(e.lon*t*n,r)},unproject:function(e){for(var t,n=180/Math.PI,r=this.R,o=this.R_MINOR/r,a=Math.sqrt(1-o*o),u=Math.exp(-e.y/r),s=Math.PI/2-2*Math.atan(u),l=0,c=.1;15>l&&Math.abs(c)>1e-7;l++)t=a*Math.sin(s),t=Math.pow((1-t)/(1+t),a/2),c=Math.PI/2-2*Math.atan(u*t)-s,s+=c;return(0,i["default"])(s*n,e.x*n/r)},pointScale:function(e){var t=Math.PI/180,n=e.lat*t,r=Math.sin(n),o=r*r,i=Math.cos(n),a=Math.sqrt(1-this.ECC2*o)/i;return[a,a]},bounds:[[-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]]};t["default"]=s,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(8),u=r(a),s=n(18),l=r(s),c=n(14),f=r(c),h={code:"EPSG:4326",projection:l["default"],transformScale:1/180,transformation:new f["default"](1/180,0,-1/180,0)},p=(0,i["default"])({},u["default"],h);t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),i=r(o),a=n(11),u=r(a),s={project:function(e){return(0,u["default"])(e.lon,e.lat)},unproject:function(e){return(0,i["default"])(e.y,e.x)},pointScale:function(e){var t=111132.92,n=-559.82,r=1.175,o=-.0023,i=111412.84,a=-93.5,u=.118,s=Math.PI/180,l=e.lat*s,c=t+n*Math.cos(2*l)+r*Math.cos(4*l)+o*Math.cos(6*l),f=i*Math.cos(l)+a*Math.cos(3*l)+u*Math.cos(5*l);return[1/c,1/f]},bounds:[[-180,-90],[180,90]]};t["default"]=s,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(9),u=r(a),s=n(18),l=r(s),c=n(14),f=r(c),h={projection:l["default"],transformation:new f["default"](1,0,1,0),scale:function(e){return e?Math.pow(2,e):1},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lon-e.lon,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},infinite:!0},p=(0,i["default"])({},u["default"],h);t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=n(8),u=r(a),s=n(21),l=r(s),c=n(14),f=r(c),h=function(e,t,n){var r=(0,l["default"])(t,n),o=r.bounds[1][0]-r.bounds[0][0],i=r.bounds[1][1]-r.bounds[0][1],a=o/2,u=i/2,s=1/a,c=1/u,h=Math.min(s,c),p=h*(r.bounds[0][0]+a),d=h*(r.bounds[0][1]+u);return{code:e,projection:r,transformScale:h,transformation:new f["default"](h,-p,-h,d)}},p=function(e,t,n){return(0,i["default"])({},u["default"],h(e,t,n))};t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),i=r(o),a=n(10),u=r(a),s=n(11),l=r(s),c=function(e,t){var n=(0,i["default"])(e),r=function(e){return(0,l["default"])(n.forward([e.lon,e.lat]))},o=function(e){var t=n.inverse([e.x,e.y]);return(0,u["default"])(t[1],t[0])};return{project:r,unproject:o,pointScale:function(e,t){return[1,1]},bounds:function(){if(t)return t;var e=r([-90,-180]),n=r([90,180]);return[e,n]}()}};t["default"]=c,e.exports=t["default"]},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_22__},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(2),l=r(s),c=n(24),f=r(c),h=n(25),p=r(h),d=n(26),v=r(d),y=n(27),m=r(y),_=function(e){function t(e){o(this,t),console.log("Init Engine"),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._scene=p["default"],this._renderer=(0,v["default"])(e),this._camera=(0,m["default"])(e),this.clock=new f["default"].Clock,this._frustum=new f["default"].Frustum}return i(t,e),a(t,[{key:"update",value:function(e){this.emit("preRender"),this._renderer.render(this._scene,this._camera),this.emit("postRender")}}]),t}(l["default"]);t["default"]=function(e){return new _(e)},e.exports=t["default"]},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_24__},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o);t["default"]=function(){var e=new i["default"].Scene;return e}(),e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o),a=n(25);r(a);t["default"]=function(e){var t=new i["default"].WebGLRenderer({antialias:!0});t.setClearColor(16777215,1),t.gammaInput=!0,t.gammaOutput=!0,t.shadowMap.enabled=!0,t.shadowMap.cullFace=i["default"].CullFaceBack,e.appendChild(t.domElement);var n=function(){t.setSize(e.clientWidth,e.clientHeight)};return window.addEventListener("resize",n,!1),n(),t},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o);t["default"]=function(e){var t=new i["default"].PerspectiveCamera(45,1,1,2e5);t.position.y=400,t.position.z=400;var n=function(){t.aspect=e.clientWidth/e.clientHeight,t.updateProjectionMatrix()};return window.addEventListener("resize",n,!1),n(),t},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(29),i=r(o),a={Orbit:i["default"]};t["default"]=a,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(2),l=r(s),c=n(24),f=(r(c),n(30)),h=r(f),p=function(e){function t(){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this)}return i(t,e),a(t,[{key:"_initEvents",value:function(){var e=this;this._controls.addEventListener("start",function(t){e._world.emit("controlsMoveStart",t.target.target)}),this._controls.addEventListener("change",function(t){e._world.emit("controlsMove",t.target.target)}),this._controls.addEventListener("end",function(t){e._world.emit("controlsMoveEnd",t.target.target)})}},{key:"_panTo",value:function(e,t){}},{key:"_panBy",value:function(e,t){}},{key:"_zoomTo",value:function(e,t){}},{key:"_zoomBy",value:function(e,t){}},{key:"_lookAt",value:function(e,t){}},{key:"_lookAtTarget",value:function(){}},{key:"_tiltTo",value:function(e,t){}},{key:"_tiltBy",value:function(e,t){}},{key:"_rotateTo",value:function(e,t){}},{key:"_rotateBy",value:function(e,t){}},{key:"_flyTo",value:function(e,t){}},{key:"update",value:function(){this._controls.update()}},{key:"addTo",value:function(e){return e.addControls(this),this}},{key:"_addToWorld",value:function(e){this._world=e,this._controls=new h["default"](e._engine._camera,e._container),this._controls.keys=!1,this._controls.maxPolarAngle=1.5533,this._initEvents(),this.emit("added")}}]),t}(l["default"]);t["default"]=function(){return new p},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o),a=function(e,t){function n(){return 2*Math.PI/60/60*q.autoRotateSpeed}function r(){return Math.pow(.95,q.zoomSpeed)}function o(e){B-=e}function a(e){W-=e}function u(e){q.object instanceof i["default"].PerspectiveCamera?Z/=e:q.object instanceof i["default"].OrthographicCamera?(q.object.zoom=Math.max(q.minZoom,Math.min(q.maxZoom,q.object.zoom*e)),q.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),q.enableZoom=!1)}function s(e){q.object instanceof i["default"].PerspectiveCamera?Z*=e:q.object instanceof i["default"].OrthographicCamera?(q.object.zoom=Math.max(q.minZoom,Math.min(q.maxZoom,q.object.zoom/e)),q.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),q.enableZoom=!1)}function l(e){X.set(e.clientX,e.clientY)}function c(e){ee.set(e.clientX,e.clientY)}function f(e){$.set(e.clientX,e.clientY)}function h(e){K.set(e.clientX,e.clientY),Y.subVectors(K,X);var t=q.domElement===document?q.domElement.body:q.domElement;o(2*Math.PI*Y.x/t.clientWidth*q.rotateSpeed),a(2*Math.PI*Y.y/t.clientHeight*q.rotateSpeed),X.copy(K),q.update()}function p(e){te.set(e.clientX,e.clientY),ne.subVectors(te,ee),ne.y>0?u(r()):ne.y<0&&s(r()),ee.copy(te),q.update()}function d(e){J.set(e.clientX,e.clientY),Q.subVectors(J,$),ie(Q.x,Q.y),$.copy(J),q.update()}function v(e){}function y(e){var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?s(r()):0>t&&u(r()),q.update()}function m(e){switch(e.keyCode){case q.keys.UP:ie(0,q.keyPanSpeed),q.update();break;case q.keys.BOTTOM:ie(0,-q.keyPanSpeed),q.update();break;case q.keys.LEFT:ie(q.keyPanSpeed,0),q.update();break;case q.keys.RIGHT:ie(-q.keyPanSpeed,0),q.update()}}function _(e){X.set(e.touches[0].pageX,e.touches[0].pageY)}function g(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);ee.set(0,r)}function b(e){$.set(e.touches[0].pageX,e.touches[0].pageY)}function x(e){K.set(e.touches[0].pageX,e.touches[0].pageY),Y.subVectors(K,X);var t=q.domElement===document?q.domElement.body:q.domElement;o(2*Math.PI*Y.x/t.clientWidth*q.rotateSpeed),a(2*Math.PI*Y.y/t.clientHeight*q.rotateSpeed),X.copy(K),q.update()}function w(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);te.set(0,o),ne.subVectors(te,ee),ne.y>0?s(r()):ne.y<0&&u(r()),ee.copy(te),q.update()}function M(e){J.set(e.touches[0].pageX,e.touches[0].pageY),Q.subVectors(J,$),ie(Q.x,Q.y),$.copy(J),q.update()}function E(e){}function O(e){if(q.enabled!==!1){if(e.preventDefault(),e.button===q.mouseButtons.ORBIT){if(q.enableRotate===!1)return;l(e),I=N.ROTATE}else if(e.button===q.mouseButtons.ZOOM){if(q.enableZoom===!1)return;c(e),I=N.DOLLY}else if(e.button===q.mouseButtons.PAN){if(q.enablePan===!1)return;f(e),I=N.PAN}I!==N.NONE&&(document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",P,!1),document.addEventListener("mouseout",P,!1),q.dispatchEvent(F))}}function j(e){if(q.enabled!==!1)if(e.preventDefault(),I===N.ROTATE){if(q.enableRotate===!1)return;h(e)}else if(I===N.DOLLY){if(q.enableZoom===!1)return;p(e)}else if(I===N.PAN){if(q.enablePan===!1)return;d(e)}}function P(e){q.enabled!==!1&&(v(e),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",P,!1),document.removeEventListener("mouseout",P,!1),q.dispatchEvent(H),
I=N.NONE)}function k(e){q.enabled!==!1&&q.enableZoom!==!1&&I===N.NONE&&(e.preventDefault(),e.stopPropagation(),y(e),q.dispatchEvent(F),q.dispatchEvent(H))}function T(e){q.enabled!==!1&&q.enableKeys!==!1&&q.enablePan!==!1&&m(e)}function L(e){if(q.enabled!==!1){switch(e.touches.length){case 1:if(q.enableRotate===!1)return;_(e),I=N.TOUCH_ROTATE;break;case 2:if(q.enableZoom===!1)return;g(e),I=N.TOUCH_DOLLY;break;case 3:if(q.enablePan===!1)return;b(e),I=N.TOUCH_PAN;break;default:I=N.NONE}I!==N.NONE&&q.dispatchEvent(F)}}function S(e){if(q.enabled!==!1)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(q.enableRotate===!1)return;if(I!==N.TOUCH_ROTATE)return;x(e);break;case 2:if(q.enableZoom===!1)return;if(I!==N.TOUCH_DOLLY)return;w(e);break;case 3:if(q.enablePan===!1)return;if(I!==N.TOUCH_PAN)return;M(e);break;default:I=N.NONE}}function C(e){q.enabled!==!1&&(E(e),q.dispatchEvent(H),I=N.NONE)}function A(e){e.preventDefault()}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new i["default"].Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:i["default"].MOUSE.LEFT,ZOOM:i["default"].MOUSE.MIDDLE,PAN:i["default"].MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return D},this.getAzimuthalAngle=function(){return R},this.reset=function(){q.target.copy(q.target0),q.object.position.copy(q.position0),q.object.zoom=q.zoom0,q.object.updateProjectionMatrix(),q.dispatchEvent(z),q.update(),I=N.NONE},this.update=function(){var t=new i["default"].Vector3,r=(new i["default"].Quaternion).setFromUnitVectors(e.up,new i["default"].Vector3(0,1,0)),a=r.clone().inverse(),u=new i["default"].Vector3,s=new i["default"].Quaternion;return function(){var e=q.object.position;t.copy(e).sub(q.target),t.applyQuaternion(r),R=Math.atan2(t.x,t.z),D=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y),q.autoRotate&&I===N.NONE&&o(n()),R+=B,D+=W,R=Math.max(q.minAzimuthAngle,Math.min(q.maxAzimuthAngle,R)),D=Math.max(q.minPolarAngle,Math.min(q.maxPolarAngle,D)),D=Math.max(U,Math.min(Math.PI-U,D));var i=t.length()*Z;return i=Math.max(q.minDistance,Math.min(q.maxDistance,i)),q.target.add(V),t.x=i*Math.sin(D)*Math.sin(R),t.y=i*Math.cos(D),t.z=i*Math.sin(D)*Math.cos(R),t.applyQuaternion(a),e.copy(q.target).add(t),q.object.lookAt(q.target),q.enableDamping===!0?(B*=1-q.dampingFactor,W*=1-q.dampingFactor):(B=0,W=0),Z=1,V.set(0,0,0),G||u.distanceToSquared(q.object.position)>U||8*(1-s.dot(q.object.quaternion))>U?(q.dispatchEvent(z),u.copy(q.object.position),s.copy(q.object.quaternion),G=!1,!0):!1}}(),this.dispose=function(){q.domElement.removeEventListener("contextmenu",A,!1),q.domElement.removeEventListener("mousedown",O,!1),q.domElement.removeEventListener("mousewheel",k,!1),q.domElement.removeEventListener("MozMousePixelScroll",k,!1),q.domElement.removeEventListener("touchstart",L,!1),q.domElement.removeEventListener("touchend",C,!1),q.domElement.removeEventListener("touchmove",S,!1),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",P,!1),document.removeEventListener("mouseout",P,!1),window.removeEventListener("keydown",T,!1)};var R,D,q=this,z={type:"change"},F={type:"start"},H={type:"end"},N={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},I=N.NONE,U=1e-6,W=0,B=0,Z=1,V=new i["default"].Vector3,G=!1,X=new i["default"].Vector2,K=new i["default"].Vector2,Y=new i["default"].Vector2,$=new i["default"].Vector2,J=new i["default"].Vector2,Q=new i["default"].Vector2,ee=new i["default"].Vector2,te=new i["default"].Vector2,ne=new i["default"].Vector2,re=function(){var e=new i["default"].Vector3;return function(t,n){var r=n.elements;e.set(r[0],0,r[2]),e.multiplyScalar(-t),V.add(e)}}(),oe=function(){var e=new i["default"].Vector3;return function(t,n){var r=n.elements,o=t/Math.cos(D);e.set(r[4],0,r[6]),e.multiplyScalar(o),V.add(e)}}(),ie=function(){var e=new i["default"].Vector3;return function(t,n){var r=q.domElement===document?q.domElement.body:q.domElement;if(q.object instanceof i["default"].PerspectiveCamera){var o=q.object.position;e.copy(o).sub(q.target);var a=e.length();a*=Math.tan(q.object.fov/2*Math.PI/180),re(2*t*a/r.clientHeight,q.object.matrix),oe(2*n*a/r.clientHeight,q.object.matrix)}else q.object instanceof i["default"].OrthographicCamera?(re(t*(q.object.right-q.object.left)/r.clientWidth,q.object.matrix),oe(n*(q.object.top-q.object.bottom)/r.clientHeight,q.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),q.enablePan=!1)}}();q.domElement.addEventListener("contextmenu",A,!1),q.domElement.addEventListener("mousedown",O,!1),q.domElement.addEventListener("mousewheel",k,!1),q.domElement.addEventListener("MozMousePixelScroll",k,!1),q.domElement.addEventListener("touchstart",L,!1),q.domElement.addEventListener("touchend",C,!1),q.domElement.addEventListener("touchmove",S,!1),window.addEventListener("keydown",T,!1),this.update()};a.prototype=Object.create(i["default"].EventDispatcher.prototype),a.prototype.constructor=i["default"].OrbitControls,Object.defineProperties(a.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=e}}}),t["default"]=a,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(32),l=r(s),c=n(3),f=r(c),h=n(24),p=r(h),d=n(33),v=r(d),y=function(e){function t(e){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this);var n={skybox:!1};this._options=(0,f["default"])(n,e)}return i(t,e),a(t,[{key:"_onAdd",value:function(){this._initLights(),this._options.skybox&&this._initSkybox()}},{key:"_initLights",value:function(){if(this._options.skybox){this._skyboxLight=new p["default"].DirectionalLight(16777215,1),this._skyboxLight.castShadow=!0;var e=1e3;this._skyboxLight.shadow.camera.left=-e,this._skyboxLight.shadow.camera.right=e,this._skyboxLight.shadow.camera.top=e,this._skyboxLight.shadow.camera.bottom=-e,this._skyboxLight.shadow.camera.near=1e4,this._skyboxLight.shadow.camera.far=7e4,this._skyboxLight.shadow.mapSize.width=2048,this._skyboxLight.shadow.mapSize.height=2048,this._layer.add(this._skyboxLight)}else{var t=new p["default"].DirectionalLight(10066329);t.intesity=.1,t.position.x=100,t.position.y=100,t.position.z=100;var n=new p["default"].DirectionalLight(10066329);n.intesity=.1,n.position.x=-100,n.position.y=100,n.position.z=-100;var r=new p["default"].DirectionalLightHelper(t,10),o=new p["default"].DirectionalLightHelper(n,10);this._layer.add(t),this._layer.add(n),this._layer.add(r),this._layer.add(o)}}},{key:"_initSkybox",value:function(){this._skybox=(0,v["default"])(this._world,this._skyboxLight),this._layer.add(this._skybox._mesh)}},{key:"_initGrid",value:function(){var e=4e3,t=100,n=new p["default"].GridHelper(e,t);this._layer.add(n)}},{key:"destroy",value:function(){this._skyboxLight=null,this._layer.remove(this._skybox._mesh),this._skybox.destroy(),this._skybox=null,u(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l["default"]);t["default"]=function(e){return new y(e)},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(2),l=r(s),c=n(24),f=r(c),h=n(25),p=(r(h),function(e){function t(){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._layer=new f["default"].Object3D}return i(t,e),a(t,[{key:"addTo",value:function(e){return e.addLayer(this),this}},{key:"_addToWorld",value:function(e){this._world=e,this._onAdd(e),this.emit("added")}},{key:"destroy",value:function(){this._world=null,this._layer=null}}]),t}(l["default"]));t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(24),u=r(a),s=n(34),l=r(s),c=n(35),f=r(c),h={vertexShader:["varying vec3 vPosition;","void main() {","vPosition = position;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube cubemap;","varying vec3 vPosition;","void main() {","gl_FragColor = textureCube(cubemap, normalize(vPosition));","}"].join("\n")},p=function(){function e(t,n){o(this,e),this._world=t,this._light=n,this._settings={distance:38e3,turbidity:10,reileigh:2,mieCoefficient:.005,mieDirectionalG:.8,luminance:1,inclination:.48,azimuth:.25},this._initSkybox(),this._updateUniforms(),this._initEvents()}return i(e,[{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,f["default"])(this._update,100),this._world.on("preUpdate",this._throttledWorldUpdate,this)}},{key:"_initSkybox",value:function(){this._cubeCamera=new u["default"].CubeCamera(1,2e6,128);var e=this._cubeCamera.renderTarget;this._sky=new l["default"],this._skyScene=new u["default"].Scene,this._skyScene.add(this._sky.mesh),this._sunSphere=new u["default"].Mesh(new u["default"].SphereBufferGeometry(2e3,16,8),new u["default"].MeshBasicMaterial({color:16777215}));var t={cubemap:{type:"t",value:e}},n=new u["default"].ShaderMaterial({uniforms:t,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,side:u["default"].BackSide});this._mesh=new u["default"].Mesh(new u["default"].BoxGeometry(19e4,19e4,19e4),n)}},{key:"_updateUniforms",value:function(){var e=this._settings,t=this._sky.uniforms;t.turbidity.value=e.turbidity,t.reileigh.value=e.reileigh,t.luminance.value=e.luminance,t.mieCoefficient.value=e.mieCoefficient,t.mieDirectionalG.value=e.mieDirectionalG;var n=Math.PI*(e.inclination-.5),r=2*Math.PI*(e.azimuth-.5);this._sunSphere.position.x=e.distance*Math.cos(r),this._sunSphere.position.y=e.distance*Math.sin(r)*Math.sin(n),this._sunSphere.position.z=e.distance*Math.sin(r)*Math.cos(n),this._light.position.copy(this._sunSphere.position),this._sky.uniforms.sunPosition.value.copy(this._sunSphere.position)}},{key:"_update",value:function(e){this._done||(this._done=!0,this._light.intensity=1-.95*(this._settings.inclination/.5),this._updateUniforms(),this._cubeCamera.updateCubeMap(this._world._engine._renderer,this._skyScene))}},{key:"getRenderTarget",value:function(){return this._cubeCamera.renderTarget}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._throttledWorldUpdate=null,this._world=null,this._light=null,this._cubeCamera=null,this._sky.mesh.geometry.dispose(),this._sky.mesh.geometry=null,this._sky.mesh.material.map&&(this._sky.mesh.material.map.dispose(),this._sky.mesh.material.map=null),this._sky.mesh.material.dispose(),this._sky.mesh.material=null,this._sky.mesh=null,this._sky=null,this._skyScene=null,this._sunSphere.geometry.dispose(),this._sunSphere.geometry=null,this._sunSphere.material.map&&(this._sunSphere.material.map.dispose(),this._sunSphere.material.map=null),this._sunSphere.material.dispose(),this._sunSphere.material=null,this._sunSphere=null,this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.map&&(this._mesh.material.map.dispose(),this._mesh.material.map=null),this._mesh.material.dispose(),this._mesh.material=null}}]),e}();t["default"]=function(e,t){return new p(e,t)},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o);i["default"].ShaderLib.sky={uniforms:{luminance:{type:"f",value:1},turbidity:{type:"f",value:2},reileigh:{type:"f",value:1},mieCoefficient:{type:"f",value:.005},mieDirectionalG:{type:"f",value:.8},sunPosition:{type:"v3",value:new i["default"].Vector3}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D skySampler;","uniform vec3 sunPosition;","varying vec3 vWorldPosition;","vec3 cameraPos = vec3(0., 0., 0.);","// uniform sampler2D sDiffuse;","// const float turbidity = 10.0; //","// const float reileigh = 2.; //","// const float luminance = 1.0; //","// const float mieCoefficient = 0.005;","// const float mieDirectionalG = 0.8;","uniform float luminance;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","// constants for atmospheric scattering","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003; // refractive index of air","const float N = 2.545E25; // number of molecules per unit volume for air at","// 288.15K and 1013mb (sea level -45 celsius)","const float pn = 0.035;	// depolatization factor for standard air","// wavelength of used primaries, according to preetham","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","// mie stuff","// K coefficient for the primaries","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","// optical length at zenith for molecules","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3(0.0, 1.0, 0.0);","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","// 66 arc seconds -> degrees, and the cosine of that","// earth shadow hack","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{	 ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// float logLuminance(vec3 c)","// {","// 	return log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);","// }","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);","// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;","// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(sunPosition);","float sunE = sunIntensity(dot(sunDirection, up));","// extinction (absorbtion + out scattering) ","// rayleigh coefficients","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","// mie coefficients","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","// optical length","// cutoff angle at 90 to avoid singularity in next formula.","float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","// combined extinction factor	","vec3 Fex = exp(-(betaR * sR + betaM * sM));","// in scattering","float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));","//nightsky","vec3 direction = normalize(vWorldPosition - cameraPos);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;","vec3 L0 = vec3(0.1) * Fex;","// composition + solar disc","//if (cosTheta > sunAngularDiameterCos)","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","// if (normalize(vWorldPosition - cameraPos).y>0.0)","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);   ","texColor *= 0.04 ;","texColor += vec3(0.0,0.001,0.0025)*0.3;","float g_fMaxLuminance = 1.0;","float fLumScaled = 0.1 / luminance;     ","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ","float ExposureBias = fLumCompressed;","vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1.0;","}"].join("\n")};var a=function(){var e=i["default"].ShaderLib.sky,t=i["default"].UniformsUtils.clone(e.uniforms),n=new i["default"].ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:t,side:i["default"].BackSide}),r=new i["default"].SphereBufferGeometry(45e4,32,15),o=new i["default"].Mesh(r,n);this.mesh=o,this.uniforms=t};t["default"]=a,e.exports=t["default"]},function(e,t,n){function r(e,t,n){var r=!0,u=!0;if("function"!=typeof e)throw new TypeError(a);return o(n)&&(r="leading"in n?!!n.leading:r,u="trailing"in n?!!n.trailing:u),i(e,t,{leading:r,maxWait:t,trailing:u})}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var i=n(36),a="Expected a function";e.exports=r},function(e,t){function n(e,t,n){function r(){g&&clearTimeout(g),p&&clearTimeout(p),x=0,h=p=y=g=b=void 0}function u(t,n){n&&clearTimeout(n),p=g=b=void 0,t&&(x=_(),d=e.apply(y,h),g||p||(h=y=void 0))}function s(){var e=t-(_()-v);0>=e||e>t?u(b,p):g=setTimeout(s,e)}function l(){return(g&&b||p&&E)&&(d=e.apply(y,h)),r(),d}function c(){u(E,g)}function f(){if(h=arguments,v=_(),y=this,b=E&&(g||!w),M===!1)var n=w&&!g;else{p||w||(x=v);var r=M-(v-x),o=0>=r||r>M;o?(p&&(p=clearTimeout(p)),x=v,d=e.apply(y,h)):p||(p=setTimeout(c,r))}return o&&g?g=clearTimeout(g):g||t===M||(g=setTimeout(s,t)),n&&(o=!0,d=e.apply(y,h)),!o||g||p||(h=y=void 0),d}var h,p,d,v,y,g,b,x=0,w=!1,M=!1,E=!0;if("function"!=typeof e)throw new TypeError(a);return t=i(t)||0,o(n)&&(w=!!n.leading,M="maxWait"in n&&m(i(n.maxWait)||0,t),E="trailing"in n?!!n.trailing:E),f.cancel=r,f.flush=l,f}function r(e){var t=o(e)?y.call(e):"";return t==s||t==l}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function i(e){if(o(e)){var t=r(e.valueOf)?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var n=h.test(e);return n||p.test(e)?d(e.slice(2),n?2:8):f.test(e)?u:+e}var a="Expected a function",u=NaN,s="[object Function]",l="[object GeneratorFunction]",c=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,d=parseInt,v=Object.prototype,y=v.toString,m=Math.max,_=Date.now;e.exports=n},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(38),l=r(s),c=n(48),f=r(c),h=n(51),p=r(h),d=n(35),v=r(d),y=n(24),m=r(y),_=n(3),g=r(_),b=function(e){function t(e,n){o(this,t);var r={distance:4e4};n=(0,g["default"])(r,n),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n),this._path=e}return i(t,e),a(t,[{key:"_onAdd",value:function(e){var n=this;u(Object.getPrototypeOf(t.prototype),"_onAdd",this).call(this,e);var r,o=new m["default"].PlaneBufferGeometry(2e5,2e5,1);r=this._world._environment._skybox?(0,p["default"])("#f5f5f3",this._world._environment._skybox.getRenderTarget()):(0,p["default"])("#f5f5f3");var i=new m["default"].Mesh(o,r);i.rotation.x=-90*Math.PI/180,i.receiveShadow=!0,this._baseLayer=i,this._layer.add(i),setTimeout(function(){n._calculateLOD(),n._initEvents()},0)}},{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,v["default"])(this._onWorldUpdate,100),this._world.on("preUpdate",this._throttledWorldUpdate,this),this._world.on("move",this._onWorldMove,this)}},{key:"_onWorldUpdate",value:function(){this._calculateLOD()}},{key:"_onWorldMove",value:function(e,t){this._moveBaseLayer(t)}},{key:"_moveBaseLayer",value:function(e){this._baseLayer.position.x=e.x,this._baseLayer.position.z=e.y}},{key:"_createTile",value:function(e,t){return(0,f["default"])(e,this._path,t)}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._world.off("move",this._onWorldMove),this._throttledWorldUpdate=null,this._baseLayer.geometry.dispose(),this._baseLayer.geometry=null,this._baseLayer.material.map&&(this._baseLayer.material.map.dispose(),this._baseLayer.material.map=null),this._baseLayer.material.dispose(),this._baseLayer.material=null,this._baseLayer=null,u(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l["default"]);t["default"]=function(e,t){return new b(e,t)},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(32),l=r(s),c=n(3),f=r(c),h=n(39),p=r(h),d=n(24),v=r(d),y=function(e){function t(e){var n=this;o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e);var r={maxCache:1e3,maxLOD:18};this._options=(0,f["default"])(r,e),this._tileCache=(0,p["default"])(this._options.maxCache,function(e){n._destroyTile(e)}),this._minLOD=3,this._maxLOD=this._options.maxLOD,this._frustum=new v["default"].Frustum,this._tiles=new v["default"].Object3D}return i(t,e),a(t,[{key:"_onAdd",value:function(e){this._layer.add(this._tiles)}},{key:"_updateFrustum",value:function(){var e=this._world.getCamera(),t=new v["default"].Matrix4;t.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromMatrix(e.projectionMatrix),this._frustum.setFromMatrix((new v["default"].Matrix4).multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse))}},{key:"_tileInFrustum",value:function(e){var t=e.getBounds();return this._frustum.intersectsBox(new v["default"].Box3(new v["default"].Vector3(t[0],0,t[3]),new v["default"].Vector3(t[2],0,t[1])))}},{key:"_calculateLOD",value:function(){var e=this;if(!this._stop&&this._world){var t=this._world.getCamera();this._updateFrustum(this._frustum,t);var n=this._checklist;n=[],n.push(this._requestTile("0",this)),n.push(this._requestTile("1",this)),n.push(this._requestTile("2",this)),n.push(this._requestTile("3",this)),this._divide(n),this._removeTiles(),n.forEach(function(n,r){if(e._tileInFrustum(n)){if(e._options.distance&&e._options.distance>0){var o=n.getCenter(),i=new v["default"].Vector3(o[0],0,o[1]).sub(t.position).length();if(i>e._options.distance)return}return n.getMesh()?void(n.isReady()&&e._tiles.add(n.getMesh())):void n.requestTileAsync()}})}}},{key:"_divide",value:function(e){for(var t,n,r=0;r!=e.length;)t=e[r],n=t.getQuadcode(),t.length!==this._maxLOD&&this._screenSpaceError(t)?(e.splice(r,1),e.push(this._requestTile(n+"0",this)),e.push(this._requestTile(n+"1",this)),e.push(this._requestTile(n+"2",this)),e.push(this._requestTile(n+"3",this))):r++}},{key:"_screenSpaceError",value:function(e){var t=this._minLOD,n=this._maxLOD,r=e.getQuadcode(),o=this._world.getCamera(),i=3;if(r.length===n)return!1;if(r.length<t)return!0;if(!this._tileInFrustum(e))return!1;var a=e.getCenter(),u=new v["default"].Vector3(a[0],0,a[1]).sub(o.position).length(),s=i*e.getSide()/u;return s>1}},{key:"_removeTiles",value:function(){for(var e=this._tiles.children.length-1;e>=0;e--)this._tiles.remove(this._tiles.children[e])}},{key:"_createTile",value:function(e,t){}},{key:"_requestTile",value:function(e,t){var n=this._tileCache.getTile(e);return n||(n=this._createTile(e,t),this._tileCache.setTile(e,n)),n}},{key:"_destroyTile",value:function(e){this._layer.remove(e),e.destroy()}},{key:"destroy",value:function(){var e;for(e=this._tiles.children.length-1;e>=0;e--)this._tiles.remove(this._tiles.children[e]);for(e=this._layer.children.length-1;e>=0;e--)this._layer.remove(this._layer.children[e]);this._tileCache.destroy(),this._tileCache=null,this._world=null,this._tiles=null,this._layer=null,this._frustum=null}}]),t}(l["default"]);t["default"]=y,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(40),u=r(a),s=function(){
function e(t,n){o(this,e),this._cache=(0,u["default"])({max:t,dispose:function(e,t){n(t)}})}return i(e,[{key:"isReady",value:function(){return!1}},{key:"getTile",value:function(e){return this._cache.get(e)}},{key:"setTile",value:function(e,t){this._cache.set(e,t)}},{key:"destroy",value:function(){this._cache.reset(),this._cache=null}}]),e}();t["default"]=function(e,t){return new s(e,t)},e.exports=t["default"]},function(e,t,n){function r(e,t,n){var r;return y[t]?r=y[t]:(r=h(t),y[t]=r),2===arguments.length?e[r]:(e[r]=n,n)}function o(){return 1}function i(e){if(!(this instanceof i))return new i(e);"number"==typeof e&&(e={max:e}),e||(e={});var t=r(this,"max",e.max);(!t||"number"!=typeof t||0>=t)&&r(this,"max",1/0);var n=e.length||o;"function"!=typeof n&&(n=o),r(this,"lengthCalculator",n),r(this,"allowStale",e.stale||!1),r(this,"maxAge",e.maxAge||0),r(this,"dispose",e.dispose),this.reset()}function a(e,t,n,o){var i=n.value;s(e,i)&&(c(e,n),r(e,"allowStale")||(i=void 0)),i&&t.call(o,i.value,i.key,e)}function u(e,t,n){var o=r(e,"cache").get(t);if(o){var i=o.value;s(e,i)?(c(e,o),r(e,"allowStale")||(i=void 0)):n&&r(e,"lruList").unshiftNode(o),i&&(i=i.value)}return i}function s(e,t){if(!t||!t.maxAge&&!r(e,"maxAge"))return!1;var n=!1,o=Date.now()-t.now;return n=t.maxAge?o>t.maxAge:r(e,"maxAge")&&o>r(e,"maxAge")}function l(e){if(r(e,"length")>r(e,"max"))for(var t=r(e,"lruList").tail;r(e,"length")>r(e,"max")&&null!==t;){var n=t.prev;c(e,t),t=n}}function c(e,t){if(t){var n=t.value;r(e,"dispose")&&r(e,"dispose").call(this,n.key,n.value),r(e,"length",r(e,"length")-n.length),r(e,"cache")["delete"](n.key),r(e,"lruList").removeNode(t)}}function f(e,t,n,r,o){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=o||0}e.exports=i;var h,p=n(41),d=n(44),v=n(47),y={},m="function"==typeof Symbol;h=m?function(e){return Symbol["for"](e)}:function(e){return"_"+e},Object.defineProperty(i.prototype,"max",{set:function(e){(!e||"number"!=typeof e||0>=e)&&(e=1/0),r(this,"max",e),l(this)},get:function(){return r(this,"max")},enumerable:!0}),Object.defineProperty(i.prototype,"allowStale",{set:function(e){r(this,"allowStale",!!e)},get:function(){return r(this,"allowStale")},enumerable:!0}),Object.defineProperty(i.prototype,"maxAge",{set:function(e){(!e||"number"!=typeof e||0>e)&&(e=0),r(this,"maxAge",e),l(this)},get:function(){return r(this,"maxAge")},enumerable:!0}),Object.defineProperty(i.prototype,"lengthCalculator",{set:function(e){"function"!=typeof e&&(e=o),e!==r(this,"lengthCalculator")&&(r(this,"lengthCalculator",e),r(this,"length",0),r(this,"lruList").forEach(function(e){e.length=r(this,"lengthCalculator").call(this,e.value,e.key),r(this,"length",r(this,"length")+e.length)},this)),l(this)},get:function(){return r(this,"lengthCalculator")},enumerable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return r(this,"length")},enumerable:!0}),Object.defineProperty(i.prototype,"itemCount",{get:function(){return r(this,"lruList").length},enumerable:!0}),i.prototype.rforEach=function(e,t){t=t||this;for(var n=r(this,"lruList").tail;null!==n;){var o=n.prev;a(this,e,n,t),n=o}},i.prototype.forEach=function(e,t){t=t||this;for(var n=r(this,"lruList").head;null!==n;){var o=n.next;a(this,e,n,t),n=o}},i.prototype.keys=function(){return r(this,"lruList").toArray().map(function(e){return e.key},this)},i.prototype.values=function(){return r(this,"lruList").toArray().map(function(e){return e.value},this)},i.prototype.reset=function(){r(this,"dispose")&&r(this,"lruList")&&r(this,"lruList").length&&r(this,"lruList").forEach(function(e){r(this,"dispose").call(this,e.key,e.value)},this),r(this,"cache",new p),r(this,"lruList",new v),r(this,"length",0)},i.prototype.dump=function(){return r(this,"lruList").map(function(e){return s(this,e)?void 0:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}},this).toArray().filter(function(e){return e})},i.prototype.dumpLru=function(){return r(this,"lruList")},i.prototype.inspect=function(e,t){var n="LRUCache {",i=!1,a=r(this,"allowStale");a&&(n+="\n  allowStale: true",i=!0);var u=r(this,"max");u&&u!==1/0&&(i&&(n+=","),n+="\n  max: "+d.inspect(u,t),i=!0);var l=r(this,"maxAge");l&&(i&&(n+=","),n+="\n  maxAge: "+d.inspect(l,t),i=!0);var c=r(this,"lengthCalculator");c&&c!==o&&(i&&(n+=","),n+="\n  length: "+d.inspect(r(this,"length"),t),i=!0);var f=!1;return r(this,"lruList").forEach(function(e){f?n+=",\n  ":(i&&(n+=",\n"),f=!0,n+="\n  ");var r=d.inspect(e.key).split("\n").join("\n  "),a={value:e.value};e.maxAge!==l&&(a.maxAge=e.maxAge),c!==o&&(a.length=e.length),s(this,e)&&(a.stale=!0),a=d.inspect(a,t).split("\n").join("\n  "),n+=r+" => "+a}),(f||i)&&(n+="\n"),n+="}"},i.prototype.set=function(e,t,n){n=n||r(this,"maxAge");var o=n?Date.now():0,i=r(this,"lengthCalculator").call(this,t,e);if(r(this,"cache").has(e)){if(i>r(this,"max"))return c(this,r(this,"cache").get(e)),!1;var a=r(this,"cache").get(e),u=a.value;return r(this,"dispose")&&r(this,"dispose").call(this,e,u.value),u.now=o,u.maxAge=n,u.value=t,r(this,"length",r(this,"length")+(i-u.length)),u.length=i,this.get(e),l(this),!0}var s=new f(e,t,i,o,n);return s.length>r(this,"max")?(r(this,"dispose")&&r(this,"dispose").call(this,e,t),!1):(r(this,"length",r(this,"length")+s.length),r(this,"lruList").unshift(s),r(this,"cache").set(e,r(this,"lruList").head),l(this),!0)},i.prototype.has=function(e){if(!r(this,"cache").has(e))return!1;var t=r(this,"cache").get(e).value;return s(this,t)?!1:!0},i.prototype.get=function(e){return u(this,e,!0)},i.prototype.peek=function(e){return u(this,e,!1)},i.prototype.pop=function(){var e=r(this,"lruList").tail;return e?(c(this,e),e.value):null},i.prototype.del=function(e){c(this,r(this,"cache").get(e))},i.prototype.load=function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],o=r.e||0;if(0===o)this.set(r.k,r.v);else{var i=o-t;i>0&&this.set(r.k,r.v,i)}}},i.prototype.prune=function(){var e=this;r(this,"cache").forEach(function(t,n){u(e,n,!1)})}},function(e,t,n){(function(t){"pseudomap"===t.env.npm_package_name&&"test"===t.env.npm_lifecycle_script&&(t.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||t.env.TEST_PSEUDOMAP?e.exports=n(43):e.exports=Map}).call(t,n(42))},function(e,t){function n(){l=!1,a.length?s=a.concat(s):c=-1,s.length&&r()}function r(){if(!l){var e=setTimeout(n);l=!0;for(var t=s.length;t;){for(a=s,s=[];++c<t;)a&&a[c].run();c=-1,t=s.length}a=null,l=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var a,u=e.exports={},s=[],l=!1,c=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new o(e,t)),1!==s.length||l||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){function n(e){if(!(this instanceof n))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),e)if(e instanceof n||"function"==typeof Map&&e instanceof Map)e.forEach(function(e,t){this.set(t,e)},this);else{if(!Array.isArray(e))throw new TypeError("invalid argument");e.forEach(function(e){this.set(e[0],e[1])},this)}}function r(e,t){return e===t||e!==e&&t!==t}function o(e,t,n){this.key=e,this.value=t,this._index=n}function i(e,t){for(var n=0,o="_"+t,i=o;u.call(e,i);i=o+n++)if(r(e[i].key,t))return e[i]}function a(e,t,n){for(var i=0,a="_"+t,s=a;u.call(e,s);s=a+i++)if(r(e[s].key,t))return void(e[s].value=n);e.size++,e[s]=new o(t,n,s)}var u=Object.prototype.hasOwnProperty;e.exports=n,n.prototype.forEach=function(e,t){t=t||this,Object.keys(this._data).forEach(function(n){"size"!==n&&e.call(t,this._data[n].value,this._data[n].key)},this)},n.prototype.has=function(e){return!!i(this._data,e)},n.prototype.get=function(e){var t=i(this._data,e);return t&&t.value},n.prototype.set=function(e,t){a(this._data,e,t)},n.prototype["delete"]=function(e){var t=i(this._data,e);t&&(delete this._data[t._index],this._data.size--)},n.prototype.clear=function(){var e=Object.create(null);e.size=0,Object.defineProperty(this,"_data",{value:e,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(n.prototype,"size",{get:function(){return this._data.size},set:function(e){},enumerable:!0,configurable:!0}),n.prototype.values=n.prototype.keys=n.prototype.entries=function(){throw new Error("iterators are not implemented in this version")}},function(e,t,n){(function(e,r){function o(e,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),s(r,e,r.depth)}function i(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function a(e,t){return e}function u(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function s(e,n,r){if(e.customInspect&&n&&j(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return g(o)||(o=s(e,o,r)),o}var i=l(e,n);if(i)return i;var a=Object.keys(n),v=u(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),O(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(j(n)){var y=n.name?": "+n.name:"";return e.stylize("[Function"+y+"]","special")}if(w(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(O(n))return c(n)}var m="",_=!1,b=["{","}"];if(d(n)&&(_=!0,b=["[","]"]),j(n)){var x=n.name?": "+n.name:"";m=" [Function"+x+"]"}if(w(n)&&(m=" "+RegExp.prototype.toString.call(n)),E(n)&&(m=" "+Date.prototype.toUTCString.call(n)),O(n)&&(m=" "+c(n)),0===a.length&&(!_||0==n.length))return b[0]+m+b[1];if(0>r)return w(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var M;return M=_?f(e,n,r,v,a):a.map(function(t){return h(e,n,r,v,t,_)}),e.seen.pop(),p(M,m,b)}function l(e,t){if(x(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return _(t)?e.stylize(""+t,"number"):v(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o){for(var i=[],a=0,u=t.length;u>a;++a)S(t,String(a))?i.push(h(e,t,n,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(h(e,t,n,r,o,!0))}),i}function h(e,t,n,r,o,i){var a,u,l;if(l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]},l.get?u=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(u=e.stylize("[Setter]","special")),S(r,o)||(a="["+o+"]"),u||(e.seen.indexOf(l.value)<0?(u=y(n)?s(e,l.value,null):s(e,l.value,n-1),u.indexOf("\n")>-1&&(u=i?u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special")),x(a)){if(i&&o.match(/^\d+$/))return u;a=JSON.stringify(""+o),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+u}function p(e,t,n){var r=0,o=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return o>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function y(e){return null===e}function m(e){return null==e}function _(e){return"number"==typeof e}function g(e){return"string"==typeof e}function b(e){return"symbol"==typeof e}function x(e){return void 0===e}function w(e){return M(e)&&"[object RegExp]"===k(e)}function M(e){return"object"==typeof e&&null!==e}function E(e){return M(e)&&"[object Date]"===k(e)}function O(e){return M(e)&&("[object Error]"===k(e)||e instanceof Error)}function j(e){return"function"==typeof e}function P(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function k(e){return Object.prototype.toString.call(e)}function T(e){return 10>e?"0"+e.toString(10):e.toString(10)}function L(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var C=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,a=String(e).replace(C,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}}),u=r[n];i>n;u=r[++n])a+=y(u)||!M(u)?" "+u:" "+o(u);return a},t.deprecate=function(n,o){function i(){if(!a){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),a=!0}return n.apply(this,arguments)}if(x(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(r.noDeprecation===!0)return n;var a=!1;return i};var A,R={};t.debuglog=function(e){if(x(A)&&(A=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!R[e])if(new RegExp("\\b"+e+"\\b","i").test(A)){var n=r.pid;R[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else R[e]=function(){};return R[e]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=v,t.isNull=y,t.isNullOrUndefined=m,t.isNumber=_,t.isString=g,t.isSymbol=b,t.isUndefined=x,t.isRegExp=w,t.isObject=M,t.isDate=E,t.isError=O,t.isFunction=j,t.isPrimitive=P,t.isBuffer=n(45);var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",L(),t.format.apply(t,arguments))},t.inherits=n(46),t._extend=function(e,t){if(!t||!M(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,function(){return this}(),n(42))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach(function(e){t.push(e)});else if(arguments.length>0)for(var r=0,o=arguments.length;o>r;r++)t.push(arguments[r]);return t}function r(e,t){e.tail=new i(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new i(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function i(e,t,n,r){return this instanceof i?(this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,void(n?(n.prev=this,this.next=n):this.next=null)):new i(e,t,n,r)}e.exports=n,n.Node=i,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;t>e;e++)r(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;t>e;e++)o(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail.next=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head.prev=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},n.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&e>t;t++)n=n.next;return t===e&&null!==n?n.value:void 0},n.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&e>t;t++)n=n.prev;return t===e&&null!==n?n.value:void 0},n.prototype.map=function(e,t){t=t||this;for(var r=new n,o=this.head;null!==o;)r.push(e.call(t,o.value,this)),o=o.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,o=this.tail;null!==o;)r.push(e.call(t,o.value,this)),o=o.prev;return r},n.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var o=0;null!==r;o++)n=e(n,r.value,o),r=r.next;return n},n.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var o=this.length-1;null!==r;o--)n=e(n,r.value,o),r=r.prev;return n},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},n.prototype.slice=function(e,t){t=t||this.length,0>t&&(t+=this.length),e=e||0,0>e&&(e+=this.length);var r=new n;if(e>t||0>t)return r;0>e&&(e=0),t>this.length&&(t=this.length);for(var o=0,i=this.head;null!==i&&e>o;o++)i=i.next;for(;null!==i&&t>o;o++,i=i.next)r.push(i.value);return r},n.prototype.sliceReverse=function(e,t){t=t||this.length,0>t&&(t+=this.length),e=e||0,0>e&&(e+=this.length);var r=new n;if(e>t||0>t)return r;0>e&&(e=0),t>this.length&&(t=this.length);for(var o=this.length,i=this.tail;null!==i&&o>t;o--)i=i.prev;for(;null!==i&&o>e;o--,i=i.prev)r.push(i.value);return r},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this}},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(49),l=r(s),c=n(50),f=(r(c),n(24)),h=r(f),p=function(e){function t(e,n,r){o(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n,r)}return i(t,e),a(t,[{key:"requestTileAsync",value:function(){var e=this;setTimeout(function(){e._mesh||(e._mesh=e._createMesh(),e._requestTile())},0)}},{key:"destroy",value:function(){this._abortRequest(),this._image=null,u(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_createMesh",value:function(){if(this._center){var e,t=new h["default"].Object3D,n=new h["default"].PlaneBufferGeometry(this._side,this._side,1);this._world._environment._skybox?(e=new h["default"].MeshStandardMaterial({depthWrite:!1}),e.roughness=1,e.metalness=.1,e.envMap=this._world._environment._skybox.getRenderTarget()):e=new h["default"].MeshBasicMaterial({depthWrite:!1});var r=new h["default"].Mesh(n,e);return r.rotation.x=-90*Math.PI/180,r.receiveShadow=!0,t.add(r),t.renderOrder=0,t.position.x=this._center[0],t.position.z=this._center[1],t}}},{key:"_createDebugMesh",value:function(){var e=document.createElement("canvas");e.width=256,e.height=256;var t=e.getContext("2d");t.font="Bold 20px Helvetica Neue, Verdana, Arial",t.fillStyle="#ff0000",t.fillText(this._quadcode,20,e.width/2-5),t.fillText(this._tile.toString(),20,e.width/2+25);var n=new h["default"].Texture(e);n.magFilter=h["default"].LinearFilter,n.minFilter=h["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0;var r=new h["default"].MeshBasicMaterial({map:n,transparent:!0,depthWrite:!1}),o=new h["default"].PlaneBufferGeometry(this._side,this._side,1),i=new h["default"].Mesh(o,r);return i.rotation.x=-90*Math.PI/180,i.position.y=.1,i}},{key:"_requestTile",value:function(){var e=this,t={x:this._tile[0],y:this._tile[1],z:this._tile[2]},n=this._getTileURL(t),r=document.createElement("img");r.addEventListener("load",function(t){var n=new h["default"].Texture;n.image=r,n.needsUpdate=!0,n.magFilter=h["default"].LinearFilter,n.minFilter=h["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0,e._mesh&&e._mesh.children[0]&&e._mesh.children[0].material&&(e._mesh.children[0].material.map=n,e._mesh.children[0].material.needsUpdate=!0,e._texture=n,e._ready=!0)},!1),r.crossOrigin="",r.src=n,this._image=r}},{key:"_abortRequest",value:function(){this._image&&(this._image.src="")}}]),t}(l["default"]);t["default"]=function(e,t,n){return new p(e,t,n)},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(11),u=(r(a),n(10)),s=r(u),l=n(24),c=r(l),f=180/Math.PI,h=/\{([szxy])\}/g,p=function(){function e(t,n,r){o(this,e),this._layer=r,this._world=r._world,this._quadcode=t,this._path=n,this._ready=!1,this._tile=this._quadcodeToTile(t),this._boundsLatLon=this._tileBoundsWGS84(this._tile),this._boundsWorld=this._tileBoundsFromWGS84(this._boundsLatLon),this._center=this._boundsToCenter(this._boundsWorld),this._centerLatlon=this._world.pointToLatLon(VIZI.Point(this._center[0],this._center[1])),this._side=this._getSide(this._boundsWorld),this._pointScale=this._world.pointScale(this._centerLatlon)}return i(e,[{key:"isReady",value:function(){return this._ready}},{key:"requestTileAsync",value:function(){}},{key:"getQuadcode",value:function(){return this._quadcode}},{key:"getBounds",value:function(){return this._boundsWorld}},{key:"getCenter",value:function(){return this._center}},{key:"getSide",value:function(){return this._side}},{key:"getMesh",value:function(){return this._mesh}},{key:"destroy",value:function(){this._layer=null,this._world=null,this._boundsLatLon=null,this._boundsWorld=null,this._center=null,this._mesh&&(this._mesh.children?this._mesh.children.forEach(function(e){e.geometry.dispose(),e.geometry=null,e.material.map&&(e.material.map.dispose(),e.material.map=null),e.material.dispose(),e.material=null}):(this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.map&&(this._mesh.material.map.dispose(),this._mesh.material.map=null),this._mesh.material.dispose(),this._mesh.material=null))}},{key:"_createMesh",value:function(){}},{key:"_createDebugMesh",value:function(){}},{key:"_getTileURL",value:function(e){return e.s||(e.s=String.fromCharCode(97+Math.floor(3*Math.random()))),h.lastIndex=0,this._path.replace(h,function(t,n){return e[n]})}},{key:"_quadcodeToTile",value:function(e){for(var t=0,n=0,r=e.length,o=r;o>0;o--){var i=1<<o-1,a=+e[r-o];1===a&&(t|=i),2===a&&(n|=i),3===a&&(t|=i,n|=i)}return[t,n,r]}},{key:"_tileBoundsFromWGS84",value:function(e){var t=this._layer._world.latLonToPoint((0,s["default"])(e[1],e[0])),n=this._layer._world.latLonToPoint((0,s["default"])(e[3],e[2]));return[t.x,t.y,n.x,n.y]}},{key:"_tileBoundsWGS84",value:function(e){var t=this._tile2lon(e[0]+1,e[2]),n=this._tile2lon(e[0],e[2]),r=this._tile2lat(e[1]+1,e[2]),o=this._tile2lat(e[1],e[2]);return[n,r,t,o]}},{key:"_tile2lon",value:function(e,t){return e/Math.pow(2,t)*360-180}},{key:"_tile2lat",value:function(e,t){var n=Math.PI-2*Math.PI*e/Math.pow(2,t);return f*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))}},{key:"_boundsToCenter",value:function(e){var t=e[0]+(e[2]-e[0])/2,n=e[1]+(e[3]-e[1])/2;return[t,n]}},{key:"_getSide",value:function(e){return new c["default"].Vector3(e[0],0,e[3]).sub(new c["default"].Vector3(e[0],0,e[1])).length()}}]),e}();t["default"]=p,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o);BoxHelper=function(e){var t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new i["default"].BufferGeometry;r.setIndex(new i["default"].BufferAttribute(t,1)),r.addAttribute("position",new i["default"].BufferAttribute(n,3)),i["default"].LineSegments.call(this,r,new i["default"].LineBasicMaterial({linewidth:2,color:16711680})),void 0!==e&&this.update(e)},BoxHelper.prototype=Object.create(i["default"].LineSegments.prototype),BoxHelper.prototype.constructor=BoxHelper,BoxHelper.prototype.update=function(){var e=new i["default"].Box3;return function(t){if(e.setFromObject(t),!e.isEmpty()){var n=e.min,r=e.max,o=this.geometry.attributes.position,i=o.array;i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=n.x,i[4]=r.y,i[5]=r.z,i[6]=n.x,i[7]=n.y,i[8]=r.z,i[9]=r.x,i[10]=n.y,i[11]=r.z,i[12]=r.x,i[13]=r.y,i[14]=n.z,i[15]=n.x,i[16]=r.y,i[17]=n.z,i[18]=n.x,i[19]=n.y,i[20]=n.z,i[21]=r.x,i[22]=n.y,i[23]=n.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),t["default"]=BoxHelper,e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(24),i=r(o);t["default"]=function(e,t){var n=document.createElement("canvas");n.width=1,n.height=1;var r=n.getContext("2d");r.fillStyle=e,r.fillRect(0,0,n.width,n.height);var o=new i["default"].Texture(n);o.needsUpdate=!0;var a;return t?(a=new i["default"].MeshStandardMaterial({depthWrite:!1}),a.roughness=1,a.metalness=.1,a.envMap=t):a=new i["default"].MeshBasicMaterial({map:o,depthWrite:!1}),a},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},s=n(38),l=r(s),c=n(3),f=r(c),h=n(53),p=r(h),d=n(35),v=r(d),y=n(24),m=(r(y),function(e){function t(e,n){o(this,t);var r={maxLOD:14,distance:2e3};n=(0,f["default"])(r,n),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,n),this._path=e}return i(t,e),a(t,[{key:"_onAdd",value:function(e){var n=this;u(Object.getPrototypeOf(t.prototype),"_onAdd",this).call(this,e),setTimeout(function(){n._calculateLOD(),n._initEvents()},0)}},{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,v["default"])(this._onWorldUpdate,100),this._world.on("preUpdate",this._throttledWorldUpdate,this),this._world.on("move",this._onWorldMove,this)}},{key:"_onWorldUpdate",value:function(){this._calculateLOD()}},{key:"_onWorldMove",value:function(e,t){}},{key:"_createTile",value:function(e,t){var n={};return this._options.filter&&(n.filter=this._options.filter),this._options.style&&(n.style=this._options.style),(0,p["default"])(e,this._path,t,n)}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._world.off("move",this._onWorldMove),this._throttledWorldUpdate=null,u(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(l["default"]));t["default"]=function(e,t){return new m(e,t)},e.exports=t["default"]},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e,t,n){for(var r=!0;r;){var o=e,i=t,a=n;r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var s=u.get;if(void 0===s)return;return s.call(a)}var l=Object.getPrototypeOf(o);if(null===l)return;e=l,t=i,n=a,r=!0,u=l=void 0}},l=n(49),c=r(l),f=n(50),h=(r(f),n(24)),p=r(h),d=n(54),v=r(d),y=n(56),m=r(y),_=n(11),g=r(_),b=n(10),x=r(b),w=n(57),M=r(w),E=n(3),O=r(E),j=n(58),P=r(j),k=function(e){function t(e,n,r,i){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n,r);var a={filter:null,style:{color:"#ffffff"}};this._options=(0,O["default"])(a,i)}return a(t,e),u(t,[{key:"requestTileAsync",value:function(){var e=this;setTimeout(function(){e._mesh||(e._mesh=e._createMesh(),e._requestTile())},0)}},{key:"destroy",value:function(){this._abortRequest(),this._request=null,s(Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"_createMesh",value:function(){if(this._center){var e=new p["default"].Object3D;
return e.position.x=this._center[0],e.position.z=this._center[1],e}}},{key:"_createDebugMesh",value:function(){var e=document.createElement("canvas");e.width=256,e.height=256;var t=e.getContext("2d");t.font="Bold 20px Helvetica Neue, Verdana, Arial",t.fillStyle="#ff0000",t.fillText(this._quadcode,20,e.width/2-5),t.fillText(this._tile.toString(),20,e.width/2+25);var n=new p["default"].Texture(e);n.magFilter=p["default"].LinearFilter,n.minFilter=p["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0;var r=new p["default"].MeshBasicMaterial({map:n,transparent:!0,depthWrite:!1}),o=new p["default"].PlaneBufferGeometry(this._side,this._side,1),i=new p["default"].Mesh(o,r);return i.rotation.x=-90*Math.PI/180,i.position.y=.1,i}},{key:"_requestTile",value:function(){var e=this,t={x:this._tile[0],y:this._tile[1],z:this._tile[2]},n=this._getTileURL(t);this._request=(0,v["default"])({url:n,type:"json",crossOrigin:!0}).then(function(t){e._request=null,e._processTileData(t)})["catch"](function(t){console.error(t),e._request=null})}},{key:"_processTileData",value:function(e){var t=this;console.time(this._tile);var n=m["default"].feature(e,e.objects.vectile),r=(0,g["default"])(0,0);r.x=-1*this._center[0],r.y=-1*this._center[1];var o,i,a=[],u=[],s=[],l=0,c=new p["default"].Color,f=n.features;this._options.filter&&(f=n.features.filter(this._options.filter));var h=this._options.style;if(f.forEach(function(e){"function"==typeof t._options.style&&(h=t._options.style(e));var n=e.geometry.coordinates;if(n[0]&&n[0][0]&&Array.isArray(n[0][0])){n=n.map(function(e){return e.map(function(e){var n=(0,x["default"])(e[1],e[0]),r=t._layer._world.latLonToPoint(n);return[r.x,r.y]})}),o=t._toEarcut(n),i=t._triangulate(o.vertices,o.holes,o.dimensions);var r=[];for(C=0,il=o.vertices.length;C<il;C+=o.dimensions)r.push(o.vertices.slice(C,C+o.dimensions));var f=0;h.height&&(f=t._world.metresToWorld(h.height,t._pointScale));var p=(0,P["default"])(r,i,{bottom:0,top:f});c.set(h.color),a.push(p.positions),s.push([c.r,c.g,c.b]),u.push(p.faces),l+=p.faces.length}}),0===l)return void(this._ready=!0);for(var d,v,y,_,b=new p["default"].BufferGeometry,w=new Float32Array(9*l),M=new Float32Array(9*l),E=new Float32Array(9*l),O=new p["default"].Vector3,j=new p["default"].Vector3,k=new p["default"].Vector3,T=new p["default"].Vector3,L=new p["default"].Vector3,S=0,C=0;C<u.length;C++){v=u[C],y=a[C],_=s[C];for(var A=0;A<v.length;A++){d=v[A][0];var R=y[d][0]+r.x,D=y[d][1],q=y[d][2]+r.y;d=v[A][1];var z=y[d][0]+r.x,F=y[d][1],H=y[d][2]+r.y;d=v[A][2];var N=y[d][0]+r.x,I=y[d][1],U=y[d][2]+r.y;O.set(R,D,q),j.set(z,F,H),k.set(N,I,U),T.subVectors(k,j),L.subVectors(O,j),T.cross(L),T.normalize();var W=T.x,B=T.y,Z=T.z;w[9*S+0]=R,w[9*S+1]=D,w[9*S+2]=q,M[9*S+0]=W,M[9*S+1]=B,M[9*S+2]=Z,E[9*S+0]=_[0],E[9*S+1]=_[1],E[9*S+2]=_[2],w[9*S+3]=z,w[9*S+4]=F,w[9*S+5]=H,M[9*S+3]=W,M[9*S+4]=B,M[9*S+5]=Z,E[9*S+3]=_[0],E[9*S+4]=_[1],E[9*S+5]=_[2],w[9*S+6]=N,w[9*S+7]=I,w[9*S+8]=U,M[9*S+6]=W,M[9*S+7]=B,M[9*S+8]=Z,E[9*S+6]=_[0],E[9*S+7]=_[1],E[9*S+8]=_[2],S++}}b.addAttribute("position",new p["default"].BufferAttribute(w,3)),b.addAttribute("normal",new p["default"].BufferAttribute(M,3)),b.addAttribute("color",new p["default"].BufferAttribute(E,3)),b.computeBoundingBox();var V;this._world._environment._skybox?(V=new p["default"].MeshStandardMaterial({vertexColors:p["default"].VertexColors,side:p["default"].BackSide}),V.roughness=1,V.metalness=.1,V.envMapIntensity=3,V.envMap=this._world._environment._skybox.getRenderTarget()):V=new p["default"].MeshPhongMaterial({vertexColors:p["default"].VertexColors,side:p["default"].BackSide});var G=new p["default"].Mesh(b,V);G.castShadow=!0,G.receiveShadow=!0,this._mesh.add(G),this._ready=!0,console.timeEnd(this._tile),console.log(this._tile+": "+f.length+" features")}},{key:"_toEarcut",value:function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,o=0;o<e.length;o++){for(var i=0;i<e[o].length;i++)for(var a=0;t>a;a++)n.vertices.push(e[o][i][a]);o>0&&(r+=e[o-1].length,n.holes.push(r))}return n}},{key:"_triangulate",value:function(e,t,n){var r=(0,M["default"])(e,t,n),o=[];for(i=0,il=r.length;i<il;i+=3)o.push(r.slice(i,i+3));return o}},{key:"_abortRequest",value:function(){this._request&&this._request.abort()}}]),t}(c["default"]);t["default"]=function(e,t,n,r){return new k(e,t,n,r)},e.exports=t["default"]},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():(__WEBPACK_AMD_DEFINE_FACTORY__=n,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}("reqwest",this,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){return e._aborted?n(e.request):e._timedOut?n(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request)))}}function setHeaders(e,t){var n,r=t.headers||{};r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var o="undefined"!=typeof FormData&&t.data instanceof FormData;t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||o||(r[contentType]=t.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var o=uniqid++,i=e.jsonpCallback||"callback",a=e.jsonpCallbackName||reqwest.getcallbackPrefix(o),u=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),s=r.match(u),l=doc.createElement("script"),c=0,f=-1!==navigator.userAgent.indexOf("MSIE 10.0");return s?"?"===s[3]?r=r.replace(u,"$1="+a):a=s[3]:r=urlappend(r,i+"="+a),context[a]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,"undefined"==typeof l.onreadystatechange||f||(l.htmlFor=l.id="_reqwest_"+o),l.onload=l.onreadystatechange=function(){return l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||c?!1:(l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),t(lastValue),lastValue=void 0,head.removeChild(l),void(c=1))},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),c=1}}}function getRequest(e,t){var n,r=this.o,o=(r.method||"GET").toUpperCase(),i="string"==typeof r?r:r.url,a=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,u=!1;return"jsonp"!=r.type&&"GET"!=o||!a||(i=urlappend(i,a),a=null),"jsonp"==r.type?handleJsonp(r,e,t,i):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(o,i,r.async===!1?!1:!0),setHeaders(n,r),setCredentials(n,r),context[xDomainRequest]&&n instanceof context[xDomainRequest]?(n.onload=e,n.onerror=t,n.onprogress=function(){},u=!0):n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),u?setTimeout(function(){n.send(a)},200):n.send(a),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){return null!==e?e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0:void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n,r,o,i,a=e.name,u=e.tagName.toLowerCase(),s=function(e){e&&!e.disabled&&t(a,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&a)switch(u){case"input":/reset|button|image|file/i.test(e.type)||(n=/checkbox/i.test(e.type),r=/radio/i.test(e.type),o=e.value,(!(n||r)||e.checked)&&t(a,normalize(n&&""===o?"on":o)));break;case"textarea":t(a,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())s(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&s(e.options[i])}}function eachFormElement(){var e,t,n=this,r=function(e,t){var r,o,i;for(r=0;r<t.length;r++)for(i=e[byTag](t[r]),o=0;o<i.length;o++)serial(i[o],n)};for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,n),r(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}function buildParams(e,t,n,r){var o,i,a,u=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)a=t[i],n||u.test(e)?r(e,a):buildParams(e+"["+("object"==typeof a?i:"")+"]",a,n,r);else if(t&&"[object Object]"===t.toString())for(o in t)buildParams(e+"["+o+"]",t[o],n,r);else r(e,t)}var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=__webpack_require__(55)}catch(ex){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},"catch":function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,r,o=t||!1,i=[],a=encodeURIComponent,u=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=a(e)+"="+a(t)};if(isArray(e))for(r=0;e&&r<e.length;r++)u(e[r].name,e[r].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],o,u);return i.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})},function(e,t){},function(e,t,n){!function(e,n){n(t)}(this,function(e){"use strict";function t(){}function n(e){if(!e)return t;var n,r,o=e.scale[0],i=e.scale[1],a=e.translate[0],u=e.translate[1];return function(e,t){t||(n=r=0),e[0]=(n+=e[0])*o+a,e[1]=(r+=e[1])*i+u}}function r(e){if(!e)return t;var n,r,o=e.scale[0],i=e.scale[1],a=e.translate[0],u=e.translate[1];return function(e,t){t||(n=r=0);var s=(e[0]-a)/o|0,l=(e[1]-u)/i|0;e[0]=s-n,e[1]=l-r,n=s,r=l}}function o(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n}function i(e,t){for(var n=0,r=e.length;r>n;){var o=n+r>>>1;e[o]<t?n=o+1:r=o}return n}function a(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return u(e,t)})}:u(e,t)}function u(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(e,t)};return null==t.id&&delete n.id,n}function s(e,t){function r(e,t){t.length&&t.pop();for(var n,r=f[0>e?~e:e],i=0,a=r.length;a>i;++i)t.push(n=r[i].slice()),c(n,i);0>e&&o(t,a)}function i(e){return e=e.slice(),c(e,0),e}function a(e){for(var t=[],n=0,o=e.length;o>n;++n)r(e[n],t);return t.length<2&&t.push(t[0].slice()),t}function u(e){for(var t=a(e);t.length<4;)t.push(t[0].slice());return t}function s(e){return e.map(u)}function l(e){var t=e.type;return"GeometryCollection"===t?{type:t,geometries:e.geometries.map(l)}:t in h?{type:t,coordinates:h[t](e)}:null}var c=n(e.transform),f=e.arcs,h={Point:function(e){return i(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(i)},LineString:function(e){return a(e.arcs)},MultiLineString:function(e){return e.arcs.map(a)},Polygon:function(e){return s(e.arcs)},MultiPolygon:function(e){return e.arcs.map(s)}};return l(t)}function l(e,t){function n(t){var n,r=e.arcs[0>t?~t:t],o=r[0];return e.transform?(n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]})):n=r[r.length-1],0>t?[n,o]:[o,n]}function r(e,t){for(var n in e){var r=e[n];delete t[r.start],delete r.start,delete r.end,r.forEach(function(e){o[0>e?~e:e]=1}),u.push(r)}}var o={},i={},a={},u=[],s=-1;return t.forEach(function(n,r){var o,i=e.arcs[0>n?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++s],t[s]=n,t[r]=o)}),t.forEach(function(e){var t,r,o=n(e),u=o[0],s=o[1];if(t=a[u])if(delete a[t.end],t.push(e),t.end=s,r=i[s]){delete i[r.start];var l=r===t?t:t.concat(r);i[l.start=t.start]=a[l.end=r.end]=l}else i[t.start]=a[t.end]=t;else if(t=i[s])if(delete i[t.start],t.unshift(e),t.start=u,r=a[u]){delete a[r.end];var c=r===t?t:r.concat(t);i[c.start=r.start]=a[c.end=t.end]=c}else i[t.start]=a[t.end]=t;else t=[e],i[t.start=u]=a[t.end=s]=t}),r(a,i),r(i,a),t.forEach(function(e){o[0>e?~e:e]||u.push([e])}),u}function c(e){return s(e,f.apply(this,arguments))}function f(e,t,n){function r(e){var t=0>e?~e:e;(c[t]||(c[t]=[])).push({i:e,g:s})}function o(e){e.forEach(r)}function i(e){e.forEach(o)}function a(e){"GeometryCollection"===e.type?e.geometries.forEach(a):e.type in f&&(s=e,f[e.type](e.arcs))}var u=[];if(arguments.length>1){var s,c=[],f={LineString:o,MultiLineString:i,Polygon:i,MultiPolygon:function(e){e.forEach(i)}};a(t),c.forEach(arguments.length<3?function(e){u.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&u.push(e[0].i)})}else for(var h=0,p=e.arcs.length;p>h;++h)u.push(h);return{type:"MultiLineString",arcs:l(e,u)}}function h(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function p(e){for(var t,n=-1,r=e.length,o=e[r-1],i=0;++n<r;)t=o,o=e[n],i+=t[0]*o[1]-t[1]*o[0];return i/2}function d(e){return s(e,v.apply(this,arguments))}function v(e,t){function n(e){e.forEach(function(t){t.forEach(function(t){(o[t=0>t?~t:t]||(o[t]=[])).push(e)})}),i.push(e)}function r(t){return p(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var o={},i=[],a=[];return t.forEach(function(e){"Polygon"===e.type?n(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(n)}),i.forEach(function(e){if(!e._){var t=[],n=[e];for(e._=1,a.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){o[0>e?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),i.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:a.map(function(t){var n,i=[];if(t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){o[0>e?~e:e].length<2&&i.push(e)})})}),i=l(e,i),(n=i.length)>1)for(var a,u=r(t[0][0]),s=0;n>s;++s)if(u===r(i[s])){a=i[0],i[0]=i[s],i[s]=a;break}return i})}}function y(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var n=o[e];n?n.push(t):o[e]=[t]})}function n(e,n){e.forEach(function(e){t(e,n)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in u&&u[e.type](e.arcs,t)}var o={},a=e.map(function(){return[]}),u={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(r);for(var s in o)for(var l=o[s],c=l.length,f=0;c>f;++f)for(var h=f+1;c>h;++h){var p,d=l[f],v=l[h];(p=a[d])[s=i(p,v)]!==v&&p.splice(s,0,v),(p=a[v])[s=i(p,d)]!==d&&p.splice(s,0,d)}return a}function m(e,t){return e[1][2]-t[1][2]}function _(){function e(e,t){for(;t>0;){var n=(t+1>>1)-1,o=r[n];if(m(e,o)>=0)break;r[o._=t]=o,r[e._=t=n]=e}}function t(e,t){for(;;){var n=t+1<<1,i=n-1,a=t,u=r[a];if(o>i&&m(r[i],u)<0&&(u=r[a=i]),o>n&&m(r[n],u)<0&&(u=r[a=n]),a===t)break;r[u._=t]=u,r[e._=t=a]=e}}var n={},r=[],o=0;return n.push=function(t){return e(r[t._=o]=t,o++),o},n.pop=function(){if(!(0>=o)){var e,n=r[0];return--o>0&&(e=r[o],t(r[e._=0]=e,0)),n}},n.remove=function(n){var i,a=n._;if(r[a]===n)return a!==--o&&(i=r[o],(m(i,n)<0?e:t)(r[i._=a]=i,a)),a},n}function g(e,t){function o(e){u.remove(e),e[1][2]=t(e),u.push(e)}var i=n(e.transform),a=r(e.transform),u=_();return t||(t=h),e.arcs.forEach(function(e){var n,r,s,l,c=[],f=0;for(r=0,s=e.length;s>r;++r)l=e[r],i(e[r]=[l[0],l[1],1/0],r);for(r=1,s=e.length-1;s>r;++r)n=e.slice(r-1,r+2),n[1][2]=t(n),c.push(n),u.push(n);for(r=0,s=c.length;s>r;++r)n=c[r],n.previous=c[r-1],n.next=c[r+1];for(;n=u.pop();){var h=n.previous,p=n.next;n[1][2]<f?n[1][2]=f:f=n[1][2],h&&(h.next=p,h[2]=n[2],o(h)),p&&(p.previous=h,p[0]=n[0],o(p))}e.forEach(a)}),e}var b="1.6.24";e.version=b,e.mesh=c,e.meshArcs=f,e.merge=d,e.mergeArcs=v,e.feature=a,e.neighbors=y,e.presimplify=g})},function(e,t){"use strict";function n(e,t,n){n=n||2;var o=t&&t.length,a=o?t[0]*n:e.length,u=r(e,0,a,n,!0),s=[];if(!u)return s;var l,f,h,p,d,v,y;if(o&&(u=c(e,t,u,n)),e.length>80*n){l=h=e[0],f=p=e[1];for(var m=n;a>m;m+=n)d=e[m],v=e[m+1],l>d&&(l=d),f>v&&(f=v),d>h&&(h=d),v>p&&(p=v);y=Math.max(h-l,p-f)}return i(u,s,n,l,f,y),s}function r(e,t,n,r,o){var i,a,u,s=0;for(i=t,a=n-r;n>i;i+=r)s+=(e[a]-e[i])*(e[i+1]+e[a+1]),a=i;if(o===s>0)for(i=t;n>i;i+=r)u=P(i,e[i],e[i+1],u);else for(i=n-r;i>=t;i-=r)u=P(i,e[i],e[i+1],u);return u}function o(e,t){if(!e)return e;t||(t=e);var n,r=e;do if(n=!1,r.steiner||!x(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(k(r),r=t=r.prev,r===r.next)return null;n=!0}while(n||r!==t);return t}function i(e,t,n,r,c,f,h){if(e){!h&&f&&d(e,r,c,f);for(var p,v,y=e;e.prev!==e.next;)if(p=e.prev,v=e.next,f?u(e,r,c,f):a(e))t.push(p.i/n),t.push(e.i/n),t.push(v.i/n),k(e),e=v.next,y=v.next;else if(e=v,e===y){h?1===h?(e=s(e,t,n),i(e,t,n,r,c,f,2)):2===h&&l(e,t,n,r,c,f):i(o(e),t,n,r,c,f,1);break}}}function a(e){var t=e.prev,n=e,r=e.next;if(b(t,n,r)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(_(t.x,t.y,n.x,n.y,r.x,r.y,o.x,o.y)&&b(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function u(e,t,n,r){var o=e.prev,i=e,a=e.next;if(b(o,i,a)>=0)return!1;for(var u=o.x<i.x?o.x<a.x?o.x:a.x:i.x<a.x?i.x:a.x,s=o.y<i.y?o.y<a.y?o.y:a.y:i.y<a.y?i.y:a.y,l=o.x>i.x?o.x>a.x?o.x:a.x:i.x>a.x?i.x:a.x,c=o.y>i.y?o.y>a.y?o.y:a.y:i.y>a.y?i.y:a.y,f=y(u,s,t,n,r),h=y(l,c,t,n,r),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&_(o.x,o.y,i.x,i.y,a.x,a.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=f;){if(p!==e.prev&&p!==e.next&&_(o.x,o.y,i.x,i.y,a.x,a.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function s(e,t,n){var r=e;do{var o=r.prev,i=r.next.next;w(o,r,r.next,i)&&E(o,i)&&E(i,o)&&(t.push(o.i/n),t.push(r.i/n),t.push(i.i/n),k(r),k(r.next),r=e=i),r=r.next}while(r!==e);return r}function l(e,t,n,r,a,u){var s=e;do{for(var l=s.next.next;l!==s.prev;){if(s.i!==l.i&&g(s,l)){var c=j(s,l);return s=o(s,s.next),c=o(c,c.next),i(s,t,n,r,a,u),void i(c,t,n,r,a,u)}l=l.next}s=s.next}while(s!==e)}function c(e,t,n,i){var a,u,s,l,c,p=[];for(a=0,u=t.length;u>a;a++)s=t[a]*i,l=u-1>a?t[a+1]*i:e.length,c=r(e,s,l,i,!1),c===c.next&&(c.steiner=!0),p.push(m(c));for(p.sort(f),a=0;a<p.length;a++)h(p[a],n),n=o(n,n.next);return n}function f(e,t){return e.x-t.x}function h(e,t){if(t=p(e,t)){var n=j(t,e);o(n,n.next)}}function p(e,t){var n,r=t,o=e.x,i=e.y,a=-(1/0);do{if(i<=r.y&&i>=r.next.y){var u=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);o>=u&&u>a&&(a=u,n=r.x<r.next.x?r:r.next)}r=r.next}while(r!==t);if(!n)return null;if(e.x===n.x)return n.prev;var s,l=n,c=1/0;for(r=n.next;r!==l;)o>=r.x&&r.x>=n.x&&_(i<n.y?o:a,i,n.x,n.y,i<n.y?a:o,i,r.x,r.y)&&(s=Math.abs(i-r.y)/(o-r.x),(c>s||s===c&&r.x>n.x)&&E(r,e)&&(n=r,c=s)),r=r.next;return n}function d(e,t,n,r){var o=e;do null===o.z&&(o.z=y(o.x,o.y,t,n,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,v(o)}function v(e){var t,n,r,o,i,a,u,s,l=1;do{for(n=e,e=null,i=null,a=0;n;){for(a++,r=n,u=0,t=0;l>t&&(u++,r=r.nextZ,r);t++);for(s=l;u>0||s>0&&r;)0===u?(o=r,r=r.nextZ,s--):0!==s&&r?n.z<=r.z?(o=n,n=n.nextZ,u--):(o=r,r=r.nextZ,s--):(o=n,n=n.nextZ,u--),i?i.nextZ=o:e=o,o.prevZ=i,i=o;n=r}i.nextZ=null,l*=2}while(a>1);return e}function y(e,t,n,r,o){return e=32767*(e-n)/o,t=32767*(t-r)/o,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1}function m(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n}function _(e,t,n,r,o,i,a,u){return(o-a)*(t-u)-(e-a)*(i-u)>=0&&(e-a)*(r-u)-(n-a)*(t-u)>=0&&(n-a)*(i-u)-(o-a)*(r-u)>=0}function g(e,t){return x(e,t)||e.next.i!==t.i&&e.prev.i!==t.i&&!M(e,t)&&E(e,t)&&E(t,e)&&O(e,t)}function b(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function x(e,t){return e.x===t.x&&e.y===t.y}function w(e,t,n,r){return b(e,t,n)>0!=b(e,t,r)>0&&b(n,r,e)>0!=b(n,r,t)>0}function M(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&w(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function E(e,t){return b(e.prev,e,e.next)<0?b(e,t,e.next)>=0&&b(e,e.prev,t)>=0:b(e,t,e.prev)<0||b(e,e.next,t)<0}function O(e,t){var n=e,r=!1,o=(e.x+t.x)/2,i=(e.y+t.y)/2;do n.y>i!=n.next.y>i&&o<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r}function j(e,t){var n=new T(e.i,e.x,e.y),r=new T(t.i,t.x,t.y),o=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=o,o.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function P(e,t,n,r){var o=new T(e,t,n);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}e.exports=n},function(e,t,n){function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=r(o),a=function(e,t,n){function r(){a=e.map(function(e){return[e[0],l.top,e[1]]}),u=t}function o(){a=[],e.forEach(function(e){a.push([e[0],l.top,e[1]])}),e.forEach(function(e){a.push([e[0],l.bottom,e[1]])}),u=[];for(var n=0;c>n;n++)n===c-1?(u.push([n+c,c,n]),u.push([0,n,c])):(u.push([n+c,n+c+1,n]),u.push([n+1,n,n+c+1]));if(l.closed){var r=t,o=r.map(function(e){return e.map(function(e){return e+c})});o=o.map(function(e){return[e[0],e[2],e[1]]}),u=u.concat(r).concat(o)}}var a,u,s={top:1,bottom:0,closed:!0},l=(0,i["default"])(s,n),c=e.length;return l.top===l.bottom?r():o(),{positions:a,faces:u}};t["default"]=a,e.exports=t["default"]}])});
//# sourceMappingURL=vizicities.min.js.map
