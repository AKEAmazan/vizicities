!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("proj4"),require("THREE")):"function"==typeof define&&define.amd?define(["proj4","THREE"],e):"object"==typeof exports?exports.VIZI=e(require("proj4"),require("THREE")):t.VIZI=e(t.proj4,t.THREE)}(this,function(__WEBPACK_EXTERNAL_MODULE_22__,__WEBPACK_EXTERNAL_MODULE_24__){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=r(i),a=n(28),s=r(a),u=n(32),l=r(u),c=n(38),f=r(c),h=n(53),p=r(h),d=n(11),v=r(d),y=n(10),m=r(y),g={version:"0.3",World:o["default"],Controls:s["default"],EnvironmentLayer:l["default"],ImageTileLayer:f["default"],TopoJSONTileLayer:p["default"],Point:v["default"],LatLon:m["default"]};e["default"]=g,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(2),l=r(u),c=n(3),f=r(c),h=n(6),p=r(h),d=n(11),v=r(d),y=n(10),m=r(y),g=n(23),_=r(g),b=function(t){function e(t,n){i(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var r={crs:p["default"].EPSG3857,skybox:!1};this.options=(0,f["default"])(r,n),this._layers=[],this._controls=[],this._initContainer(t),this._initEngine(),this._initEnvironment(),this._initEvents(),this._update()}return o(e,t),a(e,[{key:"_initContainer",value:function(t){this._container=document.getElementById(t)}},{key:"_initEngine",value:function(){this._engine=(0,_["default"])(this._container)}},{key:"_initEnvironment",value:function(){this._environment=VIZI.EnvironmentLayer({skybox:this.options.skybox}).addTo(this)}},{key:"_initEvents",value:function(){this.on("controlsMoveEnd",this._onControlsMoveEnd)}},{key:"_onControlsMoveEnd",value:function(t){var e=(0,v["default"])(t.x,t.z);this._resetView(this.pointToLatLon(e),e)}},{key:"_resetView",value:function(t,e){this.emit("preResetView"),this._moveStart(),this._move(t,e),this._moveEnd(),this.emit("postResetView")}},{key:"_moveStart",value:function(){this.emit("moveStart")}},{key:"_move",value:function(t,e){this._lastPosition=t,this.emit("move",t,e)}},{key:"_moveEnd",value:function(){this.emit("moveEnd")}},{key:"_update",value:function(){var t=this._engine.clock.getDelta();window.requestAnimationFrame(this._update.bind(this)),this._controls.forEach(function(t){t.update()}),this.emit("preUpdate",t),this._engine.update(t),this.emit("postUpdate",t)}},{key:"setView",value:function(t){return this._originLatlon=t,this._originPoint=this.project(t),this._resetView(t),this}},{key:"getPosition",value:function(){return this._lastPosition}},{key:"project",value:function(t){return this.options.crs.latLonToPoint((0,m["default"])(t))}},{key:"unproject",value:function(t){return this.options.crs.pointToLatLon((0,v["default"])(t))}},{key:"latLonToPoint",value:function(t){var e=this.project((0,m["default"])(t));return e._subtract(this._originPoint)}},{key:"pointToLatLon",value:function(t){var e=(0,v["default"])(t).add(this._originPoint);return this.unproject(e)}},{key:"pointScale",value:function(t,e){return this.options.crs.pointScale(t,e)}},{key:"metresToWorld",value:function(t,e,n){return this.options.crs.metresToWorld(t,e,n)}},{key:"worldToMetres",value:function(t,e,n){return this.options.crs.worldToMetres(t,e,n)}},{key:"getCamera",value:function(){return this._engine._camera}},{key:"addLayer",value:function(t){return t._addToWorld(this),this._layers.push(t),this._engine._scene.add(t._layer),this.emit("layerAdded",t),this}},{key:"removeLayer",value:function(t){var e=this._layers.indexOf(t);return e>-1&&this._layers.splice(e,1),this._engine._scene.remove(t._layer),t.destroy(),this.emit("layerRemoved"),this}},{key:"addControls",value:function(t){return t._addToWorld(this),this._controls.push(t),this.emit("controlsAdded",t),this}},{key:"removeControls",value:function(t){}}]),e}(l["default"]);e["default"]=function(t,e){return new b(t,e)},t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(){}var o="function"!=typeof Object.create?"~":!1;i.prototype._events=void 0,i.prototype.listeners=function(t,e){var n=o?o+t:t,r=this._events&&this._events[n];if(e)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,s=new Array(a);a>i;i++)s[i]=r[i].fn;return s},i.prototype.emit=function(t,e,n,r,i,a){var s=o?o+t:t;if(!this._events||!this._events[s])return!1;var u,l,c=this._events[s],f=arguments.length;if("function"==typeof c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,r),!0;case 5:return c.fn.call(c.context,e,n,r,i),!0;case 6:return c.fn.call(c.context,e,n,r,i,a),!0}for(l=1,u=new Array(f-1);f>l;l++)u[l-1]=arguments[l];c.fn.apply(c.context,u)}else{var h,p=c.length;for(l=0;p>l;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,e);break;case 3:c[l].fn.call(c[l].context,e,n);break;default:if(!u)for(h=1,u=new Array(f-1);f>h;h++)u[h-1]=arguments[h];c[l].fn.apply(c[l].context,u)}}return!0},i.prototype.on=function(t,e,n){var i=new r(e,n||this),a=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],i]:this._events[a].push(i):this._events[a]=i,this},i.prototype.once=function(t,e,n){var i=new r(e,n||this,!0),a=o?o+t:t;return this._events||(this._events=o?{}:Object.create(null)),this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],i]:this._events[a].push(i):this._events[a]=i,this},i.prototype.removeListener=function(t,e,n,r){var i=o?o+t:t;if(!this._events||!this._events[i])return this;var a=this._events[i],s=[];if(e)if(a.fn)(a.fn!==e||r&&!a.once||n&&a.context!==n)&&s.push(a);else for(var u=0,l=a.length;l>u;u++)(a[u].fn!==e||r&&!a[u].once||n&&a[u].context!==n)&&s.push(a[u]);return s.length?this._events[i]=1===s.length?s[0]:s:delete this._events[i],this},i.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[o?o+t:t]:this._events=o?{}:Object.create(null),this):this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.prefixed=o,t.exports=i},function(t,e,n){function r(t,e){return t="number"==typeof t||b.test(t)?+t:-1,e=null==e?m:e,t>-1&&t%1==0&&e>t}function i(t,e,n){var r=t[e];(!c(r,n)||c(r,x[e])&&!w.call(t,e)||void 0===n&&!(e in t))&&(t[e]=n)}function o(t){return function(e){return null==e?void 0:e[t]}}function a(t,e,n){return s(t,e,n)}function s(t,e,n,r){n||(n={});for(var o=-1,a=e.length;++o<a;){var s=e[o],u=r?r(n[s],t[s],s,n,t):t[s];i(n,s,u)}return n}function u(t){return y(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o="function"==typeof o?(i--,o):void 0,a&&l(n[0],n[1],a)&&(o=3>i?void 0:o,i=1),e=Object(e);++r<i;){var s=n[r];s&&t(e,s,r,o)}return e})}function l(t,e,n){if(!d(n))return!1;var i=typeof e;return("number"==i?f(n)&&r(e,n.length):"string"==i&&e in n)?c(n[e],t):!1}function c(t,e){return t===e||t!==t&&e!==e}function f(t){return null!=t&&!("function"==typeof t&&h(t))&&p(M(t))}function h(t){var e=d(t)?E.call(t):"";return e==g||e==_}function p(t){return"number"==typeof t&&t>-1&&t%1==0&&m>=t}function d(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var v=n(4),y=n(5),m=9007199254740991,g="[object Function]",_="[object GeneratorFunction]",b=/^(?:0|[1-9]\d*)$/,x=Object.prototype,w=x.hasOwnProperty,E=x.toString,M=o("length"),O=u(function(t,e){a(e,v(e),t)});t.exports=O},function(t,e){function n(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function r(t,e){return t="number"==typeof t||E.test(t)?+t:-1,e=null==e?g:e,t>-1&&t%1==0&&e>t}function i(t,e){return O.call(t,e)||"object"==typeof t&&e in t&&null===P(t)}function o(t){return k(Object(t))}function a(t){return function(e){return null==e?void 0:e[t]}}function s(t){var e=t?t.length:void 0;return p(e)&&(A(t)||y(t)||l(t))?n(e,String):null}function u(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||M;return t===n}function l(t){return f(t)&&O.call(t,"callee")&&(!j.call(t,"callee")||T.call(t)==_)}function c(t){return null!=t&&!("function"==typeof t&&h(t))&&p(S(t))}function f(t){return v(t)&&c(t)}function h(t){var e=d(t)?T.call(t):"";return e==b||e==x}function p(t){return"number"==typeof t&&t>-1&&t%1==0&&g>=t}function d(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function v(t){return!!t&&"object"==typeof t}function y(t){return"string"==typeof t||!A(t)&&v(t)&&T.call(t)==w}function m(t){var e=u(t);if(!e&&!c(t))return o(t);var n=s(t),a=!!n,l=n||[],f=l.length;for(var h in t)!i(t,h)||a&&("length"==h||r(h,f))||e&&"constructor"==h||l.push(h);return l}var g=9007199254740991,_="[object Arguments]",b="[object Function]",x="[object GeneratorFunction]",w="[object String]",E=/^(?:0|[1-9]\d*)$/,M=Object.prototype,O=M.hasOwnProperty,T=M.toString,P=Object.getPrototypeOf,j=M.propertyIsEnumerable,k=Object.keys,S=a("length"),A=Array.isArray;t.exports=m},function(t,e){function n(t,e,n){var r=n.length;switch(r){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function r(t,e){if("function"!=typeof t)throw new TypeError(u);return e=x(void 0===e?t.length-1:a(e),0),function(){for(var r=arguments,i=-1,o=x(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];switch(e){case 0:return t.call(this,a);case 1:return t.call(this,r[0],a);case 2:return t.call(this,r[0],r[1],a)}var s=Array(e+1);for(i=-1;++i<e;)s[i]=r[i];return s[e]=a,n(t,this,s)}}function i(t){var e=o(t)?b.call(t):"";return e==h||e==p}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){if(!t)return 0===t?t:0;if(t=s(t),t===l||t===-l){var e=0>t?-1:1;return e*c}var n=t%1;return t===t?n?t-n:t:0}function s(t){if(o(t)){var e=i(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(d,"");var n=y.test(t);return n||m.test(t)?g(t.slice(2),n?2:8):v.test(t)?f:+t}var u="Expected a function",l=1/0,c=1.7976931348623157e308,f=NaN,h="[object Function]",p="[object GeneratorFunction]",d=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,m=/^0o[0-7]+$/i,g=parseInt,_=Object.prototype,b=_.toString,x=Math.max;t.exports=r},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(7),o=r(i),a=n(15),s=r(a),u=n(17),l=r(u),c=n(19),f=r(c),h=n(20),p=r(h),d={};d.EPSG3857=o["default"],d.EPSG900913=i.EPSG900913,d.EPSG3395=s["default"],d.EPSG4326=l["default"],d.Simple=f["default"],d.Proj4=p["default"],e["default"]=d,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(8),s=r(a),u=n(13),l=r(u),c=n(14),f=r(c),h={code:"EPSG:3857",projection:l["default"],transformScale:1/(Math.PI*l["default"].R),transformation:function(){var t=1/(Math.PI*l["default"].R);return new f["default"](t,0,-t,0)}()},p=(0,o["default"])({},s["default"],h),d=(0,o["default"])({},p,{code:"EPSG:900913"});e.EPSG900913=d,e["default"]=p},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(9),s=r(a),u=n(10),l=(r(u),{wrapLon:[-180,180],R:6378137,distance:function(t,e,n){var r,i,o,a=Math.PI/180;if(n){r=t.lat*a,i=e.lat*a;var s=t.lon*a,u=e.lon*a,l=i-r,c=u-s,f=l/2,h=c/2;o=Math.sin(f)*Math.sin(f)+Math.cos(r)*Math.cos(i)*Math.sin(h)*Math.sin(h);var p=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return this.R*p}return r=t.lat*a,i=e.lat*a,o=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((e.lon-t.lon)*a),this.R*Math.acos(Math.min(o,1))},pointScale:function(t,e){return this.projection.pointScale?this.projection.pointScale(t,e):[1,1]},metresToProjected:function(t,e){return t*e[1]},projectedToMetres:function(t,e){return t/e[1]},metresToWorld:function(t,e,n){var r=this.metresToProjected(t,e),i=this.scale(n);n&&(i/=2);var o=i*(this.transformScale*r);return n&&(o/=e[1]),o},worldToMetres:function(t,e,n){var r=this.scale(n);n&&(r/=2);var i=t/r/this.transformScale,o=this.projectedToMetres(i,e);return n&&(o*=e[1]),o}});e["default"]=(0,o["default"])({},s["default"],l),t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(11),s=r(a),u=n(12),l=r(u),c={scaleFactor:1e6,latLonToPoint:function(t,e){var n=this.projection.project(t),r=this.scale(e);return e&&(r/=2),this.transformation._transform(n,r)},pointToLatLon:function(t,e){var n=this.scale(e);e&&(n/=2);var r=this.transformation.untransform(t,n);return this.projection.unproject(r)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return t>=0?256*Math.pow(2,t):this.scaleFactor},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);t&&(n/=2);var r=this.transformation.transform((0,s["default"])(e[0]),n),i=this.transformation.transform((0,s["default"])(e[1]),n);return[r,i]},wrapLatLon:function(t){var e=this.wrapLat?(0,l["default"])(t.lat,this.wrapLat,!0):t.lat,n=this.wrapLon?(0,l["default"])(t.lon,this.wrapLon,!0):t.lon,r=t.alt;return(0,o["default"])(e,n,r)}};e["default"]=c,t.exports=e["default"]},function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r,i){if(n(this,t),isNaN(e)||isNaN(r))throw new Error("Invalid LatLon object: ("+e+", "+r+")");this.lat=+e,this.lon=+r,void 0!==i&&(this.alt=+i)}return r(t,[{key:"clone",value:function(){return new t(this.lat,this.lon,this.alt)}}]),t}();e["default"]=function(t,e,n){return t instanceof i?t:Array.isArray(t)&&"object"!=typeof t[0]?3===t.length?new i(t[0],t[1],t[2]):2===t.length?new i(t[0],t[1]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new i(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new i(t,e,n)},t.exports=e["default"]},function(t,e){function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r,i){n(this,t),this.x=i?Math.round(e):e,this.y=i?Math.round(r):r}return r(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"add",value:function(t){return this.clone()._add(o(t))}},{key:"_add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"subtract",value:function(t){return this.clone()._subtract(o(t))}},{key:"_subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this}}]),t}(),o=function(t,e,n){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):void 0===t||null===t?t:new i(t,e,n)};e["default"]=o,t.exports=e["default"]},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,n){var r=e[1],i=e[0],o=r-i;return t===r&&n?t:((t-i)%o+o)%o+i};e["default"]=n,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(11),s=r(a),u={R:6378137,MAX_LATITUDE:85.0511287798,ECC:.081819191,ECC2:.006694380015894481,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,r=Math.max(Math.min(n,t.lat),-n),i=Math.sin(r*e);return(0,s["default"])(this.R*t.lon*e,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(t){var e=180/Math.PI;return(0,o["default"])((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},pointScale:function(t,e){var n,r=Math.PI/180;if(e){var i=t.lat*r,o=(t.lon*r,this.R),a=Math.sin(i),s=a*a,u=Math.cos(i),l=o*(1-this.ECC2)/Math.pow(1-this.ECC2*s,1.5),c=o/Math.sqrt(1-this.ECC2*s),f=o/l/u;return n=o/c/u,[n,f]}return n=1/Math.cos(t.lat*r),[n,n]},bounds:function(){var t=6378137*Math.PI;return[[-t,-t],[t,t]]}()};e["default"]=u,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(11),s=r(a),u=function(){function t(e,n,r,o){i(this,t),this._a=e,this._b=n,this._c=r,this._d=o}return o(t,[{key:"transform",value:function(t,e){return this._transform(t.clone(),e)}},{key:"_transform",value:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t}},{key:"untransform",value:function(t,e){return e=e||1,(0,s["default"])((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}}]),t}();e["default"]=u,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(8),s=r(a),u=n(16),l=r(u),c=n(14),f=r(c),h={code:"EPSG:3395",projection:l["default"],transformScale:1/(Math.PI*l["default"].R),transformation:function(){var t=1/(Math.PI*l["default"].R);return new f["default"](t,0,-t,0)}()},p=(0,o["default"])({},s["default"],h);e["default"]=p,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(11),s=r(a),u={R:6378137,R_MINOR:6356752.314245179,ECC:.081819191,ECC2:.006694380015894481,project:function(t){var e=Math.PI/180,n=this.R,r=t.lat*e,i=this.R_MINOR/n,o=Math.sqrt(1-i*i),a=o*Math.sin(r),u=Math.tan(Math.PI/4-r/2)/Math.pow((1-a)/(1+a),o/2);return r=-n*Math.log(Math.max(u,1e-10)),(0,s["default"])(t.lon*e*n,r)},unproject:function(t){for(var e,n=180/Math.PI,r=this.R,i=this.R_MINOR/r,a=Math.sqrt(1-i*i),s=Math.exp(-t.y/r),u=Math.PI/2-2*Math.atan(s),l=0,c=.1;15>l&&Math.abs(c)>1e-7;l++)e=a*Math.sin(u),e=Math.pow((1-e)/(1+e),a/2),c=Math.PI/2-2*Math.atan(s*e)-u,u+=c;return(0,o["default"])(u*n,t.x*n/r)},pointScale:function(t){var e=Math.PI/180,n=t.lat*e,r=Math.sin(n),i=r*r,o=Math.cos(n),a=Math.sqrt(1-this.ECC2*i)/o;return[a,a]},bounds:[[-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]]};e["default"]=u,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(8),s=r(a),u=n(18),l=r(u),c=n(14),f=r(c),h={code:"EPSG:4326",projection:l["default"],transformScale:1/180,transformation:new f["default"](1/180,0,-1/180,0)},p=(0,o["default"])({},s["default"],h);e["default"]=p,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(10),o=r(i),a=n(11),s=r(a),u={project:function(t){return(0,s["default"])(t.lon,t.lat)},unproject:function(t){return(0,o["default"])(t.y,t.x)},pointScale:function(t){var e=111132.92,n=-559.82,r=1.175,i=-.0023,o=111412.84,a=-93.5,s=.118,u=Math.PI/180,l=t.lat*u,c=e+n*Math.cos(2*l)+r*Math.cos(4*l)+i*Math.cos(6*l),f=o*Math.cos(l)+a*Math.cos(3*l)+s*Math.cos(5*l);return[1/c,1/f]},bounds:[[-180,-90],[180,90]]};e["default"]=u,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(9),s=r(a),u=n(18),l=r(u),c=n(14),f=r(c),h={projection:l["default"],transformation:new f["default"](1,0,1,0),scale:function(t){return t?Math.pow(2,t):1},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lon-t.lon,r=e.lat-t.lat;return Math.sqrt(n*n+r*r)},infinite:!0},p=(0,o["default"])({},s["default"],h);e["default"]=p,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=n(8),s=r(a),u=n(21),l=r(u),c=n(14),f=r(c),h=function(t,e,n){var r=(0,l["default"])(e,n),i=r.bounds[1][0]-r.bounds[0][0],o=r.bounds[1][1]-r.bounds[0][1],a=i/2,s=o/2,u=1/a,c=1/s,h=Math.min(u,c),p=h*(r.bounds[0][0]+a),d=h*(r.bounds[0][1]+s);return{code:t,projection:r,transformScale:h,transformation:new f["default"](h,-p,-h,d)}},p=function(t,e,n){return(0,o["default"])({},s["default"],h(t,e,n))};e["default"]=p,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(22),o=r(i),a=n(10),s=r(a),u=n(11),l=r(u),c=function(t,e){var n=(0,o["default"])(t),r=function(t){return(0,l["default"])(n.forward([t.lon,t.lat]))},i=function(t){var e=n.inverse([t.x,t.y]);return(0,s["default"])(e[1],e[0])};return{project:r,unproject:i,pointScale:function(t,e){return[1,1]},bounds:function(){if(e)return e;var t=r([-90,-180]),n=r([90,180]);return[t,n]}()}};e["default"]=c,t.exports=e["default"]},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_22__},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(2),l=r(u),c=n(24),f=r(c),h=n(25),p=r(h),d=n(26),v=r(d),y=n(27),m=r(y),g=function(t){function e(t){i(this,e),console.log("Init Engine"),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._scene=p["default"],this._renderer=(0,v["default"])(t),this._camera=(0,m["default"])(t),this.clock=new f["default"].Clock,this._frustum=new f["default"].Frustum}return o(e,t),a(e,[{key:"update",value:function(t){this.emit("preRender"),this._renderer.render(this._scene,this._camera),this.emit("postRender")}}]),e}(l["default"]);e["default"]=function(t){return new g(t)},t.exports=e["default"]},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_24__},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i);e["default"]=function(){var t=new o["default"].Scene;return t}(),t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i),a=n(25);r(a);e["default"]=function(t){var e=new o["default"].WebGLRenderer({antialias:!0});e.setClearColor(16777215,1),e.gammaInput=!0,e.gammaOutput=!0,e.shadowMap.enabled=!0,e.shadowMap.cullFace=o["default"].CullFaceBack,t.appendChild(e.domElement);var n=function(){e.setSize(t.clientWidth,t.clientHeight)};return window.addEventListener("resize",n,!1),n(),e},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i);e["default"]=function(t){var e=new o["default"].PerspectiveCamera(45,1,1,2e5);e.position.y=400,e.position.z=400;var n=function(){e.aspect=t.clientWidth/t.clientHeight,e.updateProjectionMatrix()};return window.addEventListener("resize",n,!1),n(),e},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(29),o=r(i),a={Orbit:o["default"]};e["default"]=a,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(2),l=r(u),c=n(24),f=(r(c),n(30)),h=r(f),p=function(t){function e(){i(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this)}return o(e,t),a(e,[{key:"_initEvents",value:function(){var t=this;this._controls.addEventListener("start",function(e){t._world.emit("controlsMoveStart",e.target.target)}),this._controls.addEventListener("change",function(e){t._world.emit("controlsMove",e.target.target)}),this._controls.addEventListener("end",function(e){t._world.emit("controlsMoveEnd",e.target.target)})}},{key:"_panTo",value:function(t,e){}},{key:"_panBy",value:function(t,e){}},{key:"_zoomTo",value:function(t,e){}},{key:"_zoomBy",value:function(t,e){}},{key:"_lookAt",value:function(t,e){}},{key:"_lookAtTarget",value:function(){}},{key:"_tiltTo",value:function(t,e){}},{key:"_tiltBy",value:function(t,e){}},{key:"_rotateTo",value:function(t,e){}},{key:"_rotateBy",value:function(t,e){}},{key:"_flyTo",value:function(t,e){}},{key:"update",value:function(){this._controls.update()}},{key:"addTo",value:function(t){return t.addControls(this),this}},{key:"_addToWorld",value:function(t){this._world=t,this._controls=new h["default"](t._engine._camera,t._container),this._controls.keys=!1,this._controls.maxPolarAngle=1.5533,this._initEvents(),this.emit("added")}}]),e}(l["default"]);e["default"]=function(){return new p},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i),a=n(31),s=r(a),u=function(t,e){function n(){return 2*Math.PI/60/60*z.autoRotateSpeed}function r(){return Math.pow(.95,z.zoomSpeed)}function i(t){V-=t}function a(t){B-=t}function u(t){z.object instanceof o["default"].PerspectiveCamera?Z/=t:z.object instanceof o["default"].OrthographicCamera?(z.object.zoom=Math.max(z.minZoom,Math.min(z.maxZoom,z.object.zoom*t)),z.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),z.enableZoom=!1)}function l(t){z.object instanceof o["default"].PerspectiveCamera?Z*=t:z.object instanceof o["default"].OrthographicCamera?(z.object.zoom=Math.max(z.minZoom,Math.min(z.maxZoom,z.object.zoom/t)),z.object.updateProjectionMatrix(),G=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),z.enableZoom=!1)}function c(t){Y.set(t.clientX,t.clientY)}function f(t){et.set(t.clientX,t.clientY)}function h(t){J.set(t.clientX,t.clientY)}function p(t){K.set(t.clientX,t.clientY),$.subVectors(K,Y);var e=z.domElement===document?z.domElement.body:z.domElement;i(2*Math.PI*$.x/e.clientWidth*z.rotateSpeed),a(2*Math.PI*$.y/e.clientHeight*z.rotateSpeed),Y.copy(K),z.update()}function d(t){nt.set(t.clientX,t.clientY),rt.subVectors(nt,et),rt.y>0?u(r()):rt.y<0&&l(r()),et.copy(nt),z.update()}function v(t){Q.set(t.clientX,t.clientY),tt.subVectors(Q,J),at(tt.x,tt.y),J.copy(Q),z.update()}function y(t){}function m(t){var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?l(r()):0>e&&u(r()),z.update()}function g(t){switch(t.keyCode){case z.keys.UP:at(0,z.keyPanSpeed),z.update();break;case z.keys.BOTTOM:at(0,-z.keyPanSpeed),z.update();break;case z.keys.LEFT:at(z.keyPanSpeed,0),z.update();break;case z.keys.RIGHT:at(-z.keyPanSpeed,0),z.update()}}function _(t){Y.set(t.pointers[0].pageX,t.pointers[0].pageY)}function b(t){var e=t.pointers[0].pageX-t.pointers[1].pageX,n=t.pointers[0].pageY-t.pointers[1].pageY,r=Math.sqrt(e*e+n*n);et.set(0,r)}function x(t){J.set(t.deltaX,t.deltaY)}function w(t){K.set(t.pointers[0].pageX,t.pointers[0].pageY),$.subVectors(K,Y);var e=z.domElement===document?z.domElement.body:z.domElement;i(2*Math.PI*$.x/e.clientWidth*z.rotateSpeed),a(2*Math.PI*$.y/e.clientHeight*z.rotateSpeed),Y.copy(K),z.update()}function E(t){var e=t.pointers[0].pageX-t.pointers[1].pageX,n=t.pointers[0].pageY-t.pointers[1].pageY,i=Math.sqrt(e*e+n*n);nt.set(0,i),rt.subVectors(nt,et),rt.y>0?l(r()):rt.y<0&&u(r()),et.copy(nt),z.update()}function M(t){Q.set(t.deltaX,t.deltaY),tt.subVectors(Q,J),at(tt.x,tt.y),J.copy(Q),z.update()}function O(t){}function T(t){if(z.enabled!==!1){if(t.preventDefault(),t.button===z.mouseButtons.ORBIT){if(z.enableRotate===!1)return;c(t),U=H.ROTATE}else if(t.button===z.mouseButtons.ZOOM){if(z.enableZoom===!1)return;f(t),U=H.DOLLY}else if(t.button===z.mouseButtons.PAN){if(z.enablePan===!1)return;h(t),U=H.PAN}U!==H.NONE&&(document.addEventListener("mousemove",P,!1),document.addEventListener("mouseup",j,!1),document.addEventListener("mouseout",j,!1),z.dispatchEvent(N))}}function P(t){if(z.enabled!==!1)if(t.preventDefault(),U===H.ROTATE){if(z.enableRotate===!1)return;p(t)}else if(U===H.DOLLY){if(z.enableZoom===!1)return;d(t)}else if(U===H.PAN){if(z.enablePan===!1)return;v(t)}}function j(t){z.enabled!==!1&&(y(t),document.removeEventListener("mousemove",P,!1),document.removeEventListener("mouseup",j,!1),document.removeEventListener("mouseout",j,!1),z.dispatchEvent(F),
U=H.NONE)}function k(t){z.enabled!==!1&&z.enableZoom!==!1&&U===H.NONE&&(t.preventDefault(),t.stopPropagation(),m(t),z.dispatchEvent(N),z.dispatchEvent(F))}function S(t){z.enabled!==!1&&z.enableKeys!==!1&&z.enablePan!==!1&&g(t)}function A(t){if(z.enabled!==!1){switch(t.touches.length){case 1:if(z.enableRotate===!1)return;_(t),U=H.TOUCH_ROTATE;break;case 2:if(z.enableZoom===!1)return;b(t),U=H.TOUCH_DOLLY;break;case 3:if(z.enablePan===!1)return;x(t),U=H.TOUCH_PAN;break;default:U=H.NONE}U!==H.NONE&&z.dispatchEvent(N)}}function L(t){if(z.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(z.enableRotate===!1)return;if(U!==H.TOUCH_ROTATE)return;w(t);break;case 2:if(z.enableZoom===!1)return;if(U!==H.TOUCH_DOLLY)return;E(t);break;case 3:if(z.enablePan===!1)return;if(U!==H.TOUCH_PAN)return;M(t);break;default:U=H.NONE}}function C(t){z.enabled!==!1&&(O(t),z.dispatchEvent(F),U=H.NONE)}function R(t){t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new o["default"].Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:o["default"].MOUSE.LEFT,ZOOM:o["default"].MOUSE.MIDDLE,PAN:o["default"].MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return I},this.getAzimuthalAngle=function(){return D},this.reset=function(){z.target.copy(z.target0),z.object.position.copy(z.position0),z.object.zoom=z.zoom0,z.object.updateProjectionMatrix(),z.dispatchEvent(q),z.update(),U=H.NONE},this.update=function(){var e=new o["default"].Vector3,r=(new o["default"].Quaternion).setFromUnitVectors(t.up,new o["default"].Vector3(0,1,0)),a=r.clone().inverse(),s=new o["default"].Vector3,u=new o["default"].Quaternion;return function(){var t=z.object.position;e.copy(t).sub(z.target),e.applyQuaternion(r),D=Math.atan2(e.x,e.z),I=Math.atan2(Math.sqrt(e.x*e.x+e.z*e.z),e.y),z.autoRotate&&U===H.NONE&&i(n()),D+=V,I+=B,D=Math.max(z.minAzimuthAngle,Math.min(z.maxAzimuthAngle,D)),I=Math.max(z.minPolarAngle,Math.min(z.maxPolarAngle,I)),I=Math.max(W,Math.min(Math.PI-W,I));var o=e.length()*Z;return o=Math.max(z.minDistance,Math.min(z.maxDistance,o)),z.target.add(X),e.x=o*Math.sin(I)*Math.sin(D),e.y=o*Math.cos(I),e.z=o*Math.sin(I)*Math.cos(D),e.applyQuaternion(a),t.copy(z.target).add(e),z.object.lookAt(z.target),z.enableDamping===!0?(V*=1-z.dampingFactor,B*=1-z.dampingFactor):(V=0,B=0),Z=1,X.set(0,0,0),G||s.distanceToSquared(z.object.position)>W||8*(1-u.dot(z.object.quaternion))>W?(z.dispatchEvent(q),s.copy(z.object.position),u.copy(z.object.quaternion),G=!1,!0):!1}}(),this.dispose=function(){z.domElement.removeEventListener("contextmenu",R,!1),z.domElement.removeEventListener("mousedown",T,!1),z.domElement.removeEventListener("mousewheel",k,!1),z.domElement.removeEventListener("MozMousePixelScroll",k,!1),z.domElement.removeEventListener("touchstart",A,!1),z.domElement.removeEventListener("touchend",C,!1),z.domElement.removeEventListener("touchmove",L,!1),document.removeEventListener("mousemove",P,!1),document.removeEventListener("mouseup",j,!1),document.removeEventListener("mouseout",j,!1),window.removeEventListener("keydown",S,!1)};var D,I,z=this,q={type:"change"},N={type:"start"},F={type:"end"},H={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},U=H.NONE,W=1e-6,B=0,V=0,Z=1,X=new o["default"].Vector3,G=!1,Y=new o["default"].Vector2,K=new o["default"].Vector2,$=new o["default"].Vector2,J=new o["default"].Vector2,Q=new o["default"].Vector2,tt=new o["default"].Vector2,et=new o["default"].Vector2,nt=new o["default"].Vector2,rt=new o["default"].Vector2,it=function(){var t=new o["default"].Vector3;return function(e,n){var r=n.elements;t.set(r[0],0,r[2]),t.multiplyScalar(-e),X.add(t)}}(),ot=function(){var t=new o["default"].Vector3;return function(e,n){var r=n.elements,i=e/Math.cos(I);t.set(r[4],0,r[6]),t.multiplyScalar(i),X.add(t)}}(),at=function(){var t=new o["default"].Vector3;return function(e,n){var r=z.domElement===document?z.domElement.body:z.domElement;if(z.object instanceof o["default"].PerspectiveCamera){var i=z.object.position;t.copy(i).sub(z.target);var a=t.length();a*=Math.tan(z.object.fov/2*Math.PI/180),it(2*e*a/r.clientHeight,z.object.matrix),ot(2*n*a/r.clientHeight,z.object.matrix)}else z.object instanceof o["default"].OrthographicCamera?(it(e*(z.object.right-z.object.left)/r.clientWidth,z.object.matrix),ot(n*(z.object.top-z.object.bottom)/r.clientHeight,z.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),z.enablePan=!1)}}();z.domElement.addEventListener("contextmenu",R,!1),z.domElement.addEventListener("mousedown",T,!1),z.domElement.addEventListener("mousewheel",k,!1),z.domElement.addEventListener("MozMousePixelScroll",k,!1),z.hammer=new s["default"](z.domElement),z.hammer.get("pan").set({pointers:0,direction:s["default"].DIRECTION_ALL}),z.hammer.get("pinch").set({enable:!0,threshold:.1}),z.hammer.on("panstart",function(t){if(z.enabled!==!1){if(1===t.pointers.length){if(z.enablePan===!1)return;x(t),U=H.TOUCH_PAN}else if(2===t.pointers.length){if(z.enableRotate===!1)return;_(t),U=H.TOUCH_ROTATE}U!==H.NONE&&z.dispatchEvent(N)}}),z.hammer.on("panend",C),z.hammer.on("panmove",function(t){if(z.enabled!==!1)if(1===t.pointers.length){if(z.enablePan===!1)return;if(U!==H.TOUCH_PAN)return;M(t)}else if(2===t.pointers.length){if(z.enableRotate===!1)return;if(U!==H.TOUCH_ROTATE)return;w(t)}}),z.hammer.on("pinchstart",function(t){z.enabled!==!1&&z.enableZoom!==!1&&(b(t),U=H.TOUCH_DOLLY,U!==H.NONE&&z.dispatchEvent(N))}),z.hammer.on("pinchend",C),z.hammer.on("pinchmove",function(t){z.enabled!==!1&&z.enableZoom!==!1&&U===H.TOUCH_DOLLY&&E(t)}),window.addEventListener("keydown",S,!1),this.update()};u.prototype=Object.create(o["default"].EventDispatcher.prototype),u.prototype.constructor=o["default"].OrbitControls,Object.defineProperties(u.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.constraint.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.constraint.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.constraint.dampingFactor=t}}}),e["default"]=u,t.exports=e["default"]},function(t,e,n){var r;!function(i,o,a,s){"use strict";function u(t,e,n){return setTimeout(p(t,n),e)}function l(t,e,n){return Array.isArray(t)?(c(t,n[e],n),!0):!1}function c(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function f(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}function h(t,e,n){var r,i=e.prototype;r=t.prototype=Object.create(i),r.constructor=t,r._super=i,n&&ft(r,n)}function p(t,e){return function(){return t.apply(e,arguments)}}function d(t,e){return typeof t==dt?t.apply(e?e[0]||s:s,e):t}function v(t,e){return t===s?e:t}function y(t,e,n){c(b(e),function(e){t.addEventListener(e,n,!1)})}function m(t,e,n){c(b(e),function(e){t.removeEventListener(e,n,!1)})}function g(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function _(t,e){return t.indexOf(e)>-1}function b(t){return t.trim().split(/\s+/g)}function x(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function w(t){return Array.prototype.slice.call(t,0)}function E(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];x(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function M(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<ht.length;){if(n=ht[o],r=n?n+i:e,r in t)return r;o++}return s}function O(){return bt++}function T(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}function P(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){d(t.options.enable,[t])&&n.handler(e)},this.init()}function j(t){var e,n=t.options.inputClass;return new(e=n?n:Et?U:Mt?V:wt?X:H)(t,k)}function k(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&St&&r-i===0,a=e&(Lt|Ct)&&r-i===0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,S(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function S(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=C(e)),i>1&&!n.firstMultiple?n.firstMultiple=C(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=R(r);e.timeStamp=mt(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=q(s,u),e.distance=z(s,u),A(n,e),e.offsetDirection=I(e.deltaX,e.deltaY);var l=D(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=yt(l.x)>yt(l.y)?l.x:l.y,e.scale=a?F(a.pointers,r):1,e.rotation=a?N(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,L(n,e);var c=t.element;g(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function A(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};(e.eventType===St||o.eventType===Lt)&&(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}function L(t,e){var n,r,i,o,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=Ct&&(u>kt||a.velocity===s)){var l=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,f=D(u,l,c);r=f.x,i=f.y,n=yt(f.x)>yt(f.y)?f.x:f.y,o=I(l,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}function C(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:vt(t.pointers[n].clientX),clientY:vt(t.pointers[n].clientY)},n++;return{timeStamp:mt(),pointers:e,center:R(e),deltaX:t.deltaX,deltaY:t.deltaY}}function R(t){var e=t.length;if(1===e)return{x:vt(t[0].clientX),y:vt(t[0].clientY)};for(var n=0,r=0,i=0;e>i;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:vt(n/e),y:vt(r/e)}}function D(t,e,n){return{x:e/t||0,y:n/t||0}}function I(t,e){return t===e?Rt:yt(t)>=yt(e)?0>t?Dt:It:0>e?zt:qt}function z(t,e,n){n||(n=Ut);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function q(t,e,n){n||(n=Ut);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function N(t,e){return q(e[1],e[0],Wt)+q(t[1],t[0],Wt)}function F(t,e){return z(e[0],e[1],Wt)/z(t[0],t[1],Wt)}function H(){this.evEl=Vt,this.evWin=Zt,this.allow=!0,this.pressed=!1,P.apply(this,arguments)}function U(){this.evEl=Yt,this.evWin=Kt,P.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=Jt,this.evWin=Qt,this.started=!1,P.apply(this,arguments)}function B(t,e){var n=w(t.touches),r=w(t.changedTouches);return e&(Lt|Ct)&&(n=E(n.concat(r),"identifier",!0)),[n,r]}function V(){this.evTarget=ee,this.targetIds={},P.apply(this,arguments)}function Z(t,e){var n=w(t.touches),r=this.targetIds;if(e&(St|At)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=w(t.changedTouches),s=[],u=this.target;if(o=n.filter(function(t){return g(t.target,u)}),e===St)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),e&(Lt|Ct)&&delete r[a[i].identifier],i++;return s.length?[E(o.concat(s),"identifier",!0),s]:void 0}function X(){P.apply(this,arguments);var t=p(this.handler,this);this.touch=new V(this.manager,t),this.mouse=new H(this.manager,t)}function G(t,e){this.manager=t,this.set(e)}function Y(t){if(_(t,se))return se;var e=_(t,ue),n=_(t,le);return e&&n?se:e||n?e?ue:le:_(t,ae)?ae:oe}function K(t){this.options=ft({},this.defaults,t||{}),this.id=O(),this.manager=null,this.options.enable=v(this.options.enable,!0),this.state=ce,this.simultaneous={},this.requireFail=[]}function $(t){return t&ve?"cancel":t&pe?"end":t&he?"move":t&fe?"start":""}function J(t){return t==qt?"down":t==zt?"up":t==Dt?"left":t==It?"right":""}function Q(t,e){var n=e.manager;return n?n.get(t):t}function tt(){K.apply(this,arguments)}function et(){tt.apply(this,arguments),this.pX=null,this.pY=null}function nt(){tt.apply(this,arguments)}function rt(){K.apply(this,arguments),this._timer=null,this._input=null}function it(){tt.apply(this,arguments)}function ot(){tt.apply(this,arguments)}function at(){K.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function st(t,e){return e=e||{},e.recognizers=v(e.recognizers,st.defaults.preset),new ut(t,e)}function ut(t,e){this.options=ft({},st.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=j(this),this.touchAction=new G(this,this.options.touchAction),lt(this,!0),c(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function lt(t,e){var n=t.element;n.style&&c(t.options.cssProps,function(t,r){n.style[M(n.style,r)]=e?t:""})}function ct(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}var ft,ht=["","webkit","Moz","MS","ms","o"],pt=o.createElement("div"),dt="function",vt=Math.round,yt=Math.abs,mt=Date.now;ft="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var gt=f(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===s)&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),_t=f(function(t,e){return gt(t,e,!0)},"merge","Use `assign`."),bt=1,xt=/mobile|tablet|ip(ad|hone|od)|android/i,wt="ontouchstart"in i,Et=M(i,"PointerEvent")!==s,Mt=wt&&xt.test(navigator.userAgent),Ot="touch",Tt="pen",Pt="mouse",jt="kinect",kt=25,St=1,At=2,Lt=4,Ct=8,Rt=1,Dt=2,It=4,zt=8,qt=16,Nt=Dt|It,Ft=zt|qt,Ht=Nt|Ft,Ut=["x","y"],Wt=["clientX","clientY"];P.prototype={handler:function(){},init:function(){this.evEl&&y(this.element,this.evEl,this.domHandler),this.evTarget&&y(this.target,this.evTarget,this.domHandler),this.evWin&&y(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&m(this.element,this.evEl,this.domHandler),this.evTarget&&m(this.target,this.evTarget,this.domHandler),this.evWin&&m(T(this.element),this.evWin,this.domHandler)}};var Bt={mousedown:St,mousemove:At,mouseup:Lt},Vt="mousedown",Zt="mousemove mouseup";h(H,P,{handler:function(t){var e=Bt[t.type];e&St&&0===t.button&&(this.pressed=!0),e&At&&1!==t.which&&(e=Lt),this.pressed&&this.allow&&(e&Lt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Pt,srcEvent:t}))}});var Xt={pointerdown:St,pointermove:At,pointerup:Lt,pointercancel:Ct,pointerout:Ct},Gt={2:Ot,3:Tt,4:Pt,5:jt},Yt="pointerdown",Kt="pointermove pointerup pointercancel";i.MSPointerEvent&&!i.PointerEvent&&(Yt="MSPointerDown",Kt="MSPointerMove MSPointerUp MSPointerCancel"),h(U,P,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Xt[r],o=Gt[t.pointerType]||t.pointerType,a=o==Ot,s=x(e,t.pointerId,"pointerId");i&St&&(0===t.button||a)?0>s&&(e.push(t),s=e.length-1):i&(Lt|Ct)&&(n=!0),0>s||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var $t={touchstart:St,touchmove:At,touchend:Lt,touchcancel:Ct},Jt="touchstart",Qt="touchstart touchmove touchend touchcancel";h(W,P,{handler:function(t){var e=$t[t.type];if(e===St&&(this.started=!0),this.started){var n=B.call(this,t,e);e&(Lt|Ct)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ot,srcEvent:t})}}});var te={touchstart:St,touchmove:At,touchend:Lt,touchcancel:Ct},ee="touchstart touchmove touchend touchcancel";h(V,P,{handler:function(t){var e=te[t.type],n=Z.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ot,srcEvent:t})}}),h(X,P,{handler:function(t,e,n){var r=n.pointerType==Ot,i=n.pointerType==Pt;if(r)this.mouse.allow=!1;else if(i&&!this.mouse.allow)return;e&(Lt|Ct)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ne=M(pt.style,"touchAction"),re=ne!==s,ie="compute",oe="auto",ae="manipulation",se="none",ue="pan-x",le="pan-y";G.prototype={set:function(t){t==ie&&(t=this.compute()),re&&this.manager.element.style&&(this.manager.element.style[ne]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return c(this.manager.recognizers,function(e){d(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),Y(t.join(" "))},preventDefaults:function(t){if(!re){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var r=this.actions,i=_(r,se),o=_(r,le),a=_(r,ue);if(i){var s=1===t.pointers.length,u=t.distance<2,l=t.deltaTime<250;if(s&&u&&l)return}if(!a||!o)return i||o&&n&Nt||a&&n&Ft?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ce=1,fe=2,he=4,pe=8,de=pe,ve=16,ye=32;K.prototype={defaults:{},set:function(t){return ft(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(l(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=Q(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return l(t,"dropRecognizeWith",this)?this:(t=Q(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(l(t,"requireFailure",this))return this;var e=this.requireFail;return t=Q(t,this),-1===x(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(l(t,"dropRequireFailure",this))return this;t=Q(t,this);var e=x(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,r=this.state;pe>r&&e(n.options.event+$(r)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),r>=pe&&e(n.options.event+$(r))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=ye)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(ye|ce)))return!1;t++}return!0},recognize:function(t){var e=ft({},t);return d(this.options.enable,[this,e])?(this.state&(de|ve|ye)&&(this.state=ce),this.state=this.process(e),void(this.state&(fe|he|pe|ve)&&this.tryEmit(e))):(this.reset(),void(this.state=ye))},process:function(t){},getTouchAction:function(){},reset:function(){}},h(tt,K,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(fe|he),i=this.attrTest(t);return r&&(n&Ct||!i)?e|ve:r||i?n&Lt?e|pe:e&fe?e|he:fe:ye}}),h(et,tt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ht},getTouchAction:function(){var t=this.options.direction,e=[];return t&Nt&&e.push(le),t&Ft&&e.push(ue),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(e.direction&Nt?(i=0===o?Rt:0>o?Dt:It,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?Rt:0>a?zt:qt,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return tt.prototype.attrTest.call(this,t)&&(this.state&fe||!(this.state&fe)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=J(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),h(nt,tt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[se]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&fe)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),h(rt,K,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[oe]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(Lt|Ct)&&!i)this.reset();else if(t.eventType&St)this.reset(),this._timer=u(function(){this.state=de,this.tryEmit()},e.time,this);else if(t.eventType&Lt)return de;return ye},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===de&&(t&&t.eventType&Lt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=mt(),this.manager.emit(this.options.event,this._input)))}}),h(it,tt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[se]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&fe)}}),h(ot,tt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Nt|Ft,pointers:1},getTouchAction:function(){return et.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Nt|Ft)?e=t.overallVelocity:n&Nt?e=t.overallVelocityX:n&Ft&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&yt(e)>this.options.velocity&&t.eventType&Lt},emit:function(t){var e=J(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),h(at,K,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ae]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),t.eventType&St&&0===this.count)return this.failTimeout();if(r&&i&&n){if(t.eventType!=Lt)return this.failTimeout();var o=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||z(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t;var s=this.count%e.taps;if(0===s)return this.hasRequireFailures()?(this._timer=u(function(){this.state=de,this.tryEmit()},e.interval,this),fe):de}return ye},failTimeout:function(){return this._timer=u(function(){this.state=ye},this.options.interval,this),ye},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==de&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),st.VERSION="2.0.6",st.defaults={domEvents:!1,touchAction:ie,enable:!0,inputTarget:null,inputClass:null,preset:[[it,{enable:!1}],[nt,{enable:!1},["rotate"]],[ot,{direction:Nt}],[et,{direction:Nt},["swipe"]],[at],[at,{event:"doubletap",taps:2},["tap"]],[rt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var me=1,ge=2;ut.prototype={set:function(t){return ft(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?ge:me},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,i=e.curRecognizer;(!i||i&&i.state&de)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],e.stopped===ge||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&n.state&(fe|he|pe)&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof K)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(l(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(l(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=x(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return c(b(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return c(b(t),function(t){e?n[t]&&n[t].splice(x(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&ct(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&lt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ft(st,{INPUT_START:St,INPUT_MOVE:At,INPUT_END:Lt,INPUT_CANCEL:Ct,STATE_POSSIBLE:ce,STATE_BEGAN:fe,STATE_CHANGED:he,STATE_ENDED:pe,STATE_RECOGNIZED:de,STATE_CANCELLED:ve,STATE_FAILED:ye,DIRECTION_NONE:Rt,DIRECTION_LEFT:Dt,DIRECTION_RIGHT:It,DIRECTION_UP:zt,DIRECTION_DOWN:qt,DIRECTION_HORIZONTAL:Nt,DIRECTION_VERTICAL:Ft,DIRECTION_ALL:Ht,Manager:ut,Input:P,TouchAction:G,TouchInput:V,MouseInput:H,PointerEventInput:U,TouchMouseInput:X,SingleTouchInput:W,Recognizer:K,AttrRecognizer:tt,Tap:at,Pan:et,Swipe:ot,Pinch:nt,Rotate:it,Press:rt,on:y,off:m,each:c,merge:_t,extend:gt,assign:ft,inherit:h,bindFn:p,prefixed:M});var _e="undefined"!=typeof i?i:"undefined"!=typeof self?self:{};_e.Hammer=st,r=function(){return st}.call(e,n,e,t),!(r!==s&&(t.exports=r))}(window,document,"Hammer")},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(33),l=r(u),c=n(3),f=r(c),h=n(24),p=r(h),d=n(34),v=r(d),y=function(t){function e(t){i(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);var n={skybox:!1};this._options=(0,f["default"])(n,t)}return o(e,t),a(e,[{key:"_onAdd",value:function(){this._initLights(),this._options.skybox&&this._initSkybox()}},{key:"_initLights",value:function(){if(this._options.skybox){this._skyboxLight=new p["default"].DirectionalLight(16777215,1),this._skyboxLight.castShadow=!0;var t=1e3;this._skyboxLight.shadow.camera.left=-t,this._skyboxLight.shadow.camera.right=t,this._skyboxLight.shadow.camera.top=t,this._skyboxLight.shadow.camera.bottom=-t,this._skyboxLight.shadow.camera.near=1e4,this._skyboxLight.shadow.camera.far=7e4,this._skyboxLight.shadow.mapSize.width=2048,this._skyboxLight.shadow.mapSize.height=2048,this.add(this._skyboxLight)}else{var e=new p["default"].DirectionalLight(10066329);e.intesity=.1,e.position.x=100,e.position.y=100,e.position.z=100;var n=new p["default"].DirectionalLight(10066329);n.intesity=.1,n.position.x=-100,n.position.y=100,n.position.z=-100;var r=new p["default"].DirectionalLightHelper(e,10),i=new p["default"].DirectionalLightHelper(n,10);this.add(e),this.add(n),this.add(r),this.add(i)}}},{key:"_initSkybox",value:function(){this._skybox=(0,v["default"])(this._world,this._skyboxLight),this.add(this._skybox._mesh)}},{key:"_initGrid",value:function(){var t=4e3,e=100,n=new p["default"].GridHelper(t,e);this.add(n)}},{key:"destroy",value:function(){this._skyboxLight=null,this.remove(this._skybox._mesh),this._skybox.destroy(),this._skybox=null,s(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(l["default"]);e["default"]=function(t){return new y(t)},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},l=n(2),c=r(l),f=n(24),h=r(f),p=n(25),d=(r(p),function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._layer=new h["default"].Object3D}return a(e,t),s(e,[{key:"add",value:function(t){this._layer.add(t)}},{key:"remove",value:function(t){
this._layer.remove(t)}},{key:"addTo",value:function(t){return t.addLayer(this),this}},{key:"_addToWorld",value:function(t){this._world=t,this._onAdd(t),this.emit("added")}},{key:"destroy",value:function(){var t;for(i=this._layer.children.length-1;i>=0;i--)t=this._layer.children[i],t&&(this.remove(t),t.geometry&&(t.geometry.dispose(),t.geometry=null),t.material&&(t.material.map&&(t.material.map.dispose(),t.material.map=null),t.material.dispose(),t.material=null));this._world=null,this._layer=null}}]),e}(c["default"]));e["default"]=d,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(24),s=r(a),u=n(35),l=r(u),c=n(36),f=r(c),h={vertexShader:["varying vec3 vPosition;","void main() {","vPosition = position;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube cubemap;","varying vec3 vPosition;","void main() {","gl_FragColor = textureCube(cubemap, normalize(vPosition));","}"].join("\n")},p=function(){function t(e,n){i(this,t),this._world=e,this._light=n,this._settings={distance:38e3,turbidity:10,reileigh:2,mieCoefficient:.005,mieDirectionalG:.8,luminance:1,inclination:.48,azimuth:.25},this._initSkybox(),this._updateUniforms(),this._initEvents()}return o(t,[{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,f["default"])(this._update,100),this._world.on("preUpdate",this._throttledWorldUpdate,this)}},{key:"_initSkybox",value:function(){this._cubeCamera=new s["default"].CubeCamera(1,2e6,128);var t=this._cubeCamera.renderTarget;this._sky=new l["default"],this._skyScene=new s["default"].Scene,this._skyScene.add(this._sky.mesh),this._sunSphere=new s["default"].Mesh(new s["default"].SphereBufferGeometry(2e3,16,8),new s["default"].MeshBasicMaterial({color:16777215}));var e={cubemap:{type:"t",value:t}},n=new s["default"].ShaderMaterial({uniforms:e,vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,side:s["default"].BackSide});this._mesh=new s["default"].Mesh(new s["default"].BoxGeometry(19e4,19e4,19e4),n)}},{key:"_updateUniforms",value:function(){var t=this._settings,e=this._sky.uniforms;e.turbidity.value=t.turbidity,e.reileigh.value=t.reileigh,e.luminance.value=t.luminance,e.mieCoefficient.value=t.mieCoefficient,e.mieDirectionalG.value=t.mieDirectionalG;var n=Math.PI*(t.inclination-.5),r=2*Math.PI*(t.azimuth-.5);this._sunSphere.position.x=t.distance*Math.cos(r),this._sunSphere.position.y=t.distance*Math.sin(r)*Math.sin(n),this._sunSphere.position.z=t.distance*Math.sin(r)*Math.cos(n),this._light.position.copy(this._sunSphere.position),this._sky.uniforms.sunPosition.value.copy(this._sunSphere.position)}},{key:"_update",value:function(t){this._done||(this._done=!0,this._light.intensity=1-.95*(this._settings.inclination/.5),this._updateUniforms(),this._cubeCamera.updateCubeMap(this._world._engine._renderer,this._skyScene))}},{key:"getRenderTarget",value:function(){return this._cubeCamera.renderTarget}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._throttledWorldUpdate=null,this._world=null,this._light=null,this._cubeCamera=null,this._sky.mesh.geometry.dispose(),this._sky.mesh.geometry=null,this._sky.mesh.material.map&&(this._sky.mesh.material.map.dispose(),this._sky.mesh.material.map=null),this._sky.mesh.material.dispose(),this._sky.mesh.material=null,this._sky.mesh=null,this._sky=null,this._skyScene=null,this._sunSphere.geometry.dispose(),this._sunSphere.geometry=null,this._sunSphere.material.map&&(this._sunSphere.material.map.dispose(),this._sunSphere.material.map=null),this._sunSphere.material.dispose(),this._sunSphere.material=null,this._sunSphere=null,this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.map&&(this._mesh.material.map.dispose(),this._mesh.material.map=null),this._mesh.material.dispose(),this._mesh.material=null}}]),t}();e["default"]=function(t,e){return new p(t,e)},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i);o["default"].ShaderLib.sky={uniforms:{luminance:{type:"f",value:1},turbidity:{type:"f",value:2},reileigh:{type:"f",value:1},mieCoefficient:{type:"f",value:.005},mieDirectionalG:{type:"f",value:.8},sunPosition:{type:"v3",value:new o["default"].Vector3}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D skySampler;","uniform vec3 sunPosition;","varying vec3 vWorldPosition;","vec3 cameraPos = vec3(0., 0., 0.);","// uniform sampler2D sDiffuse;","// const float turbidity = 10.0; //","// const float reileigh = 2.; //","// const float luminance = 1.0; //","// const float mieCoefficient = 0.005;","// const float mieDirectionalG = 0.8;","uniform float luminance;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","// constants for atmospheric scattering","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003; // refractive index of air","const float N = 2.545E25; // number of molecules per unit volume for air at","// 288.15K and 1013mb (sea level -45 celsius)","const float pn = 0.035;	// depolatization factor for standard air","// wavelength of used primaries, according to preetham","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","// mie stuff","// K coefficient for the primaries","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","// optical length at zenith for molecules","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3(0.0, 1.0, 0.0);","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","// 66 arc seconds -> degrees, and the cosine of that","// earth shadow hack","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","// A simplied version of the total Reayleigh scattering to works on browsers that use ANGLE","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{	 ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (1.0 / (3.0*pi)) * (1.0 + pow(cosTheta, 2.0));","//	return (3.0 / 4.0) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// float logLuminance(vec3 c)","// {","// 	return log(c.r * 0.2126 + c.g * 0.7152 + c.b * 0.0722);","// }","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);","// luminance =  1.0 ;// vWorldPosition.y / 450000. + 0.5; //sunPosition.y / 450000. * 1. + 0.5;","// gl_FragColor = vec4(sunfade, sunfade, sunfade, 1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(sunPosition);","float sunE = sunIntensity(dot(sunDirection, up));","// extinction (absorbtion + out scattering) ","// rayleigh coefficients","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","// mie coefficients","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","// optical length","// cutoff angle at 90 to avoid singularity in next formula.","float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","// combined extinction factor	","vec3 Fex = exp(-(betaR * sR + betaM * sM));","// in scattering","float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));","//nightsky","vec3 direction = normalize(vWorldPosition - cameraPos);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","// vec3 L0 = texture2D(skySampler, uv).rgb+0.1 * Fex;","vec3 L0 = vec3(0.1) * Fex;","// composition + solar disc","//if (cosTheta > sunAngularDiameterCos)","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","// if (normalize(vWorldPosition - cameraPos).y>0.0)","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);   ","texColor *= 0.04 ;","texColor += vec3(0.0,0.001,0.0025)*0.3;","float g_fMaxLuminance = 1.0;","float fLumScaled = 0.1 / luminance;     ","float fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (g_fMaxLuminance * g_fMaxLuminance)))) / (1.0 + fLumScaled); ","float ExposureBias = fLumCompressed;","vec3 curr = Uncharted2Tonemap((log2(2.0/pow(luminance,4.0)))*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1.0;","}"].join("\n")};var a=function(){var t=o["default"].ShaderLib.sky,e=o["default"].UniformsUtils.clone(t.uniforms),n=new o["default"].ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:e,side:o["default"].BackSide}),r=new o["default"].SphereBufferGeometry(45e4,32,15),i=new o["default"].Mesh(r,n);this.mesh=i,this.uniforms=e};e["default"]=a,t.exports=e["default"]},function(t,e,n){function r(t,e,n){var r=!0,s=!0;if("function"!=typeof t)throw new TypeError(a);return i(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),o(t,e,{leading:r,maxWait:e,trailing:s})}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var o=n(37),a="Expected a function";t.exports=r},function(t,e){function n(t,e,n){function r(){_&&clearTimeout(_),p&&clearTimeout(p),x=0,h=p=y=_=b=void 0}function s(e,n){n&&clearTimeout(n),p=_=b=void 0,e&&(x=g(),d=t.apply(y,h),_||p||(h=y=void 0))}function u(){var t=e-(g()-v);0>=t||t>e?s(b,p):_=setTimeout(u,t)}function l(){return(_&&b||p&&M)&&(d=t.apply(y,h)),r(),d}function c(){s(M,_)}function f(){if(h=arguments,v=g(),y=this,b=M&&(_||!w),E===!1)var n=w&&!_;else{p||w||(x=v);var r=E-(v-x),i=0>=r||r>E;i?(p&&(p=clearTimeout(p)),x=v,d=t.apply(y,h)):p||(p=setTimeout(c,r))}return i&&_?_=clearTimeout(_):_||e===E||(_=setTimeout(u,e)),n&&(i=!0,d=t.apply(y,h)),!i||_||p||(h=y=void 0),d}var h,p,d,v,y,_,b,x=0,w=!1,E=!1,M=!0;if("function"!=typeof t)throw new TypeError(a);return e=o(e)||0,i(n)&&(w=!!n.leading,E="maxWait"in n&&m(o(n.maxWait)||0,e),M="trailing"in n?!!n.trailing:M),f.cancel=r,f.flush=l,f}function r(t){var e=i(t)?y.call(t):"";return e==u||e==l}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function o(t){if(i(t)){var e=r(t.valueOf)?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(c,"");var n=h.test(t);return n||p.test(t)?d(t.slice(2),n?2:8):f.test(t)?s:+t}var a="Expected a function",s=NaN,u="[object Function]",l="[object GeneratorFunction]",c=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,p=/^0o[0-7]+$/i,d=parseInt,v=Object.prototype,y=v.toString,m=Math.max,g=Date.now;t.exports=n},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(39),l=r(u),c=n(49),f=r(c),h=n(52),p=r(h),d=n(36),v=r(d),y=n(24),m=r(y),g=n(3),_=r(g),b=function(t){function e(t,n){i(this,e);var r={distance:4e4};n=(0,_["default"])(r,n),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,n),this._path=t}return o(e,t),a(e,[{key:"_onAdd",value:function(t){var n=this;s(Object.getPrototypeOf(e.prototype),"_onAdd",this).call(this,t);var r,i=new m["default"].PlaneBufferGeometry(2e5,2e5,1);r=this._world._environment._skybox?(0,p["default"])("#f5f5f3",this._world._environment._skybox.getRenderTarget()):(0,p["default"])("#f5f5f3");var o=new m["default"].Mesh(i,r);o.rotation.x=-90*Math.PI/180,o.receiveShadow=!0,this._baseLayer=o,this.add(o),setTimeout(function(){n._calculateLOD(),n._initEvents()},0)}},{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,v["default"])(this._onWorldUpdate,100),this._world.on("preUpdate",this._throttledWorldUpdate,this),this._world.on("move",this._onWorldMove,this)}},{key:"_onWorldUpdate",value:function(){this._calculateLOD(),this._outputTiles()}},{key:"_onWorldMove",value:function(t,e){this._moveBaseLayer(e)}},{key:"_moveBaseLayer",value:function(t){this._baseLayer.position.x=t.x,this._baseLayer.position.z=t.y}},{key:"_createTile",value:function(t,e){return(0,f["default"])(t,this._path,e)}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._world.off("move",this._onWorldMove),this._throttledWorldUpdate=null,this._baseLayer.geometry.dispose(),this._baseLayer.geometry=null,this._baseLayer.material.map&&(this._baseLayer.material.map.dispose(),this._baseLayer.material.map=null),this._baseLayer.material.dispose(),this._baseLayer.material=null,this._baseLayer=null,s(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(l["default"]);e["default"]=function(t,e){return new b(t,e)},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(33),l=r(u),c=n(3),f=r(c),h=n(40),p=r(h),d=n(24),v=r(d),y=function(t){function e(t){var n=this;i(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t);var r={maxCache:1e3,maxLOD:18};this._options=(0,f["default"])(r,t),this._tileCache=(0,p["default"])(this._options.maxCache,function(t){n._destroyTile(t)}),this._tileList=[],this._minLOD=3,this._maxLOD=this._options.maxLOD,this._frustum=new v["default"].Frustum,this._tiles=new v["default"].Object3D}return o(e,t),a(e,[{key:"_onAdd",value:function(t){this.add(this._tiles)}},{key:"_updateFrustum",value:function(){var t=this._world.getCamera(),e=new v["default"].Matrix4;e.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromMatrix(t.projectionMatrix),this._frustum.setFromMatrix((new v["default"].Matrix4).multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse))}},{key:"_tileInFrustum",value:function(t){var e=t.getBounds();return this._frustum.intersectsBox(new v["default"].Box3(new v["default"].Vector3(e[0],0,e[3]),new v["default"].Vector3(e[2],0,e[1])))}},{key:"_outputTiles",value:function(){var t=this;this._removeTiles(),this._tileList.forEach(function(e){e.isReady()&&t._tiles.add(e.getMesh())})}},{key:"_calculateLOD",value:function(){var t=this;if(!this._stop&&this._world){var e=this._world.getCamera();this._updateFrustum(this._frustum,e);var n=this._checklist;n=[],n.push(this._requestTile("0",this)),n.push(this._requestTile("1",this)),n.push(this._requestTile("2",this)),n.push(this._requestTile("3",this)),this._divide(n),this._tileList=n.filter(function(n,r){if(!t._tileInFrustum(n))return!1;if(t._options.distance&&t._options.distance>0){var i=n.getCenter(),o=new v["default"].Vector3(i[0],0,i[1]).sub(e.position).length();if(o>t._options.distance)return!1}return n.getMesh()||n.requestTileAsync(),!0})}}},{key:"_divide",value:function(t){for(var e,n,r=0;r!=t.length;)e=t[r],n=e.getQuadcode(),e.length!==this._maxLOD&&this._screenSpaceError(e)?(t.splice(r,1),t.push(this._requestTile(n+"0",this)),t.push(this._requestTile(n+"1",this)),t.push(this._requestTile(n+"2",this)),t.push(this._requestTile(n+"3",this))):r++}},{key:"_screenSpaceError",value:function(t){var e=this._minLOD,n=this._maxLOD,r=t.getQuadcode(),i=this._world.getCamera(),o=3;if(r.length===n)return!1;if(r.length<e)return!0;if(!this._tileInFrustum(t))return!1;var a=t.getCenter(),s=new v["default"].Vector3(a[0],0,a[1]).sub(i.position).length(),u=o*t.getSide()/s;return u>1}},{key:"_removeTiles",value:function(){for(var t=this._tiles.children.length-1;t>=0;t--)this._tiles.remove(this._tiles.children[t])}},{key:"_createTile",value:function(t,e){}},{key:"_requestTile",value:function(t,e){var n=this._tileCache.getTile(t);return n||(n=this._createTile(t,e),this._tileCache.setTile(t,n)),n}},{key:"_destroyTile",value:function(t){this._tiles.remove(t.getMesh()),t.destroy()}},{key:"destroy",value:function(){var t;for(t=this._tiles.children.length-1;t>=0;t--)this._tiles.remove(this._tiles.children[t]);this._tileCache.destroy(),this._tileCache=null,this._tiles=null,this._frustum=null,s(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(l["default"]);e["default"]=y,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(41),s=r(a),u=function(){function t(e,n){i(this,t),this._cache=(0,s["default"])({max:e,dispose:function(t,e){n(e)}})}return o(t,[{key:"isReady",value:function(){return!1}},{key:"getTile",value:function(t){return this._cache.get(t)}},{key:"setTile",value:function(t,e){this._cache.set(t,e)}},{key:"destroy",value:function(){this._cache.reset(),this._cache=null}}]),t}();e["default"]=function(t,e){return new u(t,e)},t.exports=e["default"]},function(t,e,n){function r(t,e,n){var r;return y[e]?r=y[e]:(r=h(e),y[e]=r),2===arguments.length?t[r]:(t[r]=n,n)}function i(){return 1}function o(t){if(!(this instanceof o))return new o(t);"number"==typeof t&&(t={max:t}),t||(t={});var e=r(this,"max",t.max);(!e||"number"!=typeof e||0>=e)&&r(this,"max",1/0);var n=t.length||i;"function"!=typeof n&&(n=i),r(this,"lengthCalculator",n),r(this,"allowStale",t.stale||!1),r(this,"maxAge",t.maxAge||0),r(this,"dispose",t.dispose),this.reset()}function a(t,e,n,i){var o=n.value;u(t,o)&&(c(t,n),r(t,"allowStale")||(o=void 0)),o&&e.call(i,o.value,o.key,t)}function s(t,e,n){var i=r(t,"cache").get(e);if(i){var o=i.value;u(t,o)?(c(t,i),r(t,"allowStale")||(o=void 0)):n&&r(t,"lruList").unshiftNode(i),o&&(o=o.value)}return o}function u(t,e){if(!e||!e.maxAge&&!r(t,"maxAge"))return!1;var n=!1,i=Date.now()-e.now;return n=e.maxAge?i>e.maxAge:r(t,"maxAge")&&i>r(t,"maxAge")}function l(t){if(r(t,"length")>r(t,"max"))for(var e=r(t,"lruList").tail;r(t,"length")>r(t,"max")&&null!==e;){var n=e.prev;c(t,e),e=n}}function c(t,e){if(e){var n=e.value;r(t,"dispose")&&r(t,"dispose").call(this,n.key,n.value),r(t,"length",r(t,"length")-n.length),r(t,"cache")["delete"](n.key),r(t,"lruList").removeNode(e)}}function f(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}t.exports=o;var h,p=n(42),d=n(45),v=n(48),y={},m="function"==typeof Symbol;h=m?function(t){return Symbol["for"](t)}:function(t){return"_"+t},Object.defineProperty(o.prototype,"max",{set:function(t){(!t||"number"!=typeof t||0>=t)&&(t=1/0),r(this,"max",t),l(this)},get:function(){return r(this,"max")},enumerable:!0}),Object.defineProperty(o.prototype,"allowStale",{set:function(t){r(this,"allowStale",!!t)},get:function(){return r(this,"allowStale")},enumerable:!0}),Object.defineProperty(o.prototype,"maxAge",{set:function(t){(!t||"number"!=typeof t||0>t)&&(t=0),r(this,"maxAge",t),l(this)},get:function(){return r(this,"maxAge")},enumerable:!0}),Object.defineProperty(o.prototype,"lengthCalculator",{set:function(t){"function"!=typeof t&&(t=i),t!==r(this,"lengthCalculator")&&(r(this,"lengthCalculator",t),r(this,"length",0),r(this,"lruList").forEach(function(t){t.length=r(this,"lengthCalculator").call(this,t.value,t.key),r(this,"length",r(this,"length")+t.length)},this)),l(this)},get:function(){return r(this,"lengthCalculator")},enumerable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return r(this,"length")},enumerable:!0}),Object.defineProperty(o.prototype,"itemCount",{get:function(){return r(this,"lruList").length},enumerable:!0}),o.prototype.rforEach=function(t,e){e=e||this;for(var n=r(this,"lruList").tail;null!==n;){var i=n.prev;a(this,t,n,e),n=i}},o.prototype.forEach=function(t,e){e=e||this;for(var n=r(this,"lruList").head;null!==n;){var i=n.next;a(this,t,n,e),n=i}},o.prototype.keys=function(){return r(this,"lruList").toArray().map(function(t){return t.key},this)},o.prototype.values=function(){return r(this,"lruList").toArray().map(function(t){return t.value},this)},o.prototype.reset=function(){r(this,"dispose")&&r(this,"lruList")&&r(this,"lruList").length&&r(this,"lruList").forEach(function(t){r(this,"dispose").call(this,t.key,t.value)},this),r(this,"cache",new p),r(this,"lruList",new v),r(this,"length",0)},o.prototype.dump=function(){return r(this,"lruList").map(function(t){return u(this,t)?void 0:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}},this).toArray().filter(function(t){return t})},o.prototype.dumpLru=function(){return r(this,"lruList")},o.prototype.inspect=function(t,e){var n="LRUCache {",o=!1,a=r(this,"allowStale");a&&(n+="\n  allowStale: true",o=!0);var s=r(this,"max");s&&s!==1/0&&(o&&(n+=","),n+="\n  max: "+d.inspect(s,e),o=!0);var l=r(this,"maxAge");l&&(o&&(n+=","),n+="\n  maxAge: "+d.inspect(l,e),o=!0);var c=r(this,"lengthCalculator");c&&c!==i&&(o&&(n+=","),n+="\n  length: "+d.inspect(r(this,"length"),e),o=!0);var f=!1;return r(this,"lruList").forEach(function(t){f?n+=",\n  ":(o&&(n+=",\n"),f=!0,n+="\n  ");var r=d.inspect(t.key).split("\n").join("\n  "),a={value:t.value};t.maxAge!==l&&(a.maxAge=t.maxAge),c!==i&&(a.length=t.length),u(this,t)&&(a.stale=!0),a=d.inspect(a,e).split("\n").join("\n  "),n+=r+" => "+a}),(f||o)&&(n+="\n"),n+="}"},o.prototype.set=function(t,e,n){n=n||r(this,"maxAge");var i=n?Date.now():0,o=r(this,"lengthCalculator").call(this,e,t);if(r(this,"cache").has(t)){if(o>r(this,"max"))return c(this,r(this,"cache").get(t)),!1;var a=r(this,"cache").get(t),s=a.value;return r(this,"dispose")&&r(this,"dispose").call(this,t,s.value),s.now=i,s.maxAge=n,s.value=e,r(this,"length",r(this,"length")+(o-s.length)),s.length=o,this.get(t),l(this),!0}var u=new f(t,e,o,i,n);return u.length>r(this,"max")?(r(this,"dispose")&&r(this,"dispose").call(this,t,e),!1):(r(this,"length",r(this,"length")+u.length),r(this,"lruList").unshift(u),r(this,"cache").set(t,r(this,"lruList").head),l(this),!0)},o.prototype.has=function(t){if(!r(this,"cache").has(t))return!1;var e=r(this,"cache").get(t).value;return u(this,e)?!1:!0},o.prototype.get=function(t){return s(this,t,!0)},o.prototype.peek=function(t){return s(this,t,!1)},o.prototype.pop=function(){var t=r(this,"lruList").tail;return t?(c(this,t),t.value):null},o.prototype.del=function(t){c(this,r(this,"cache").get(t))},o.prototype.load=function(t){this.reset();for(var e=Date.now(),n=t.length-1;n>=0;n--){var r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{var o=i-e;o>0&&this.set(r.k,r.v,o)}}},o.prototype.prune=function(){var t=this;r(this,"cache").forEach(function(e,n){s(t,n,!1)})}},function(t,e,n){(function(e){"pseudomap"===e.env.npm_package_name&&"test"===e.env.npm_lifecycle_script&&(e.env.TEST_PSEUDOMAP="true"),"function"!=typeof Map||e.env.TEST_PSEUDOMAP?t.exports=n(44):t.exports=Map}).call(e,n(43))},function(t,e){function n(){l=!1,a.length?u=a.concat(u):c=-1,u.length&&r()}function r(){if(!l){var t=setTimeout(n);l=!0;for(var e=u.length;e;){for(a=u,u=[];++c<e;)a&&a[c].run();c=-1,e=u.length}a=null,l=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function o(){}var a,s=t.exports={},u=[],l=!1,c=-1;s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new i(t,e)),1!==u.length||l||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=o,s.addListener=o,s.once=o,s.off=o,s.removeListener=o,s.removeAllListeners=o,s.emit=o,s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e){function n(t){if(!(this instanceof n))throw new TypeError("Constructor PseudoMap requires 'new'");if(this.clear(),t)if(t instanceof n||"function"==typeof Map&&t instanceof Map)t.forEach(function(t,e){this.set(e,t)},this);else{if(!Array.isArray(t))throw new TypeError("invalid argument");t.forEach(function(t){this.set(t[0],t[1])},this)}}function r(t,e){return t===e||t!==t&&e!==e}function i(t,e,n){this.key=t,this.value=e,this._index=n}function o(t,e){for(var n=0,i="_"+e,o=i;s.call(t,o);o=i+n++)if(r(t[o].key,e))return t[o]}function a(t,e,n){for(var o=0,a="_"+e,u=a;s.call(t,u);u=a+o++)if(r(t[u].key,e))return void(t[u].value=n);t.size++,t[u]=new i(e,n,u)}var s=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.forEach=function(t,e){e=e||this,Object.keys(this._data).forEach(function(n){"size"!==n&&t.call(e,this._data[n].value,this._data[n].key)},this)},n.prototype.has=function(t){return!!o(this._data,t)},n.prototype.get=function(t){var e=o(this._data,t);return e&&e.value},n.prototype.set=function(t,e){a(this._data,t,e)},n.prototype["delete"]=function(t){var e=o(this._data,t);e&&(delete this._data[e._index],this._data.size--)},n.prototype.clear=function(){var t=Object.create(null);t.size=0,Object.defineProperty(this,"_data",{value:t,enumerable:!1,configurable:!0,writable:!1})},Object.defineProperty(n.prototype,"size",{get:function(){return this._data.size},set:function(t){},enumerable:!0,configurable:!0}),n.prototype.values=n.prototype.keys=n.prototype.entries=function(){throw new Error("iterators are not implemented in this version")}},function(t,e,n){(function(t,r){function i(t,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&e._extend(r,n),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return _(i)||(i=u(t,i,r)),i}var o=l(t,n);if(o)return o;var a=Object.keys(n),v=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),O(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(n);if(0===a.length){if(T(n)){var y=n.name?": "+n.name:"";return t.stylize("[Function"+y+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(M(n))return t.stylize(Date.prototype.toString.call(n),"date");if(O(n))return c(n)}var m="",g=!1,b=["{","}"];if(d(n)&&(g=!0,b=["[","]"]),T(n)){var x=n.name?": "+n.name:"";m=" [Function"+x+"]"}if(w(n)&&(m=" "+RegExp.prototype.toString.call(n)),M(n)&&(m=" "+Date.prototype.toUTCString.call(n)),O(n)&&(m=" "+c(n)),0===a.length&&(!g||0==n.length))return b[0]+m+b[1];if(0>r)return w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var E;return E=g?f(t,n,r,v,a):a.map(function(e){return h(t,n,r,v,e,g)}),t.seen.pop(),p(E,m,b)}function l(t,e){if(x(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):v(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i){for(var o=[],a=0,s=e.length;s>a;++a)A(e,String(a))?o.push(h(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}function h(t,e,n,r,i,o){var a,s,l;if(l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},l.get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(l.value)<0?(s=y(n)?u(t,l.value,null):u(t,l.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t;
}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),x(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function v(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return null==t}function g(t){return"number"==typeof t}function _(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function x(t){return void 0===t}function w(t){return E(t)&&"[object RegExp]"===j(t)}function E(t){return"object"==typeof t&&null!==t}function M(t){return E(t)&&"[object Date]"===j(t)}function O(t){return E(t)&&("[object Error]"===j(t)||t instanceof Error)}function T(t){return"function"==typeof t}function P(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function j(t){return Object.prototype.toString.call(t)}function k(t){return 10>t?"0"+t.toString(10):t.toString(10)}function S(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),D[t.getMonth()],e].join(" ")}function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var L=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(t).replace(L,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),s=r[n];o>n;s=r[++n])a+=y(s)||!E(s)?" "+s:" "+i(s);return a},e.deprecate=function(n,i){function o(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}if(x(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var a=!1;return o};var C,R={};e.debuglog=function(t){if(x(C)&&(C=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(C)){var n=r.pid;R[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else R[t]=function(){};return R[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=v,e.isNull=y,e.isNullOrUndefined=m,e.isNumber=g,e.isString=_,e.isSymbol=b,e.isUndefined=x,e.isRegExp=w,e.isObject=E,e.isDate=M,e.isError=O,e.isFunction=T,e.isPrimitive=P,e.isBuffer=n(46);var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",S(),e.format.apply(e,arguments))},e.inherits=n(47),e._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,function(){return this}(),n(43))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e){function n(t){var e=this;if(e instanceof n||(e=new n),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){e.push(t)});else if(arguments.length>0)for(var r=0,i=arguments.length;i>r;r++)e.push(arguments[r]);return e}function r(t,e){t.tail=new o(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function i(t,e){t.head=new o(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function o(t,e,n,r){return this instanceof o?(this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,void(n?(n.prev=this,this.next=n):this.next=null)):new o(t,e,n,r)}t.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null},n.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},n.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},n.prototype.push=function(){for(var t=0,e=arguments.length;e>t;t++)r(this,arguments[t]);return this.length},n.prototype.unshift=function(){for(var t=0,e=arguments.length;e>t;t++)i(this,arguments[t]);return this.length},n.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail.next=null,this.length--,t}},n.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head.prev=null,this.length--,t}},n.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},n.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},n.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&t>e;e++)n=n.next;return e===t&&null!==n?n.value:void 0},n.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&t>e;e++)n=n.prev;return e===t&&null!==n?n.value:void 0},n.prototype.map=function(t,e){e=e||this;for(var r=new n,i=this.head;null!==i;)r.push(t.call(e,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(t,e){e=e||this;for(var r=new n,i=this.tail;null!==i;)r.push(t.call(e,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},n.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},n.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},n.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},n.prototype.slice=function(t,e){e=e||this.length,0>e&&(e+=this.length),t=t||0,0>t&&(t+=this.length);var r=new n;if(t>e||0>e)return r;0>t&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&t>i;i++)o=o.next;for(;null!==o&&e>i;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(t,e){e=e||this.length,0>e&&(e+=this.length),t=t||0,0>t&&(t+=this.length);var r=new n;if(t>e||0>e)return r;0>t&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)r.push(o.value);return r},n.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this}},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(50),l=r(u),c=n(51),f=(r(c),n(24)),h=r(f),p=function(t){function e(t,n,r){i(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,n,r)}return o(e,t),a(e,[{key:"requestTileAsync",value:function(){var t=this;setTimeout(function(){t._mesh||(t._mesh=t._createMesh(),t._requestTile())},0)}},{key:"destroy",value:function(){this._abortRequest(),this._image=null,s(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_createMesh",value:function(){if(this._center){var t,e=new h["default"].Object3D,n=new h["default"].PlaneBufferGeometry(this._side,this._side,1);this._world._environment._skybox?(t=new h["default"].MeshStandardMaterial({depthWrite:!1}),t.roughness=1,t.metalness=.1,t.envMap=this._world._environment._skybox.getRenderTarget()):t=new h["default"].MeshBasicMaterial({depthWrite:!1});var r=new h["default"].Mesh(n,t);return r.rotation.x=-90*Math.PI/180,r.receiveShadow=!0,e.add(r),e.renderOrder=0,e.position.x=this._center[0],e.position.z=this._center[1],e}}},{key:"_createDebugMesh",value:function(){var t=document.createElement("canvas");t.width=256,t.height=256;var e=t.getContext("2d");e.font="Bold 20px Helvetica Neue, Verdana, Arial",e.fillStyle="#ff0000",e.fillText(this._quadcode,20,t.width/2-5),e.fillText(this._tile.toString(),20,t.width/2+25);var n=new h["default"].Texture(t);n.magFilter=h["default"].LinearFilter,n.minFilter=h["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0;var r=new h["default"].MeshBasicMaterial({map:n,transparent:!0,depthWrite:!1}),i=new h["default"].PlaneBufferGeometry(this._side,this._side,1),o=new h["default"].Mesh(i,r);return o.rotation.x=-90*Math.PI/180,o.position.y=.1,o}},{key:"_requestTile",value:function(){var t=this,e={x:this._tile[0],y:this._tile[1],z:this._tile[2]},n=this._getTileURL(e),r=document.createElement("img");r.addEventListener("load",function(e){var n=new h["default"].Texture;n.image=r,n.needsUpdate=!0,n.magFilter=h["default"].LinearFilter,n.minFilter=h["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0,t._mesh&&t._mesh.children[0]&&t._mesh.children[0].material&&(t._mesh.children[0].material.map=n,t._mesh.children[0].material.needsUpdate=!0,t._texture=n,t._ready=!0)},!1),r.crossOrigin="",r.src=n,this._image=r}},{key:"_abortRequest",value:function(){this._image&&(this._image.src="")}}]),e}(l["default"]);e["default"]=function(t,e,n){return new p(t,e,n)},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(11),s=(r(a),n(10)),u=r(s),l=n(24),c=r(l),f=180/Math.PI,h=/\{([szxy])\}/g,p=function(){function t(e,n,r){i(this,t),this._layer=r,this._world=r._world,this._quadcode=e,this._path=n,this._ready=!1,this._tile=this._quadcodeToTile(e),this._boundsLatLon=this._tileBoundsWGS84(this._tile),this._boundsWorld=this._tileBoundsFromWGS84(this._boundsLatLon),this._center=this._boundsToCenter(this._boundsWorld),this._centerLatlon=this._world.pointToLatLon(VIZI.Point(this._center[0],this._center[1])),this._side=this._getSide(this._boundsWorld),this._pointScale=this._world.pointScale(this._centerLatlon)}return o(t,[{key:"isReady",value:function(){return this._ready}},{key:"requestTileAsync",value:function(){}},{key:"getQuadcode",value:function(){return this._quadcode}},{key:"getBounds",value:function(){return this._boundsWorld}},{key:"getCenter",value:function(){return this._center}},{key:"getSide",value:function(){return this._side}},{key:"getMesh",value:function(){return this._mesh}},{key:"destroy",value:function(){this._layer=null,this._world=null,this._boundsLatLon=null,this._boundsWorld=null,this._center=null,this._mesh&&(this._mesh.children?this._mesh.children.forEach(function(t){t.geometry.dispose(),t.geometry=null,t.material.map&&(t.material.map.dispose(),t.material.map=null),t.material.dispose(),t.material=null}):(this._mesh.geometry.dispose(),this._mesh.geometry=null,this._mesh.material.map&&(this._mesh.material.map.dispose(),this._mesh.material.map=null),this._mesh.material.dispose(),this._mesh.material=null))}},{key:"_createMesh",value:function(){}},{key:"_createDebugMesh",value:function(){}},{key:"_getTileURL",value:function(t){return t.s||(t.s=String.fromCharCode(97+Math.floor(3*Math.random()))),h.lastIndex=0,this._path.replace(h,function(e,n){return t[n]})}},{key:"_quadcodeToTile",value:function(t){for(var e=0,n=0,r=t.length,i=r;i>0;i--){var o=1<<i-1,a=+t[r-i];1===a&&(e|=o),2===a&&(n|=o),3===a&&(e|=o,n|=o)}return[e,n,r]}},{key:"_tileBoundsFromWGS84",value:function(t){var e=this._layer._world.latLonToPoint((0,u["default"])(t[1],t[0])),n=this._layer._world.latLonToPoint((0,u["default"])(t[3],t[2]));return[e.x,e.y,n.x,n.y]}},{key:"_tileBoundsWGS84",value:function(t){var e=this._tile2lon(t[0]+1,t[2]),n=this._tile2lon(t[0],t[2]),r=this._tile2lat(t[1]+1,t[2]),i=this._tile2lat(t[1],t[2]);return[n,r,e,i]}},{key:"_tile2lon",value:function(t,e){return t/Math.pow(2,e)*360-180}},{key:"_tile2lat",value:function(t,e){var n=Math.PI-2*Math.PI*t/Math.pow(2,e);return f*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))}},{key:"_boundsToCenter",value:function(t){var e=t[0]+(t[2]-t[0])/2,n=t[1]+(t[3]-t[1])/2;return[e,n]}},{key:"_getSide",value:function(t){return new c["default"].Vector3(t[0],0,t[3]).sub(new c["default"].Vector3(t[0],0,t[1])).length()}}]),t}();e["default"]=p,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i);BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new o["default"].BufferGeometry;r.setIndex(new o["default"].BufferAttribute(e,1)),r.addAttribute("position",new o["default"].BufferAttribute(n,3)),o["default"].LineSegments.call(this,r,new o["default"].LineBasicMaterial({linewidth:2,color:16711680})),void 0!==t&&this.update(t)},BoxHelper.prototype=Object.create(o["default"].LineSegments.prototype),BoxHelper.prototype.constructor=BoxHelper,BoxHelper.prototype.update=function(){var t=new o["default"].Box3;return function(e){if(t.setFromObject(e),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),e["default"]=BoxHelper,t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(24),o=r(i);e["default"]=function(t,e){var n=document.createElement("canvas");n.width=1,n.height=1;var r=n.getContext("2d");r.fillStyle=t,r.fillRect(0,0,n.width,n.height);var i=new o["default"].Texture(n);i.needsUpdate=!0;var a;return e?(a=new o["default"].MeshStandardMaterial({depthWrite:!1}),a.roughness=1,a.metalness=.1,a.envMap=e):a=new o["default"].MeshBasicMaterial({map:i,depthWrite:!1}),a},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},u=n(39),l=r(u),c=n(3),f=r(c),h=n(54),p=r(h),d=n(36),v=r(d),y=n(24),m=(r(y),function(t){function e(t,n){i(this,e);var r={maxLOD:14,distance:2e3};n=(0,f["default"])(r,n),s(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,n),this._path=t}return o(e,t),a(e,[{key:"_onAdd",value:function(t){var n=this;s(Object.getPrototypeOf(e.prototype),"_onAdd",this).call(this,t),setTimeout(function(){n._calculateLOD(),n._initEvents()},0)}},{key:"_initEvents",value:function(){this._throttledWorldUpdate=(0,v["default"])(this._onWorldUpdate,100),this._world.on("preUpdate",this._throttledWorldUpdate,this),this._world.on("move",this._onWorldMove,this),this._world.on("controlsMove",this._onControlsMove,this)}},{key:"_onWorldUpdate",value:function(){this._pauseOutput||this._outputTiles()}},{key:"_onWorldMove",value:function(t,e){this._pauseOutput=!1,this._calculateLOD()}},{key:"_onControlsMove",value:function(){this._pauseOutput=!0}},{key:"_createTile",value:function(t,e){var n={};return this._options.filter&&(n.filter=this._options.filter),this._options.style&&(n.style=this._options.style),(0,p["default"])(t,this._path,e,n)}},{key:"destroy",value:function(){this._world.off("preUpdate",this._throttledWorldUpdate),this._world.off("move",this._onWorldMove),this._throttledWorldUpdate=null,s(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}}]),e}(l["default"]));e["default"]=function(t,e){return new m(t,e)},t.exports=e["default"]},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,a=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,o);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var l=Object.getPrototypeOf(i);if(null===l)return;t=l,e=o,n=a,r=!0,s=l=void 0}},l=n(50),c=r(l),f=n(51),h=(r(f),n(24)),p=r(h),d=n(55),v=r(d),y=n(57),m=r(y),g=n(11),_=r(g),b=n(10),x=r(b),w=n(58),E=r(w),M=n(3),O=r(M),T=n(59),P=r(T),j=n(60),k=r(j),S=function(t){function e(t,n,r,i){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,n,r);var a={filter:null,style:{color:"#ffffff"}};this._options=(0,O["default"])(a,i)}return a(e,t),s(e,[{key:"requestTileAsync",value:function(){var t=this;setTimeout(function(){t._mesh||(t._mesh=t._createMesh(),t._requestTile())},0)}},{key:"destroy",value:function(){this._abortRequest(),this._request=null,u(Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_createMesh",value:function(){if(this._center){var t=new p["default"].Object3D;return t.position.x=this._center[0],t.position.z=this._center[1],t}}},{key:"_createDebugMesh",value:function(){var t=document.createElement("canvas");t.width=256,t.height=256;var e=t.getContext("2d");e.font="Bold 20px Helvetica Neue, Verdana, Arial",e.fillStyle="#ff0000",e.fillText(this._quadcode,20,t.width/2-5),e.fillText(this._tile.toString(),20,t.width/2+25);var n=new p["default"].Texture(t);n.magFilter=p["default"].LinearFilter,n.minFilter=p["default"].LinearMipMapLinearFilter,n.anisotropy=4,n.needsUpdate=!0;var r=new p["default"].MeshBasicMaterial({map:n,transparent:!0,depthWrite:!1}),i=new p["default"].PlaneBufferGeometry(this._side,this._side,1),o=new p["default"].Mesh(i,r);return o.rotation.x=-90*Math.PI/180,o.position.y=.1,o}},{key:"_createShadowCanvas",value:function(){var t=document.createElement("canvas");return t.width=512,t.height=512,t}},{key:"_addShadow",value:function(t){var e,n,r=this,i=this._shadowCanvas.getContext("2d"),o=this._shadowCanvas.width,a=this._shadowCanvas.height,s=new k["default"];t.forEach(function(t,u){i.beginPath(),e=t.map(function(t){var e=(t[0]-r._boundsWorld[0])/r._side,n=(t[1]-r._boundsWorld[3])/r._side;return[e*o,n*a]}),n=u>0?e:s.data(e).padding(1.3),n.forEach(function(t,e){0===e?i.moveTo(t[0],t[1]):i.lineTo(t[0],t[1])}),i.closePath()}),i.fillStyle="rgba(80, 80, 80, 0.7)",i.fill()}},{key:"_requestTile",value:function(){var t=this,e={x:this._tile[0],y:this._tile[1],z:this._tile[2]},n=this._getTileURL(e);this._request=(0,v["default"])({url:n,type:"json",crossOrigin:!0}).then(function(e){t._request=null,t._processTileData(e)})["catch"](function(e){console.error(e),t._request=null})}},{key:"_processTileData",value:function(t){var e=this;console.time(this._tile);var n=m["default"].feature(t,t.objects.vectile),r=(0,_["default"])(0,0);r.x=-1*this._center[0],r.y=-1*this._center[1];var i,o,a=[],s=[],u=[],l=0,c=new p["default"].Color,f=new p["default"].Color(16777215),h=new p["default"].Color(6710886),d=n.features;this._options.filter&&(d=n.features.filter(this._options.filter));var v=this._options.style;if(d.forEach(function(t){"function"==typeof e._options.style&&(v=e._options.style(t));var n=t.geometry.coordinates;if(n[0]&&n[0][0]&&Array.isArray(n[0][0])){n=n.map(function(t){return t.map(function(t){var n=(0,x["default"])(t[1],t[0]),r=e._layer._world.latLonToPoint(n);return[r.x,r.y]})}),i=e._toEarcut(n),o=e._triangulate(i.vertices,i.holes,i.dimensions);var r=[];for(R=0,il=i.vertices.length;R<il;R+=i.dimensions)r.push(i.vertices.slice(R,R+i.dimensions));var p=0;v.height&&(p=e._world.metresToWorld(v.height,e._pointScale));var d=(0,P["default"])(r,o,{bottom:0,top:p});c.set(v.color);var y=c.clone().multiply(f),m=c.clone().multiply(h),g=[],_=[];a.push(d.positions);var b;d.top.forEach(function(t,e){b=[],b.push([c.r,c.g,c.b]),b.push([c.r,c.g,c.b]),b.push([c.r,c.g,c.b]),g.push(t),_.push(b)}),d.sides.forEach(function(t,e){b=[],e%2===0?(b.push([m.r,m.g,m.b]),b.push([m.r,m.g,m.b]),b.push([y.r,y.g,y.b])):(b.push([y.r,y.g,y.b]),b.push([y.r,y.g,y.b]),b.push([m.r,m.g,m.b])),g.push(t),_.push(b)}),s.push(g),u.push(_),l+=g.length}}),0===l)return void(this._ready=!0);for(var y,g,b,w,E=new p["default"].BufferGeometry,M=new Float32Array(9*l),O=new Float32Array(9*l),T=new Float32Array(9*l),j=new p["default"].Vector3,k=new p["default"].Vector3,S=new p["default"].Vector3,A=new p["default"].Vector3,L=new p["default"].Vector3,C=0,R=0;R<s.length;R++){g=s[R],b=a[R],w=u[R];for(var D=0;D<g.length;D++){y=g[D][0];var I=b[y][0]+r.x,z=b[y][1],q=b[y][2]+r.y,N=w[D][0];y=g[D][1];var F=b[y][0]+r.x,H=b[y][1],U=b[y][2]+r.y,W=w[D][1];y=g[D][2];var B=b[y][0]+r.x,V=b[y][1],Z=b[y][2]+r.y,X=w[D][2];j.set(I,z,q),k.set(F,H,U),S.set(B,V,Z),A.subVectors(S,k),L.subVectors(j,k),A.cross(L),A.normalize();var G=A.x,Y=A.y,K=A.z;M[9*C+0]=I,M[9*C+1]=z,M[9*C+2]=q,O[9*C+0]=G,O[9*C+1]=Y,O[9*C+2]=K,T[9*C+0]=N[0],T[9*C+1]=N[1],T[9*C+2]=N[2],M[9*C+3]=F,M[9*C+4]=H,M[9*C+5]=U,O[9*C+3]=G,O[9*C+4]=Y,O[9*C+5]=K,T[9*C+3]=W[0],T[9*C+4]=W[1],T[9*C+5]=W[2],M[9*C+6]=B,M[9*C+7]=V,M[9*C+8]=Z,O[9*C+6]=G,O[9*C+7]=Y,O[9*C+8]=K,T[9*C+6]=X[0],T[9*C+7]=X[1],T[9*C+8]=X[2],C++}}E.addAttribute("position",new p["default"].BufferAttribute(M,3)),E.addAttribute("normal",new p["default"].BufferAttribute(O,3)),E.addAttribute("color",new p["default"].BufferAttribute(T,3)),E.computeBoundingBox();var $;this._world._environment._skybox?($=new p["default"].MeshStandardMaterial({vertexColors:p["default"].VertexColors,side:p["default"].BackSide}),$.roughness=1,$.metalness=.1,$.envMapIntensity=3,$.envMap=this._world._environment._skybox.getRenderTarget()):$=new p["default"].MeshPhongMaterial({vertexColors:p["default"].VertexColors,side:p["default"].BackSide});var J=new p["default"].Mesh(E,$);J.castShadow=!0,J.receiveShadow=!0,this._mesh.add(J),this._ready=!0,console.timeEnd(this._tile),console.log(this._tile+": "+d.length+" features")}},{key:"_toEarcut",value:function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;e>a;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},{key:"_triangulate",value:function(t,e,n){var r=(0,E["default"])(t,e,n),o=[];for(i=0,il=r.length;i<il;i+=3)o.push(r.slice(i,i+3));return o}},{key:"_abortRequest",value:function(){this._request&&this._request.abort()}}]),e}(c["default"]);e["default"]=function(t,e,n,r){return new S(t,e,n,r)},t.exports=e["default"]},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;!function(t,e,n){"undefined"!=typeof module&&module.exports?module.exports=n():(__WEBPACK_AMD_DEFINE_FACTORY__=n,__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof __WEBPACK_AMD_DEFINE_FACTORY__?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}("reqwest",this,function(){function succeed(t){var e=protocolRe.exec(t.url);return e=e&&e[1]||context.location.protocol,httpsRe.test(e)?twoHundo.test(t.request.status):!!t.request.response}function handleReadyState(t,e,n){return function(){return t._aborted?n(t.request):t._timedOut?n(t.request,"Request is aborted: timeout"):void(t.request&&4==t.request[readyState]&&(t.request.onreadystatechange=noop,succeed(t)?e(t.request):n(t.request)))}}function setHeaders(t,e){var n,r=e.headers||{};r.Accept=r.Accept||defaultHeaders.accept[e.type]||defaultHeaders.accept["*"];var i="undefined"!=typeof FormData&&e.data instanceof FormData;e.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||i||(r[contentType]=e.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in t&&t.setRequestHeader(n,r[n])}function setCredentials(t,e){"undefined"!=typeof e.withCredentials&&"undefined"!=typeof t.withCredentials&&(t.withCredentials=!!e.withCredentials)}function generalCallback(t){lastValue=t}function urlappend(t,e){return t+(/\?/.test(t)?"&":"?")+e}function handleJsonp(t,e,n,r){var i=uniqid++,o=t.jsonpCallback||"callback",a=t.jsonpCallbackName||reqwest.getcallbackPrefix(i),s=new RegExp("((^|\\?|&)"+o+")=([^&]+)"),u=r.match(s),l=doc.createElement("script"),c=0,f=-1!==navigator.userAgent.indexOf("MSIE 10.0");return u?"?"===u[3]?r=r.replace(s,"$1="+a):a=u[3]:r=urlappend(r,o+"="+a),context[a]=generalCallback,l.type="text/javascript",l.src=r,l.async=!0,"undefined"==typeof l.onreadystatechange||f||(l.htmlFor=l.id="_reqwest_"+i),l.onload=l.onreadystatechange=function(){return l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||c?!1:(l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),e(lastValue),lastValue=void 0,head.removeChild(l),void(c=1))},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),c=1}}}function getRequest(t,e){var n,r=this.o,i=(r.method||"GET").toUpperCase(),o="string"==typeof r?r:r.url,a=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,s=!1;return"jsonp"!=r.type&&"GET"!=i||!a||(o=urlappend(o,a),a=null),"jsonp"==r.type?handleJsonp(r,t,e,o):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(i,o,r.async===!1?!1:!0),setHeaders(n,r),setCredentials(n,r),context[xDomainRequest]&&n instanceof context[xDomainRequest]?(n.onload=t,n.onerror=e,n.onprogress=function(){},s=!0):n.onreadystatechange=handleReadyState(this,t,e),r.before&&r.before(n),s?setTimeout(function(){n.send(a)},200):n.send(a),n)}function Reqwest(t,e){this.o=t,this.fn=e,init.apply(this,arguments)}function setType(t){return null!==t?t.match("json")?"json":t.match("javascript")?"js":t.match("text")?"html":t.match("xml")?"xml":void 0:void 0}function init(o,fn){function complete(t){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(t)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(t,e,n){for(t=self.request,self._responseArgs.resp=t,self._responseArgs.msg=e,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(t,e,n);complete(t)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(t,e){return new Reqwest(t,e)}function normalize(t){return t?t.replace(/\r?\n/g,"\r\n"):""}function serial(t,e){var n,r,i,o,a=t.name,s=t.tagName.toLowerCase(),u=function(t){t&&!t.disabled&&e(a,normalize(t.attributes.value&&t.attributes.value.specified?t.value:t.text))};if(!t.disabled&&a)switch(s){case"input":/reset|button|image|file/i.test(t.type)||(n=/checkbox/i.test(t.type),r=/radio/i.test(t.type),
i=t.value,(!(n||r)||t.checked)&&e(a,normalize(n&&""===i?"on":i)));break;case"textarea":e(a,normalize(t.value));break;case"select":if("select-one"===t.type.toLowerCase())u(t.selectedIndex>=0?t.options[t.selectedIndex]:null);else for(o=0;t.length&&o<t.length;o++)t.options[o].selected&&u(t.options[o])}}function eachFormElement(){var t,e,n=this,r=function(t,e){var r,i,o;for(r=0;r<e.length;r++)for(o=t[byTag](e[r]),i=0;i<o.length;i++)serial(o[i],n)};for(e=0;e<arguments.length;e++)t=arguments[e],/input|select|textarea/i.test(t.tagName)&&serial(t,n),r(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var t={};return eachFormElement.apply(function(e,n){e in t?(t[e]&&!isArray(t[e])&&(t[e]=[t[e]]),t[e].push(n)):t[e]=n},arguments),t}function buildParams(t,e,n,r){var i,o,a,s=/\[\]$/;if(isArray(e))for(o=0;e&&o<e.length;o++)a=e[o],n||s.test(t)?r(t,a):buildParams(t+"["+("object"==typeof a?o:"")+"]",a,n,r);else if(e&&"[object Object]"===e.toString())for(i in e)buildParams(t+"["+i+"]",e[i],n,r);else r(t,e)}var context=this;if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=__webpack_require__(56)}catch(ex){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(t){return t instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(t){if(t.crossOrigin===!0){var e=context[xmlHttpRequest]?new XMLHttpRequest:null;if(e&&"withCredentials"in e)return e;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(t){return t}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(t,e){return t=t||function(){},e=e||function(){},this._fulfilled?this._responseArgs.resp=t(this._responseArgs.resp):this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(t),this._errorHandlers.push(e)),this},always:function(t){return this._fulfilled||this._erred?t(this._responseArgs.resp):this._completeHandlers.push(t),this},fail:function(t){return this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(t),this},"catch":function(t){return this.fail(t)}},reqwest.serializeArray=function(){var t=[];return eachFormElement.apply(function(e,n){t.push({name:e,value:n})},arguments),t},reqwest.serialize=function(){if(0===arguments.length)return"";var t,e,n=Array.prototype.slice.call(arguments,0);return t=n.pop(),t&&t.nodeType&&n.push(t)&&(t=null),t&&(t=t.type),e="map"==t?serializeHash:"array"==t?reqwest.serializeArray:serializeQueryString,e.apply(null,n)},reqwest.toQueryString=function(t,e){var n,r,i=e||!1,o=[],a=encodeURIComponent,s=function(t,e){e="function"==typeof e?e():null==e?"":e,o[o.length]=a(t)+"="+a(e)};if(isArray(t))for(r=0;t&&r<t.length;r++)s(t[r].name,t[r].value);else for(n in t)t.hasOwnProperty(n)&&buildParams(n,t[n],i,s);return o.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(t,e){return t&&(t.type&&(t.method=t.type)&&delete t.type,t.dataType&&(t.type=t.dataType),t.jsonpCallback&&(t.jsonpCallbackName=t.jsonpCallback)&&delete t.jsonpCallback,t.jsonp&&(t.jsonpCallback=t.jsonp)),new Reqwest(t,e)},reqwest.ajaxSetup=function(t){t=t||{};for(var e in t)globalSetupOptions[e]=t[e]},reqwest})},function(t,e){},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(){}function n(t){if(!t)return e;var n,r,i=t.scale[0],o=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,e){e||(n=r=0),t[0]=(n+=t[0])*i+a,t[1]=(r+=t[1])*o+s}}function r(t){if(!t)return e;var n,r,i=t.scale[0],o=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,e){e||(n=r=0);var u=(t[0]-a)/i|0,l=(t[1]-s)/o|0;t[0]=u-n,t[1]=l-r,n=u,r=l}}function i(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function o(t,e){for(var n=0,r=t.length;r>n;){var i=n+r>>>1;t[i]<e?n=i+1:r=i}return n}function a(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return s(t,e)})}:s(t,e)}function s(t,e){var n={type:"Feature",id:e.id,properties:e.properties||{},geometry:u(t,e)};return null==e.id&&delete n.id,n}function u(t,e){function r(t,e){e.length&&e.pop();for(var n,r=f[0>t?~t:t],o=0,a=r.length;a>o;++o)e.push(n=r[o].slice()),c(n,o);0>t&&i(e,a)}function o(t){return t=t.slice(),c(t,0),t}function a(t){for(var e=[],n=0,i=t.length;i>n;++n)r(t[n],e);return e.length<2&&e.push(e[0].slice()),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0].slice());return e}function u(t){return t.map(s)}function l(t){var e=t.type;return"GeometryCollection"===e?{type:e,geometries:t.geometries.map(l)}:e in h?{type:e,coordinates:h[e](t)}:null}var c=n(t.transform),f=t.arcs,h={Point:function(t){return o(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(o)},LineString:function(t){return a(t.arcs)},MultiLineString:function(t){return t.arcs.map(a)},Polygon:function(t){return u(t.arcs)},MultiPolygon:function(t){return t.arcs.map(u)}};return l(e)}function l(t,e){function n(e){var n,r=t.arcs[0>e?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=r[r.length-1],0>e?[n,i]:[i,n]}function r(t,e){for(var n in t){var r=t[n];delete e[r.start],delete r.start,delete r.end,r.forEach(function(t){i[0>t?~t:t]=1}),s.push(r)}}var i={},o={},a={},s=[],u=-1;return e.forEach(function(n,r){var i,o=t.arcs[0>n?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++u],e[u]=n,e[r]=i)}),e.forEach(function(t){var e,r,i=n(t),s=i[0],u=i[1];if(e=a[s])if(delete a[e.end],e.push(t),e.end=u,r=o[u]){delete o[r.start];var l=r===e?e:e.concat(r);o[l.start=e.start]=a[l.end=r.end]=l}else o[e.start]=a[e.end]=e;else if(e=o[u])if(delete o[e.start],e.unshift(t),e.start=s,r=a[s]){delete a[r.end];var c=r===e?e:r.concat(e);o[c.start=r.start]=a[c.end=e.end]=c}else o[e.start]=a[e.end]=e;else e=[t],o[e.start=s]=a[e.end=u]=e}),r(a,o),r(o,a),e.forEach(function(t){i[0>t?~t:t]||s.push([t])}),s}function c(t){return u(t,f.apply(this,arguments))}function f(t,e,n){function r(t){var e=0>t?~t:t;(c[e]||(c[e]=[])).push({i:t,g:u})}function i(t){t.forEach(r)}function o(t){t.forEach(i)}function a(t){"GeometryCollection"===t.type?t.geometries.forEach(a):t.type in f&&(u=t,f[t.type](t.arcs))}var s=[];if(arguments.length>1){var u,c=[],f={LineString:i,MultiLineString:o,Polygon:o,MultiPolygon:function(t){t.forEach(o)}};a(e),c.forEach(arguments.length<3?function(t){s.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&s.push(t[0].i)})}else for(var h=0,p=t.arcs.length;p>h;++h)s.push(h);return{type:"MultiLineString",arcs:l(t,s)}}function h(t){var e=t[0],n=t[1],r=t[2];return Math.abs((e[0]-r[0])*(n[1]-e[1])-(e[0]-n[0])*(r[1]-e[1]))}function p(t){for(var e,n=-1,r=t.length,i=t[r-1],o=0;++n<r;)e=i,i=t[n],o+=e[0]*i[1]-e[1]*i[0];return o/2}function d(t){return u(t,v.apply(this,arguments))}function v(t,e){function n(t){t.forEach(function(e){e.forEach(function(e){(i[e=0>e?~e:e]||(i[e]=[])).push(t)})}),o.push(t)}function r(e){return p(u(t,{type:"Polygon",arcs:[e]}).coordinates[0])>0}var i={},o=[],a=[];return e.forEach(function(t){"Polygon"===t.type?n(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(n)}),o.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,a.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),o.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:a.map(function(e){var n,o=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){i[0>t?~t:t].length<2&&o.push(t)})})}),o=l(t,o),(n=o.length)>1)for(var a,s=r(e[0][0]),u=0;n>u;++u)if(s===r(o[u])){a=o[0],o[0]=o[u],o[u]=a;break}return o})}}function y(t){function e(t,e){t.forEach(function(t){0>t&&(t=~t);var n=i[t];n?n.push(e):i[t]=[e]})}function n(t,n){t.forEach(function(t){e(t,n)})}function r(t,e){"GeometryCollection"===t.type?t.geometries.forEach(function(t){r(t,e)}):t.type in s&&s[t.type](t.arcs,e)}var i={},a=t.map(function(){return[]}),s={LineString:e,MultiLineString:n,Polygon:n,MultiPolygon:function(t,e){t.forEach(function(t){n(t,e)})}};t.forEach(r);for(var u in i)for(var l=i[u],c=l.length,f=0;c>f;++f)for(var h=f+1;c>h;++h){var p,d=l[f],v=l[h];(p=a[d])[u=o(p,v)]!==v&&p.splice(u,0,v),(p=a[v])[u=o(p,d)]!==d&&p.splice(u,0,d)}return a}function m(t,e){return t[1][2]-e[1][2]}function g(){function t(t,e){for(;e>0;){var n=(e+1>>1)-1,i=r[n];if(m(t,i)>=0)break;r[i._=e]=i,r[t._=e=n]=t}}function e(t,e){for(;;){var n=e+1<<1,o=n-1,a=e,s=r[a];if(i>o&&m(r[o],s)<0&&(s=r[a=o]),i>n&&m(r[n],s)<0&&(s=r[a=n]),a===e)break;r[s._=e]=s,r[t._=e=a]=t}}var n={},r=[],i=0;return n.push=function(e){return t(r[e._=i]=e,i++),i},n.pop=function(){if(!(0>=i)){var t,n=r[0];return--i>0&&(t=r[i],e(r[t._=0]=t,0)),n}},n.remove=function(n){var o,a=n._;if(r[a]===n)return a!==--i&&(o=r[i],(m(o,n)<0?t:e)(r[o._=a]=o,a)),a},n}function _(t,e){function i(t){s.remove(t),t[1][2]=e(t),s.push(t)}var o=n(t.transform),a=r(t.transform),s=g();return e||(e=h),t.arcs.forEach(function(t){var n,r,u,l,c=[],f=0;for(r=0,u=t.length;u>r;++r)l=t[r],o(t[r]=[l[0],l[1],1/0],r);for(r=1,u=t.length-1;u>r;++r)n=t.slice(r-1,r+2),n[1][2]=e(n),c.push(n),s.push(n);for(r=0,u=c.length;u>r;++r)n=c[r],n.previous=c[r-1],n.next=c[r+1];for(;n=s.pop();){var h=n.previous,p=n.next;n[1][2]<f?n[1][2]=f:f=n[1][2],h&&(h.next=p,h[2]=n[2],i(h)),p&&(p.previous=h,p[0]=n[0],i(p))}t.forEach(a)}),t}var b="1.6.24";t.version=b,t.mesh=c,t.meshArcs=f,t.merge=d,t.mergeArcs=v,t.feature=a,t.neighbors=y,t.presimplify=_})},function(t,e){"use strict";function n(t,e,n){n=n||2;var i=e&&e.length,a=i?e[0]*n:t.length,s=r(t,0,a,n,!0),u=[];if(!s)return u;var l,f,h,p,d,v,y;if(i&&(s=c(t,e,s,n)),t.length>80*n){l=h=t[0],f=p=t[1];for(var m=n;a>m;m+=n)d=t[m],v=t[m+1],l>d&&(l=d),f>v&&(f=v),d>h&&(h=d),v>p&&(p=v);y=Math.max(h-l,p-f)}return o(s,u,n,l,f,y),u}function r(t,e,n,r,i){var o,a,s,u=0;for(o=e,a=n-r;n>o;o+=r)u+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;if(i===u>0)for(o=e;n>o;o+=r)s=P(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=P(o,t[o],t[o+1],s);return s}function i(t,e){if(!t)return t;e||(e=t);var n,r=t;do if(n=!1,r.steiner||!x(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(j(r),r=e=r.prev,r===r.next)return null;n=!0}while(n||r!==e);return e}function o(t,e,n,r,c,f,h){if(t){!h&&f&&d(t,r,c,f);for(var p,v,y=t;t.prev!==t.next;)if(p=t.prev,v=t.next,f?s(t,r,c,f):a(t))e.push(p.i/n),e.push(t.i/n),e.push(v.i/n),j(t),t=v.next,y=v.next;else if(t=v,t===y){h?1===h?(t=u(t,e,n),o(t,e,n,r,c,f,2)):2===h&&l(t,e,n,r,c,f):o(i(t),e,n,r,c,f,1);break}}}function a(t){var e=t.prev,n=t,r=t.next;if(b(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(g(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&b(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){var i=t.prev,o=t,a=t.next;if(b(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,f=y(s,u,e,n,r),h=y(l,c,e,n,r),p=t.nextZ;p&&p.z<=h;){if(p!==t.prev&&p!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&g(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function u(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;w(i,r,r.next,o)&&M(i,o)&&M(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),j(r),j(r.next),r=t=o),r=r.next}while(r!==t);return r}function l(t,e,n,r,a,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&_(u,l)){var c=T(u,l);return u=i(u,u.next),c=i(c,c.next),o(u,e,n,r,a,s),void o(c,e,n,r,a,s)}l=l.next}u=u.next}while(u!==t)}function c(t,e,n,o){var a,s,u,l,c,p=[];for(a=0,s=e.length;s>a;a++)u=e[a]*o,l=s-1>a?e[a+1]*o:t.length,c=r(t,u,l,o,!1),c===c.next&&(c.steiner=!0),p.push(m(c));for(p.sort(f),a=0;a<p.length;a++)h(p[a],n),n=i(n,n.next);return n}function f(t,e){return t.x-e.x}function h(t,e){if(e=p(t,e)){var n=T(e,t);i(n,n.next)}}function p(t,e){var n,r=e,i=t.x,o=t.y,a=-(1/0);do{if(o<=r.y&&o>=r.next.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);i>=s&&s>a&&(a=s,n=r.x<r.next.x?r:r.next)}r=r.next}while(r!==e);if(!n)return null;if(t.x===n.x)return n.prev;var u,l=n,c=1/0;for(r=n.next;r!==l;)i>=r.x&&r.x>=n.x&&g(o<n.y?i:a,o,n.x,n.y,o<n.y?a:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),(c>u||u===c&&r.x>n.x)&&M(r,t)&&(n=r,c=u)),r=r.next;return n}function d(t,e,n,r){var i=t;do null===i.z&&(i.z=y(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,v(i)}function v(t){var e,n,r,i,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;l>e&&(s++,r=r.nextZ,r);e++);for(u=l;s>0||u>0&&r;)0===s?(i=r,r=r.nextZ,u--):0!==u&&r?n.z<=r.z?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--):(i=n,n=n.nextZ,s--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,l*=2}while(a>1);return t}function y(t,e,n,r,i){return t=32767*(t-n)/i,e=32767*(e-r)/i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function m(t){var e=t,n=t;do e.x<n.x&&(n=e),e=e.next;while(e!==t);return n}function g(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function _(t,e){return x(t,e)||t.next.i!==e.i&&t.prev.i!==e.i&&!E(t,e)&&M(t,e)&&M(e,t)&&O(t,e)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function w(t,e,n,r){return b(t,e,n)>0!=b(t,e,r)>0&&b(n,r,t)>0!=b(n,r,e)>0}function E(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&w(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function M(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function O(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function T(t,e){var n=new k(t.i,t.x,t.y),r=new k(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function P(t,e,n,r){var i=new k(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function j(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}t.exports=n},function(t,e,n){function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),o=r(i),a=function(t,e,n){function r(){a=t.map(function(t){return[t[0],h.top,t[1]]}),s=e,u=e}function i(){a=[],t.forEach(function(t){a.push([t[0],h.top,t[1]])}),t.forEach(function(t){a.push([t[0],h.bottom,t[1]])}),s=[];for(var n=0;p>n;n++)n===p-1?(s.push([n+p,p,n]),s.push([0,n,p])):(s.push([n+p,n+p+1,n]),s.push([n+1,n,n+p+1]));if(c=[].concat(s),h.closed){var r=e,i=r.map(function(t){return t.map(function(t){return t+p})});i=i.map(function(t){return[t[0],t[2],t[1]]}),s=s.concat(r).concat(i),u=r,l=i}}var a,s,u,l,c,f={top:1,bottom:0,closed:!0},h=(0,o["default"])(f,n),p=t.length;return h.top===h.bottom?r():i(),{positions:a,faces:s,top:u,bottom:l,sides:c}};e["default"]=a,t.exports=e["default"]},function(t,e,n){function r(t,e){this.vertices=null,this.edges=null,this._closed=!1,t&&this.data(t),this._arcSegments=e||5}var i=n(61),o=n(66),a=n(67),s=(Math.min,Math.max,Math.atan2);r.prototype.data=function(t){t=this.validate(t);for(var e=[],n=0,r=t.length;r>n;n++)e.push(new o(t[n],t[(n+1)%r]));return this.vertices=t,this.edges=e,this},r.prototype.arcSegments=function(t){return this._arcSegments=t,this},r.prototype.validate=function(t){var e=t.length;return t[0][0]===t[e-1][0]&&t[0][1]===t[e-1][1]&&(t=t.slice(0,e-1),this._closed=!0),t},r.prototype.createArc=function(t,e,n,r,i,o,a){var u=2*Math.PI,l=s(r[1]-e[1],r[0]-e[0]),c=s(i[1]-e[1],i[0]-e[0]);o%2===0&&(o-=1),0>l&&(l+=u),0>c&&(c+=u);var f=l>c?l-c:l+u-c,h=(a?-f:u-f)/o;t.push(r);for(var p=1;o>p;++p)f=l+h*p,t.push([e[0]+Math.cos(f)*n,e[1]+Math.sin(f)*n]);t.push(i)},r.prototype.padding=function(t){var e,n,r,o=[],s=[];for(e=0,n=this.edges.length;n>e;e++){var u=this.edges[e],l=u._outNormal[0]*t,c=u._outNormal[1]*t;o.push(u.offset(l,c))}for(e=0,n=o.length;n>e;e++){var f=o[e],h=o[(e+n-1)%n],p=a(h.current,h.next,f.current,f.next);p?s.push(p):this.createArc(s,this.edges[e].current,t,h.next,f.current,this._arcSegments,!1)}return r=i.union(s,s),s=r?r[0]:s,s=this.ensureLastPoint(s)},r.prototype.margin=function(t){var e,n,r,o=[],s=[];for(e=0,n=this.edges.length;n>e;e++){var u=this.edges[e],l=u._inNormal[0]*t,c=u._inNormal[1]*t;o.push(u.offset(l,c))}for(e=0,n=o.length;n>e;e++){var f=o[e],h=o[(e+n-1)%n],p=a(h.current,h.next,f.current,f.next);p?s.push(p):this.createArc(s,this.edges[e].current,t,h.next,f.current,this._arcSegments,!0)}return r=i.union(s,s),r&&(r=r[0],s=r.slice(0,r.length/2)),s=this.ensureLastPoint(s)},r.prototype.ensureLastPoint=function(t){return this._closed&&t.push([t[0][0],t[0][1]]),t},r.prototype.offset=function(t){return 0===t?this.vertices:t>0?this.margin(t):this.padding(-t)},t.exports=r},function(t,e,n){var r=n(62);t.exports={union:function(t,e){return r(t,e,!1,!1)},intersection:function(t,e){return r(t,e,!0,!0)},diff:function(t,e){return r(t,e,!1,!0)},clip:r}},function(t,e,n){var r=n(63);t.exports=function(t,e,n,i){var o,a=new r(t),s=new r(e),o=a.clip(s,n,i);return o}},function(t,e,n){var r=n(64),i=n(65),o=function(t,e){this.first=null,this.vertices=0,this._lastUnprocessed=null,this._arrayVertices="undefined"==typeof e?Array.isArray(t[0]):e;for(var n=0,i=t.length;i>n;n++)this.addVertex(new r(t[n]))};o.prototype.addVertex=function(t){if(null==this.first)this.first=t,this.first.next=t,this.first.prev=t;else{var e=this.first,n=e.prev;e.prev=t,t.next=e,t.prev=n,n.next=t}this.vertices++},o.prototype.insertVertex=function(t,e,n){for(var r,i=e;!i.equals(n)&&i._distance<t._distance;)i=i.next;t.next=i,r=i.prev,t.prev=r,r.next=t,i.prev=t,this.vertices++},o.prototype.getNext=function(t){for(var e=t;e._isIntersection;)e=e.next;return e},o.prototype.getFirstIntersect=function(){var t=this._firstIntersect||this.first;do{if(t._isIntersection&&!t._visited)break;t=t.next}while(!t.equals(this.first));return this._firstIntersect=t,t},o.prototype.hasUnprocessed=function(){var t=this._lastUnprocessed||this.first;do{if(t._isIntersection&&!t._visited)return this._lastUnprocessed=t,!0;t=t.next}while(!t.equals(this.first));return this._lastUnprocessed=null,!1},o.prototype.getPoints=function(){var t=[],e=this.first;if(this._arrayVertices){do t.push([e.x,e.y]),e=e.next;while(e!==this.first)}else do t.push({x:e.x,y:e.y}),e=e.next;while(e!==this.first);return t},o.prototype.clip=function(t,e,n){var a,s,u=this.first,l=t.first;do{if(!u._isIntersection)do{if(!l._isIntersection){var c=new i(u,this.getNext(u.next),l,t.getNext(l.next));if(c.valid()){var f=r.createIntersection(c.x,c.y,c.toSource),h=r.createIntersection(c.x,c.y,c.toClip);f._corresponding=h,h._corresponding=f,this.insertVertex(f,u,this.getNext(u.next)),t.insertVertex(h,l,t.getNext(l.next))}}l=l.next}while(!l.equals(t.first));u=u.next}while(!u.equals(this.first));u=this.first,l=t.first,a=u.isInside(t),s=l.isInside(this),e^=a,n^=s;do u._isIntersection&&(u._isEntry=e,e=!e),u=u.next;while(!u.equals(this.first));do l._isIntersection&&(l._isEntry=n,n=!n),l=l.next;while(!l.equals(t.first));for(var p=[];this.hasUnprocessed();){var d=this.getFirstIntersect(),v=new o([],this._arrayVertices);v.addVertex(new r(d.x,d.y));do{if(d.visit(),d._isEntry){do d=d.next,v.addVertex(new r(d.x,d.y));while(!d._isIntersection)}else do d=d.prev,v.addVertex(new r(d.x,d.y));while(!d._isIntersection);d=d._corresponding}while(!d._visited);p.push(v.getPoints())}return 0===p.length&&(a&&p.push(this.getPoints()),s&&p.push(t.getPoints()),0===p.length&&(p=null)),p},t.exports=o},function(t,e){var n=function(t,e){1===arguments.length&&(Array.isArray(t)?(e=t[1],t=t[0]):(e=t.y,t=t.x)),this.x=t,this.y=e,this.next=null,this.prev=null,this._corresponding=null,this._distance=0,this._isEntry=!0,this._isIntersection=!1,this._visited=!1};n.createIntersection=function(t,e,r){var i=new n(t,e);return i._distance=r,i._isIntersection=!0,i._isEntry=!1,i},n.prototype.visit=function(){this._visited=!0,null===this._corresponding||this._corresponding._visited||this._corresponding.visit()},n.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},n.prototype.isInside=function(t){var e=!1,n=t.first,r=n.next,i=this.x,o=this.y;do(n.y<o&&r.y>=o||r.y<o&&n.y>=o)&&(n.x<=i||r.x<=i)&&(e^=n.x+(o-n.y)/(r.y-n.y)*(r.x-n.x)<i),n=n.next,r=n.next||t.first;while(!n.equals(t.first));return e},t.exports=n},function(t,e){var n=function(t,e,n,r){this.x=0,this.y=0,this.toSource=0,this.toClip=0;var i=(r.y-n.y)*(e.x-t.x)-(r.x-n.x)*(e.y-t.y);0!==i&&(this.toSource=((r.x-n.x)*(t.y-n.y)-(r.y-n.y)*(t.x-n.x))/i,this.toClip=((e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x))/i,this.valid()&&(this.x=t.x+this.toSource*(e.x-t.x),this.y=t.y+this.toSource*(e.y-t.y)))};n.prototype.valid=function(){return 0<this.toSource&&this.toSource<1&&0<this.toClip&&this.toClip<1},t.exports=n},function(t,e){"use strict";function n(t,e){this.current=t,this.next=e,this._inNormal=this.inwardsNormal(),this._outNormal=this.outwardsNormal()}n.prototype.outwardsNormal=function(){var t=this.inwardsNormal();return[-t[0],-t[1]]},n.prototype.inwardsNormal=function(){var t=this.next[0]-this.current[0],e=this.next[1]-this.current[1],n=Math.sqrt(t*t+e*e);return[-e/n,t/n]},n.prototype.offset=function(t,e){var r=this.current,i=this.next;return new n([r[0]+t,r[1]+e],[i[0]+t,i[1]+e])},t.exports=n},function(t,e){"use strict";t.exports=function(t,e,n,r){var i=(r[1]-n[1])*(e[0]-t[0])-(r[0]-n[0])*(e[1]-t[1]);if(0==i)return null;var o=((r[0]-n[0])*(t[1]-n[1])-(r[1]-n[1])*(t[0]-n[0]))/i,a=((e[0]-t[0])*(t[1]-n[1])-(e[1]-t[1])*(t[0]-n[0]))/i;return 0>o||0>a||o>1||a>1?null:[t[0]+o*(e[0]-t[0]),t[1]+o*(e[1]-t[1])]}}])});
//# sourceMappingURL=vizicities.min.js.map
